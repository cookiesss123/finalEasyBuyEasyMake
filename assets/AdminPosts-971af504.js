import{m as T}from"./modalMixin-c1848f69.js";import{v as m,a as k}from"./runtime-dom.esm-bundler-54ced388.js";import{_ as y,o as n,U as a,V as t,Z as I,$ as c,a1 as A,a2 as f,a0 as d,Y as h,a3 as D,W as v,r as M,a4 as w}from"./_plugin-vue_export-helper-03b40388.js";import"./modal-838a1639.js";import"./_commonjsHelpers-042e6b4d.js";import"./base-component-5a126788.js";const{VITE_PATH:u}={VITE_API_KEY:"AIzaSyCFUHSJz2uLKyLoro6hV10QUzYmoo3UMb0",VITE_AUTH_DOMAIN:"easymakeeasyb.firebaseapp.com",VITE_URL:"https://easymakeeasyb-default-rtdb.firebaseio.com",VITE_SENDERID:"271184286286",VITE_APPID:"1:271184286286:web:321404cd2c69663b1f691f",VITE_MEASUREMENTID:"DZPMFGCKZB",VITE_ADMIN_UID:"4mSSnZwpHRTkyS4ixtLDXvtReaA2",BASE_URL:"/finalEasyBuyEasyMake/",MODE:"production",DEV:!1,PROD:!0},x={data(){return{tempArticle:{tags:[]},status:"edit",recipes:[],date:"",comments:[]}},mixins:[T],props:["id","openModal","getArticles"],methods:{updateProduct(){this.tempArticle.createAt=new Date(this.date).getTime();let s=`${u}/articles/${this.tempArticle.id}`,o="put";this.status==="new"&&(s=`${u}/articles`,o="post"),this.$http[o](s,this.tempArticle).then(r=>{console.log(r.data),this.getArticles(),this.hide()}).catch(r=>{console.log(r)})}},mounted(){},watch:{id(){console.log("id變了"),this.id!=="new"&&this.id!==""?this.$http.get(`${u}/articles/${this.id}`).then(s=>(this.tempArticle=s.data,this.date=new Date(this.tempArticle.createAt).toISOString().split("T")[0],this.$http.get(`${u}/articles/${this.id}/comments?_expand=user`))).then(s=>{console.log(s.data),this.comments=s.data,this.show(),this.status="edit",this.openModal("")}).catch(s=>{console.log(s)}):this.id==="new"&&(this.tempArticle={tags:[]},this.show(),this.status="new",this.openModal(""))}}},U={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},P={class:"modal-dialog modal-xl"},S={class:"modal-content"},C={class:"modal-header bg-dark"},L={class:"modal-title text-white",id:"exampleModalLabel"},R={key:0},$={key:1},N=t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),H={class:"modal-body"},B={class:"row"},z={class:"col-4"},O=t("label",{for:"title",class:"form-label"},"圖片網址",-1),Z=["src"],K=t("label",{for:"date",class:"form-label mt-3"},"文章撰寫日期",-1),F={class:"form-check"},Y=t("label",{class:"form-check-label",for:"isPublic"}," 是否公開 ",-1),G={class:"col-8"},J={class:"row gy-3"},Q={class:"col-2"},X=t("label",{for:"title",class:"form-label"},"編號（id）",-1),q={class:"col-10"},W=t("label",{for:"content",class:"form-label"},"標籤",-1),j={class:"row"},tt={class:"input-group mb-3"},et=["onUpdate:modelValue"],st=["onClick"],lt=t("i",{class:"bi bi-x-lg"},null,-1),ot=[lt],it={class:"col-3"},nt={class:"col-12"},at=t("label",{for:"title",class:"form-label"},"標題",-1),dt={class:"col-12"},ct=t("label",{for:"description",class:"form-label"},"文章內容",-1),rt={class:"col-12"},mt={for:"price",class:"form-label"},_t={style:{"font-size":"16px"}},pt=t("div",null,[t("button",{type:"button",class:"btn btn-outline-primary"},"新增官方留言")],-1),ut={class:"modal-footer"},ht=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1),bt={key:0},At={key:1};function ft(s,o,r,g,l,i){const _=D("true"),b=D("false");return n(),a("div",U,[t("div",P,[t("div",S,[t("div",C,[t("h5",L,[l.status==="edit"?(n(),a("span",R,"編輯產品內容")):l.status==="new"?(n(),a("span",$,"新增產品內容")):I("",!0)]),N]),t("div",H,[t("div",B,[t("div",z,[O,c(t("input",{type:"text",id:"title",class:"form-control mb-3","onUpdate:modelValue":o[0]||(o[0]=e=>l.tempArticle.imgUrl=e)},null,512),[[m,l.tempArticle.imgUrl]]),t("img",{src:l.tempArticle.imgUrl,alt:"",width:"300"},null,8,Z),K,c(t("input",{type:"date",id:"date",class:"form-control mb-3","onUpdate:modelValue":o[1]||(o[1]=e=>l.date=e)},null,512),[[m,l.date]]),t("div",F,[c(t("input",{class:"form-check-input",type:"checkbox",value:"",id:"isPublic","onUpdate:modelValue":o[2]||(o[2]=e=>l.tempArticle.isPublic=e)},null,512),[[_,1],[b,0],[k,l.tempArticle.isPublic]]),Y])]),t("div",G,[t("div",J,[t("div",Q,[X,c(t("input",{type:"text",id:"title",class:"form-control","onUpdate:modelValue":o[3]||(o[3]=e=>l.tempArticle.id=e),disabled:""},null,512),[[m,l.tempArticle.id]])]),t("div",q,[W,t("div",j,[(n(!0),a(A,null,f(l.tempArticle.tags,(e,p)=>(n(),a("div",{class:"col-3",key:e+23423},[t("div",tt,[c(t("input",{type:"text",class:"form-control","onUpdate:modelValue":E=>l.tempArticle.tags[p]=E},null,8,et),[[m,l.tempArticle.tags[p]]]),t("button",{class:"btn btn-outline-primary",type:"button",onClick:E=>l.tempArticle.tags.splice(p,1)},ot,8,st)])]))),128)),t("div",it,[t("button",{type:"button",class:"btn btn-outline-primary",onClick:o[4]||(o[4]=e=>l.tempArticle.tags.push(""))},"新增標籤")])])]),t("div",nt,[at,c(t("input",{type:"text",id:"title",class:"form-control","onUpdate:modelValue":o[5]||(o[5]=e=>l.tempArticle.title=e)},null,512),[[m,l.tempArticle.title]])]),t("div",dt,[ct,c(t("textarea",{name:"",id:"description",cols:"30",rows:"10",class:"form-control","onUpdate:modelValue":o[6]||(o[6]=e=>l.tempArticle.description=e)},null,512),[[m,l.tempArticle.description]])]),t("div",rt,[t("label",mt,d(l.comments.length)+" 則留言",1),(n(!0),a(A,null,f(l.comments,e=>(n(),a("div",{key:e.id,style:{"background-color":"antiquewhite"}},[t("h5",null,[h(d(e.user.nickName)+" ",1),t("span",_t," (使用者id "+d(e.user.id)+") ",1),h("：")]),t("p",null,d(e.message),1)]))),128))]),pt])])])]),t("div",ut,[ht,t("button",{type:"button",class:"btn btn-primary",onClick:o[7]||(o[7]=(...e)=>i.updateProduct&&i.updateProduct(...e))},[l.status==="edit"?(n(),a("span",bt,"確認編輯")):l.status==="new"?(n(),a("span",At,"確認新增")):I("",!0)])])])])],512)}const yt=y(x,[["render",ft]]),{VITE_PATH:V}={VITE_API_KEY:"AIzaSyCFUHSJz2uLKyLoro6hV10QUzYmoo3UMb0",VITE_AUTH_DOMAIN:"easymakeeasyb.firebaseapp.com",VITE_URL:"https://easymakeeasyb-default-rtdb.firebaseio.com",VITE_SENDERID:"271184286286",VITE_APPID:"1:271184286286:web:321404cd2c69663b1f691f",VITE_MEASUREMENTID:"DZPMFGCKZB",VITE_ADMIN_UID:"4mSSnZwpHRTkyS4ixtLDXvtReaA2",BASE_URL:"/finalEasyBuyEasyMake/",MODE:"production",DEV:!1,PROD:!0},gt={data(){return{tempArticle:{}}},mixins:[T],props:["id","openDeleteModal","getArticles"],methods:{deleteArticle(){this.$http.delete(`${V}/articles/${this.tempArticle.id}`).then(s=>{console.log(s.data),this.getArticles(),this.hide()}).catch(s=>{console.log(s)})}},watch:{id(){this.id&&(console.log(this.id,"改變了"),this.$http.get(`${V}/articles/${this.id}`).then(s=>{this.tempArticle=s.data,console.log(this.tempArticle),this.show(),this.openDeleteModal("")}).catch(s=>{console.log(s)}))}}},Et={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},It={class:"modal-dialog"},Dt={class:"modal-content"},vt=t("div",{class:"modal-header bg-dark"},[t("h5",{class:"modal-title text-white",id:"exampleModalLabel"}," 刪除產品 "),t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Mt={class:"modal-body"},Vt={class:"text-danger fw-bold"},Tt={class:"modal-footer"},kt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1);function wt(s,o,r,g,l,i){return n(),a("div",Et,[t("div",It,[t("div",Dt,[vt,t("div",Mt,[t("p",null,[h("確定要刪除文章 "),t("span",Vt," 【"+d(l.tempArticle.title)+"】 ",1),h(" 嗎? ")])]),t("div",Tt,[kt,t("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=(..._)=>i.deleteArticle&&i.deleteArticle(..._))}," 確認刪除 ")])])])],512)}const xt=y(gt,[["render",wt]]),{VITE_PATH:Ut}={VITE_API_KEY:"AIzaSyCFUHSJz2uLKyLoro6hV10QUzYmoo3UMb0",VITE_AUTH_DOMAIN:"easymakeeasyb.firebaseapp.com",VITE_URL:"https://easymakeeasyb-default-rtdb.firebaseio.com",VITE_SENDERID:"271184286286",VITE_APPID:"1:271184286286:web:321404cd2c69663b1f691f",VITE_MEASUREMENTID:"DZPMFGCKZB",VITE_ADMIN_UID:"4mSSnZwpHRTkyS4ixtLDXvtReaA2",BASE_URL:"/finalEasyBuyEasyMake/",MODE:"production",DEV:!1,PROD:!0},Pt={components:{ArticleModal:yt,DeleteArticleModal:xt},data(){return{articles:[],articleId:"",articleDeleteId:""}},methods:{getArticles(){this.$http.get(`${Ut}/articles?_embed=comments&_expand=user`).then(s=>{console.log(s.data),this.articles=s.data}).catch(s=>{console.log(s)})},openModal(s){this.articleId=s},openDeleteModal(s){this.articleDeleteId=s}},mounted(){this.getArticles()}},St={class:"container"},Ct={class:"d-flex my-4"},Lt={class:"table text-center",style:{"vertical-align":"middle"}},Rt=t("thead",null,[t("tr",null,[t("th",null,"文章編號"),t("th",null,"撰寫日期"),t("th",null,"作者"),t("th",null,"標題"),t("th",null,"內容"),t("th",null,"留言數"),t("th",null,"是否公開"),t("th",null,"編輯")])],-1),$t={style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","max-width":"100px"}},Nt={class:"btn-group"},Ht=["onClick"],Bt=["onClick"];function zt(s,o,r,g,l,i){const _=M("ArticleModal"),b=M("DeleteArticleModal");return n(),a("div",St,[t("div",Ct,[t("button",{type:"button",class:"ms-auto btn btn-primary",onClick:o[0]||(o[0]=e=>i.openModal("new"))},"建立新文章")]),t("table",Lt,[Rt,t("tbody",null,[(n(!0),a(A,null,f(l.articles,e=>(n(),a("tr",{key:e.id},[t("td",null,d(e.id),1),t("td",null,d(`${new Date(e.createAt).toLocaleString().split(" ")[0]}`),1),t("td",null,d(e.user.nickName),1),t("td",null,d(e.title),1),t("td",$t,d(e.description),1),t("td",null,d(e.comments.length),1),t("td",{class:w({"text-success":e.isPublic,"fw-bold":e.isPublic})},d(`${e.isPublic?"公開":"不公開"}`),3),t("td",null,[t("div",Nt,[t("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:p=>i.openModal(e.id)},"編輯",8,Ht),t("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:p=>i.openDeleteModal(e.id)},"刪除",8,Bt)])])]))),128))])]),v(_,{ref:"productModal",id:l.articleId,"open-modal":i.openModal,"get-articles":i.getArticles,"get-comments":s.getComments},null,8,["id","open-modal","get-articles","get-comments"]),v(b,{ref:"deleteProductModal",id:l.articleDeleteId,"get-articles":i.getArticles,"open-delete-modal":i.openDeleteModal},null,8,["id","get-articles","open-delete-modal"])])}const Jt=y(Pt,[["render",zt]]);export{Jt as default};
