import{l as m}from"./runtime-dom.esm-bundler-eb0e3820.js";import{b6 as w,av as k,aj as r,l as a,m as t,aJ as l,s as u,a3 as i,b3 as p,F as f,at as _,t as y,b1 as v}from"./_plugin-vue_export-helper-68081c38.js";const{VITE_PATH:h}={VITE_PATH:"https://vue-final-dbjson-889xxtffg-cookiesss123.vercel.app",BASE_URL:"/finalEasyMakeEasyBuy/",MODE:"production",DEV:!1,PROD:!0},I={data(){return{userId:"",token:"",nickName:"",user:{},orders:[],filterOrders:[],selectItem:"全部",orderArrived:[],nickNameEdit:!0,passwordEdit:!0,newNickName:"",newPassword:""}},methods:{getUserInfo(){this.$http.get(`${h}/600/users/${this.userId}`,{headers:{authorization:`Bearer ${this.token}`}}).then(o=>{console.log("使用者資料",o.data),this.user=o.data}).catch(o=>{console.log(o)})},getOrders(){this.$http.get(`${h}/600/users/${this.userId}/orders`,{headers:{authorization:`Bearer ${this.token}`}}).then(o=>{console.log("訂單",o.data),this.orders=o.data,this.filterOrders=o.data,this.orderArrived=this.orders.filter(s=>s.deliveryStatus==="待取貨")}).catch(o=>{console.log(o)})},updateUserInfo(o){let s={nickName:this.newNickName};if(o==="nickNameEdit"){if(console.log(this.newNickName.length),this.newNickName.length>10){this.$swal({icon:"error",title:"暱稱不得超過10個字元",showConfirmButton:!1,timer:1500});return}else if(this.newNickName===""){this.$swal({icon:"error",title:"暱稱不得是空字串",showConfirmButton:!1,timer:1500});return}}else if(o==="passwordEdit"){if(this.newPassword.length<4||this.newPassword===""){this.$swal({icon:"error",title:"新密碼不得少於4個字元",showConfirmButton:!1,timer:1500});return}s={password:this.newPassword}}this.$http.patch(`${h}/600/users/${this.userId}`,s,{headers:{authorization:`Bearer ${this.token}`}}).then(d=>{console.log(d.data),o==="nickNameEdit"?(this.nickNameEdit=!0,this.$swal({icon:"success",title:"暱稱修改成功",showConfirmButton:!1,timer:1500})):o==="passwordEdit"&&(this.passwordEdit=!0,this.$swal({icon:"success",title:"密碼修改成功",showConfirmButton:!1,timer:1500})),this.getUserInfo()}).catch(d=>{console.log(d)})}},mounted(){this.token=document.cookie.replace(/(?:(?:^|.*;\s*)myToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),this.userId=localStorage.getItem("userId"),this.userId=Number(this.userId),this.nickName=localStorage.getItem("nickName"),this.getUserInfo(),this.getOrders()},watch:{selectItem(){this.selectItem==="全部"?this.filterOrders=this.orders:this.selectItem!=="全部"&&(this.filterOrders=this.orders.filter(o=>o.deliveryStatus===this.selectItem))}}},x={class:"mt-10 container"},N=t("ul",{class:"nav nav-tabs",id:"myTab",role:"tablist"},[t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link active",id:"home-tab","data-bs-toggle":"tab","data-bs-target":"#home",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"},"會員資料")]),t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link",id:"profile-tab","data-bs-toggle":"tab","data-bs-target":"#profile",type:"button",role:"tab","aria-controls":"profile","aria-selected":"false"},"訂單狀況")])],-1),E={class:"tab-content",id:"myTabContent"},C={class:"tab-pane fade show active text-brown",id:"home",role:"tabpanel","aria-labelledby":"home-tab"},B={class:"d-flex align-items-center justify-content-center"},O=t("div",null,[t("i",{class:"bi bi-person-circle me-10",style:{"font-size":"90px"}}),t("br"),t("button",{type:"button",class:"btn btn-orange"},"重新上傳照片")],-1),T={class:"tabletable-borderless"},S={height:"50",class:"border-bottom"},U=t("th",{width:"100"},"暱稱",-1),P={width:"300"},V={width:"100"},A=t("i",{class:"bi bi-pencil"},null,-1),D={height:"50",class:"border-bottom"},z=t("td",null,"信箱",-1),j=t("td",null,null,-1),L={height:"50",class:"border-bottom"},M=t("td",null,"密碼",-1),R=t("td",null,"****************",-1),F=t("i",{class:"bi bi-pencil"},null,-1),H=t("tr",{height:"50",class:"border-bottom"},[t("td",null,"我的抽獎券"),t("td",null,"13 張"),t("td",null,[t("button",{type:"button",class:"btn btn-orange"},"立即抽獎")])],-1),q=t("tr",{height:"50"},[t("td",null,"我的折價券"),t("td",null,[t("ol",null,[t("li",null,"23423可折200元"),t("li",null,"23423可折200元")])]),t("td",null,[t("button",{type:"button",class:"btn btn-orange"},"立即選購")])],-1),J={class:"tab-pane fade",id:"profile",role:"tabpanel","aria-labelledby":"profile-tab"},G={class:"selectOrderStatus py-2"},K={class:"position-absolute bg-danger border border-light text-white",style:{padding:"2px","border-radius":"25px",width:"25px",height:"25px","font-size":"12px",top:"-10px",left:"70px"}},Q={class:"row row-cols-1 text-brown py-3"},W={class:"mb-3"},X={class:"ms-4"},Y={class:"row align-items-center mt-2"},Z=["src"],$={class:"mb-0"},tt={class:"mb-0"},et=t("div",{class:"col-3 text-danger"},null,-1),st={class:"d-flex"},ot={class:"ms-auto d-flex align-items-center"},nt={class:"me-3 fw-bold"},lt=t("hr",null,null,-1);function it(o,s,d,rt,e,b){const g=k("RouterLink");return r(),a("div",x,[N,t("div",E,[t("div",C,[t("div",B,[O,t("table",T,[t("thead",S,[t("tr",null,[U,t("th",P,l(e.user.nickName),1),t("th",V,[t("button",{type:"button",class:"btn btn-sm btn-orange",onClick:s[0]||(s[0]=()=>e.nickNameEdit=!e.nickNameEdit)},[A,u(" 修改暱稱 ")])]),t("th",null,[t("span",{class:i({"d-none":!e.nickNameEdit})},"修改後需重新登入",2),t("div",{class:i(["input-group",{"d-none":e.nickNameEdit}])},[p(t("input",{type:"text",class:"form-control",placeholder:"請輸入新暱稱","onUpdate:modelValue":s[1]||(s[1]=n=>e.newNickName=n)},null,512),[[m,e.newNickName]]),t("button",{onClick:s[2]||(s[2]=()=>b.updateUserInfo("nickNameEdit")),class:"btn btn-outline-secondary",type:"button",id:"button-addon2"},"確定")],2)])])]),t("tbody",null,[t("tr",D,[z,t("td",null,l(e.user.email),1),j]),t("tr",L,[M,R,t("td",null,[t("button",{type:"button",class:"btn btn-sm btn-orange",onClick:s[3]||(s[3]=()=>e.passwordEdit=!e.passwordEdit)},[F,u(" 變更密碼 ")])]),t("td",null,[t("div",{class:i(["input-group",{"d-none":e.passwordEdit}])},[p(t("input",{type:"password",class:"form-control",placeholder:"請輸入新密碼","onUpdate:modelValue":s[4]||(s[4]=n=>e.newPassword=n)},null,512),[[m,e.newPassword]]),t("button",{onClick:s[5]||(s[5]=()=>b.updateUserInfo("passwordEdit")),class:"btn btn-outline-secondary",type:"button",id:"button-addon2"},"確定")],2)])]),H,q])])])]),t("div",J,[t("div",G,[t("button",{type:"button",class:"btn border-0 me-5",onClick:s[6]||(s[6]=()=>e.selectItem="全部")},[t("span",{class:i(["text-secondary h5",{"text-orange":e.selectItem==="全部","fw-bold":e.selectItem==="全部"}])}," 全部 ",2)]),t("button",{type:"button",class:"btn border-0 me-5",onClick:s[7]||(s[7]=()=>e.selectItem="待出貨")},[t("span",{class:i(["text-secondary h5",{"text-orange":e.selectItem==="待出貨","fw-bold":e.selectItem==="待出貨"}])},"待出貨",2)]),t("button",{type:"button",class:"btn border-0 me-5",onClick:s[8]||(s[8]=()=>e.selectItem="運送中")},[t("span",{class:i(["text-secondary h5",{"text-orange":e.selectItem==="運送中","fw-bold":e.selectItem==="運送中"}])},"運送中",2)]),t("button",{type:"button",class:"btn border-0 me-5 position-relative",onClick:s[9]||(s[9]=()=>e.selectItem="待取貨")},[t("span",{class:i(["text-secondary h5",{"text-orange":e.selectItem==="待取貨","fw-bold":e.selectItem==="待取貨"}])},"待取貨",2),t("span",K,l(e.orderArrived.length),1)]),t("button",{type:"button",class:"btn border-0 me-5",onClick:s[10]||(s[10]=()=>e.selectItem="訂單完成")},[t("span",{class:i(["text-secondary h5",{"text-orange":e.selectItem==="訂單完成","fw-bold":e.selectItem==="訂單完成"}])},"訂單完成",2)])]),t("div",Q,[t("h4",W," 總共有 "+l(e.filterOrders.length)+" 筆 ",1),(r(!0),a(f,null,_(e.filterOrders,n=>(r(),a("div",{class:"col",key:n.id+54359},[t("span",null,"訂單建立時間："+l(new Date(n.creatAt).toLocaleDateString()),1),t("span",X,"訂單編號："+l(n.id),1),t("div",Y,[(r(!0),a(f,null,_(n.cart.items,c=>(r(),a("div",{class:"col-2",key:c+6603},[t("img",{src:c.product.imgUrl,alt:"",height:"100",width:"150",style:{"object-fit":"cover"}},null,8,Z),t("p",$,l(c.product.title),1),t("p",tt,"x "+l(c.qty),1)]))),128)),et]),t("div",st,[t("div",ot,[t("span",nt,"運送狀態："+l(n.deliveryStatus),1),t("span",null,"總付款金額：NT$ "+l(n.cart.finalTotal),1),y(g,{to:`/orders/${n.id}`,class:"btn btn-brown ms-3"},{default:v(()=>[u("查看詳細訂單狀況")]),_:2},1032,["to"])])]),lt]))),128))])])])])}const ct=w(I,[["render",it]]);export{ct as default};
