import{R as B,m as N,e as V}from"./index-a9d6be75.js";import{r as f,b as w,o as E,d as b,s as q,e as D,c as O,a as T}from"./carts-810a7b65.js";import{n as U}from"./numberCommaMixin-e0aac39c.js";import{P as F}from"./PaginationComponent-de446aef.js";import{C as S}from"./collapse-9299200c.js";import{L as G}from"./index-2b32f149.js";import{w as _,v as H,d as j,m as y}from"./runtime-dom.esm-bundler-e140de91.js";import{_ as A}from"./loadingLogo-ea15f612.js";import{_ as I,a as Y}from"./fruit3-355a36ca.js";import{_ as z,a as K}from"./discount3-e2e49eb3.js";import{_ as W}from"./image5-4fc2427e.js";import{_ as J}from"./image4-1806383b.js";import{_ as Q}from"./icon-cart-796adfb7.js";import{_ as X}from"./undraw_Page_not_found_re_e9o6-993b7155.js";import{_ as Z,a7 as a,F as v,a9 as P,a8 as t,af as d,ab as h,aa as c,ad as p,ac as m,N as C,ae as L,r as x,o as l}from"./_plugin-vue_export-helper-d28549df.js";import"./base-component-7efcaba4.js";const $="/finalEasyBuyEasyMake/assets/food1-d3cd1b3d.png",tt="/finalEasyBuyEasyMake/assets/food3-12ca3601.png",et="/finalEasyBuyEasyMake/assets/strawberry1-dc036a97.png",st="/finalEasyBuyEasyMake/assets/strawberry3-301f90ac.png",ot={components:{RouterLink:B,PaginationComponent:F,Loading:G},data(){return{priceOrRateCollapse:{},highOrLowCollapse:{},uid:"",products:[],priceOrRate:"價格",highOrLow:"不拘",productSearchName:"",filterProducts:[],bookMarks:[],pageStatus:"全部",selectPage:"全部",search:!1,isLoading:!1,fullPage:!0}},mixins:[U],methods:{...N(O,["addCart","toastMessage"]),getProducts(){const r=f(b,"products/");w(r,o=>{this.products=o.val(),this.products=Object.entries(this.products).map(g=>(g[1].id=g[0],g[1]));const k=f(b,"productRates/");w(k,g=>{let s=g.val();s=Object.values(s).map((n,i)=>(n.id=Object.keys(s)[i],n)),this.products.forEach((n,i)=>{s.forEach(u=>{n.id===u.productId&&!this.products[i].scores?(this.products[i].scores=u.score,this.products[i].ratePeople=1,this.products[i].averageRate=Number((this.products[i].scores/this.products[i].ratePeople).toFixed(1))):n.id===u.productId&&this.products[i].scores&&(this.products[i].scores+=u.score,this.products[i].ratePeople+=1,this.products[i].averageRate=Number((this.products[i].scores/this.products[i].ratePeople).toFixed(1)))})}),this.products.forEach((n,i)=>{n.averageRate||(this.products[i].scores=0,this.products[i].ratePeople=0,this.products[i].averageRate=0)}),this.filterProducts=this.products,this.isLoading=!1,!this.$route.query.pageStatus&&this.$route.fullPath==="/products"?this.$refs.pagination.renderPage(1,this.filterProducts):this.$route.query.pageStatus&&this.searchProducts()})})},searchProducts(){this.pageStatus==="全部"?this.filterProducts=this.products:this.pageStatus==="食材組合包"?this.filterProducts=this.products.filter(r=>r.category==="組合包"):this.pageStatus==="熱銷單品"?this.filterProducts=this.products.filter(r=>r.category==="單一產品"):this.pageStatus==="特價商品"&&(this.filterProducts=this.products.filter(r=>r.isCheaper===!0)),this.priceOrRate==="價格"&&this.highOrLow!=="不拘"?this.highOrLow==="低到高"?this.filterProducts=this.filterProducts.sort((r,o)=>r.price-o.price):this.highOrLow==="高到低"&&(this.filterProducts=this.filterProducts.sort((r,o)=>o.price-r.price)):this.priceOrRate==="評價"&&this.highOrLow!=="不拘"&&(this.highOrLow==="低到高"?this.filterProducts=this.filterProducts.sort((r,o)=>r.averageRate!==o.averageRate?r.averageRate-o.averageRate:r.scores-o.scores):this.highOrLow==="高到低"&&(this.filterProducts=this.filterProducts.sort((r,o)=>r.averageRate!==o.averageRate?o.averageRate-r.averageRate:o.scores-r.scores))),this.filterProducts=this.filterProducts.filter(r=>r.title.match(this.productSearchName)),this.search=!0,this.$refs.pagination.renderPage(1,this.filterProducts)},getBookmarks(){E(T,r=>{if(r){this.uid=r.uid;const o=f(b,`productBookmarks/${this.uid}`);w(o,k=>{this.bookMarks=k.val(),this.bookMarks&&(this.bookMarks=Object.keys(this.bookMarks))})}else this.uid=null})},addBookmark(r){if(!this.uid){this.toastMessage("登入才可使用收藏功能","error");return}const o=f(b,`productBookmarks/${this.uid}/${r.id}`);q(o,r),this.toastMessage("收藏成功")},deleteBookmark(r){D(f(b,`productBookmarks/${this.uid}/${r}`)),this.toastMessage("已刪除收藏")}},mounted(){this.isLoading=!0,this.priceOrRateCollapse=new S(this.$refs.priceOrRateCollapse,{toggle:!1,parent:"#myGroup"}),this.highOrLowCollapse=new S(this.$refs.highOrLowCollapse,{toggle:!1,parent:"#myGroup"}),(this.$route.query.pageStatus||this.$route.query.searchName||this.$route.query.valueHighOrLow||this.$route.query.valuePriceOrRate)&&(this.pageStatus=this.$route.query.pageStatus,this.priceOrRate=this.$route.query.valuePriceOrRate,this.highOrLow=this.$route.query.valueHighOrLow,this.productSearchName=this.$route.query.searchName),this.getProducts(),this.getBookmarks()},watch:{selectPage(){this.pageStatus=this.selectPage,this.productSearchName="",this.pageStatus==="全部"?this.filterProducts=this.products:this.pageStatus==="食材組合包"?this.filterProducts=this.products.filter(r=>r.category==="組合包"):this.pageStatus==="熱銷單品"?this.filterProducts=this.products.filter(r=>r.category==="單一產品"):this.pageStatus==="特價商品"&&(this.filterProducts=this.products.filter(r=>r.isCheaper===!0)),this.$refs.pagination.renderPage(1,this.filterProducts)},priceOrRate(){this.priceOrRateCollapse.hide()},highOrLow(){this.highOrLowCollapse.hide()},filterProducts(){this.priceOrRateCollapse.hide(),this.highOrLowCollapse.hide()}},computed:{...V(O,["loadingItem"])}},rt=t("div",{class:"d-flex flex-column align-items-center py-96"},[t("img",{src:A,class:"loading-logo mb-3",alt:"logo"}),t("p",{class:"text-center fw-bold text-purple fs-md-2 fs-5"},[t("span",{class:"me-1 animate-text"},"L"),t("span",{class:"mx-1 animate-text"},"o"),t("span",{class:"mx-1 animate-text"},"a"),t("span",{class:"mx-1 animate-text"},"d"),t("span",{class:"mx-1 animate-text"},"i"),t("span",{class:"mx-1 animate-text"},"n"),t("span",{class:"mx-1 animate-text"},"g"),t("span",{class:"mx-2 animate-text"},"."),t("span",{class:"me-2 animate-text"},"."),t("span",{class:"animate-text"},".")])],-1),it=t("section",{class:"text-center","data-aos":"fade-up"},[t("div",{class:"py-lg-200 py-96 bg-cover-center",style:{"background-image":"url('https://images.unsplash.com/photo-1678465952860-422bf820209b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80')"}}),t("h2",{class:"bg-secondary-light-purple-horizontal text-purple mb-0 fs-lg-1 fs-5 letter-spacing-20 ps-3 fw-bold py-2"},"材料種類")],-1),at={class:"container","data-aos":"fade-up"},lt={class:"pt-lg-4 pt-3 position-relative"},nt={class:"category-selector row row-cols-4 list-unstyled border-bottom"},ct={key:0,class:"product-img1 d-block mx-auto",src:I,alt:"所有材料灰色圖示"},dt={key:1,class:"d-block mx-auto",src:Y,alt:"所有材料藍色圖示"},pt=t("span",{class:"fs-12 fs-md-5 d-block py-2"},[c("所有"),t("br",{class:"d-lg-none"}),c("材料")],-1),ut={key:0,class:"product-img2 d-block mx-auto",src:$,alt:""},ht={key:1,class:"d-block mx-auto",src:tt,alt:""},gt=t("span",{class:"fs-12 fs-md-5 d-block py-2"},[c("食材"),t("br",{class:"d-lg-none"}),c("組合包")],-1),mt={key:0,class:"product-img3 d-block mx-auto",src:et,alt:""},ft={key:1,class:"d-block mx-auto",src:st,alt:""},bt=t("span",{class:"fs-12 fs-md-5 d-block py-2"},[c("熱銷"),t("br",{class:"d-lg-none"}),c("單品")],-1),_t={key:0,class:"product-img4 d-block mx-auto",src:z,alt:""},yt={key:1,class:"d-block mx-auto",src:K,alt:""},kt=t("span",{class:"fs-12 fs-md-5 d-block py-2"},[c("特價"),t("br",{class:"d-lg-none"}),c("商品")],-1),vt={class:"d-none d-lg-block my-5"},wt={class:"input-group"},Pt=t("i",{class:"bi bi-caret-down-fill"},null,-1),xt={class:"ms-2 fw-bold"},Rt=t("i",{class:"bi bi-caret-down-fill"},null,-1),Ot={class:"ms-2 fw-bold"},St=t("span",{class:"material-icons-outlined text-primary"},"search",-1),Ct=[St],Lt={class:"row g-0",id:"myGroup"},Mt={class:"col-2"},Bt={ref:"priceOrRateCollapse",class:"collapse"},Nt={class:"card card-body border-0",style:{border:"0px !important"}},Vt={class:"btn-group-vertical",role:"group","aria-label":"Vertical radio toggle button group"},Et=t("label",{class:"btn btn-outline-primary",for:"selectprice"},"價格",-1),qt=t("label",{class:"btn btn-outline-primary",for:"selectRate"},"評價",-1),Dt={class:"col-2"},Tt={ref:"highOrLowCollapse",class:"collapse"},Ut={class:"card card-body border-0",style:{border:"0px !important"}},Ft={class:"btn-group-vertical",role:"group","aria-label":"Vertical radio toggle button group"},Gt=t("label",{class:"btn btn-outline-primary",for:"noDifference"},"不拘",-1),Ht=t("label",{class:"btn btn-outline-primary",for:"highToLow"},"高到低",-1),jt=t("label",{class:"btn btn-outline-primary",for:"lowToHigh"},"低到高",-1),At={key:0,class:"row row-cols-xl-4 row-cols-lg-3 row-cols-2 gy-4"},It={class:"card position-relative"},Yt={class:"card-img-hover position-relative"},zt=["src","alt"],Kt=t("p",{class:"detail position-absolute top-50 start-50 translate-middle fw-bold letter-spacing-5 link-darkBrown fs-xl-5 text-center"},[c("查看"),t("br",{class:"d-xl-none d-lg-block"}),c("商品資訊")],-1),Wt={key:0,class:"fs-md-14 fs-12 text-white p-2 bg-primary position-absolute top-0 start-0"},Jt=["onClick"],Qt=t("img",{src:W,alt:"收藏按鈕-未收藏"},null,-1),Xt=[Qt],Zt=["onClick"],$t=t("img",{src:J,alt:"收藏按鈕-已收藏"},null,-1),te=[$t],ee=["disabled","onClick"],se=t("img",{src:Q,alt:"購物車按鈕",class:"shadow-sm"},null,-1),oe=[se],re={class:"fs-md-5 fs-6 fw-bold"},ie={class:"d-flex align-items-lg-center fs-md-6 fs-12"},ae=t("i",{class:"bi bi-star-fill"},null,-1),le={class:"text-end mt-1 d-md-none fs-12"},ne=t("i",{class:"bi bi-star-fill"},null,-1),ce={key:1,class:"py-lg-4 text-center"},de=t("img",{src:X,class:"mb-lg-3 mb-2 img-md-200-sm-150",alt:"查無資訊"},null,-1),pe=t("p",{class:"fs-lg-3 fs-6"},"查無商品，請您重新查詢",-1),ue=[de,pe];function he(r,o,k,g,s,n){const i=x("loading"),u=x("RouterLink"),M=x("PaginationComponent");return l(),a("div",null,[v(i,{active:s.isLoading,"onUpdate:active":o[0]||(o[0]=e=>s.isLoading=e),"can-cancel":!1,"is-full-page":s.fullPage,"lock-scroll":!0},{default:P(()=>[rt]),_:1},8,["active","is-full-page"]),it,t("section",at,[t("div",lt,[t("ul",nt,[t("li",{class:d(["col text-center",{"pointer-events-none":s.pageStatus==="全部"}])},[t("a",{href:"#",onClick:o[1]||(o[1]=_(()=>s.selectPage="全部",["prevent"])),class:d(["text-decoration-none d-inline-block",{"fw-bold":s.pageStatus==="全部","link-primary":s.pageStatus==="全部"}])},[s.pageStatus!=="全部"?(l(),a("img",ct)):s.pageStatus==="全部"?(l(),a("img",dt)):h("",!0),pt],2)],2),t("li",{class:d(["col text-center",{"pointer-events-none":s.pageStatus==="食材組合包"}])},[t("a",{href:"#",onClick:o[2]||(o[2]=_(()=>s.selectPage="食材組合包",["prevent"])),class:d(["text-decoration-none d-inline-block",{"fw-bold":s.pageStatus==="食材組合包","link-primary":s.pageStatus==="食材組合包"}])},[s.pageStatus!=="食材組合包"?(l(),a("img",ut)):s.pageStatus==="食材組合包"?(l(),a("img",ht)):h("",!0),gt],2)],2),t("li",{class:d(["col text-center",{"pointer-events-none":s.pageStatus==="熱銷單品"}])},[t("a",{href:"#",onClick:o[3]||(o[3]=_(()=>s.selectPage="熱銷單品",["prevent"])),class:d(["text-decoration-none d-inline-block",{"fw-bold":s.pageStatus==="熱銷單品","link-primary":s.pageStatus==="熱銷單品"}])},[s.pageStatus!=="熱銷單品"?(l(),a("img",mt)):s.pageStatus==="熱銷單品"?(l(),a("img",ft)):h("",!0),bt],2)],2),t("li",{class:d(["col text-center",{"pointer-events-none":s.pageStatus==="特價商品"}])},[t("a",{href:"#",onClick:o[4]||(o[4]=_(()=>s.selectPage="特價商品",["prevent"])),class:d(["text-decoration-none d-inline-block",{"fw-bold":s.pageStatus==="特價商品","link-primary":s.pageStatus==="特價商品"}])},[s.pageStatus!=="特價商品"?(l(),a("img",_t)):s.pageStatus==="特價商品"?(l(),a("img",yt)):h("",!0),kt],2)],2)]),t("div",{class:d(["blue-line bg-primary position-absolute",{"active-all-ingredient":s.pageStatus==="全部","active-package":s.pageStatus==="食材組合包","active-hot":s.pageStatus==="熱銷單品","active-sale":s.pageStatus==="特價商品"}])},null,2)]),t("div",vt,[t("div",wt,[t("a",{class:"btn btn-outline-primary px-5",onClick:o[5]||(o[5]=()=>this.priceOrRateCollapse.toggle())},[c("篩選對象 "),Pt,t("span",xt,p(s.priceOrRate),1)]),t("button",{class:"btn btn-outline-primary px-5",type:"button",onClick:o[6]||(o[6]=()=>this.highOrLowCollapse.toggle())},[c("篩選值 "),Rt,t("span",Ot,p(s.highOrLow),1)]),m(t("input",{type:"search",class:"form-control border-primary border-end-0",placeholder:"請輸入食材名稱","aria-label":"Example text with two button addons","onUpdate:modelValue":o[7]||(o[7]=e=>s.productSearchName=e),onKeyup:o[8]||(o[8]=j((...e)=>n.searchProducts&&n.searchProducts(...e),["enter"]))},null,544),[[H,s.productSearchName]]),t("button",{type:"submit",class:"btn border border-primary border-start-0 bg-transparent d-flex",onClick:o[9]||(o[9]=_((...e)=>n.searchProducts&&n.searchProducts(...e),["prevent"]))},Ct)]),t("div",Lt,[t("div",Mt,[t("div",Bt,[t("div",Nt,[t("div",Vt,[m(t("input",{type:"radio",class:"btn-check",value:"價格",name:"priceOrRate",id:"selectprice",autocomplete:"off","onUpdate:modelValue":o[10]||(o[10]=e=>s.priceOrRate=e)},null,512),[[y,s.priceOrRate]]),Et,m(t("input",{type:"radio",class:"btn-check",value:"評價",name:"priceOrRate",id:"selectRate",autocomplete:"off","onUpdate:modelValue":o[11]||(o[11]=e=>s.priceOrRate=e)},null,512),[[y,s.priceOrRate]]),qt])])],512)]),t("div",Dt,[t("div",Tt,[t("div",Ut,[t("div",Ft,[m(t("input",{type:"radio",class:"btn-check",value:"不拘",name:"highOrLow",id:"noDifference",autocomplete:"off",checked:"","onUpdate:modelValue":o[12]||(o[12]=e=>s.highOrLow=e)},null,512),[[y,s.highOrLow]]),Gt,m(t("input",{type:"radio",class:"btn-check",value:"高到低",name:"highOrLow",id:"highToLow",autocomplete:"off","onUpdate:modelValue":o[13]||(o[13]=e=>s.highOrLow=e)},null,512),[[y,s.highOrLow]]),Ht,m(t("input",{type:"radio",class:"btn-check",value:"低到高",name:"highOrLow",id:"lowToHigh",autocomplete:"off","onUpdate:modelValue":o[14]||(o[14]=e=>s.highOrLow=e)},null,512),[[y,s.highOrLow]]),jt])])],512)])])]),s.filterProducts.length&&!s.isLoading?(l(),a("div",At,[(l(!0),a(C,null,L(this.$refs.pagination.pageProducts,e=>(l(),a("div",{class:"col",key:e.id},[t("div",It,[t("div",Yt,[v(u,{to:`/products/${e.id}`},{default:P(()=>[t("img",{src:e.imgUrl,class:"object-fit-cover card-img",alt:e.title},null,8,zt),Kt,e.isCheaper?(l(),a("span",Wt,p((100-((e.originalPrice-e.price)/e.originalPrice*100).toFixed(0))%10===0?(100-((e.originalPrice-e.price)/e.originalPrice*100).toFixed(0)).toString().charAt(0):100-((e.originalPrice-e.price)/e.originalPrice*100).toFixed(0))+" 折 ",1)):h("",!0)]),_:2},1032,["to"]),t("button",{type:"button",class:"position-absolute btn-bookmark border-0 bg-transparent top-0 end-0 m-2 m-md-3",onClick:()=>n.addBookmark(e)},Xt,8,Jt),(l(!0),a(C,null,L(s.bookMarks,R=>(l(),a("div",{key:R},[R===e.id?(l(),a("button",{key:0,type:"button",class:"position-absolute btn-bookmark-delete border-0 bg-transparent top-0 end-0 m-2 m-md-3",onClick:()=>n.deleteBookmark(e.id)},te,8,Zt)):h("",!0)]))),128)),t("button",{disabled:r.loadingItem==="loading",onClick:()=>r.addCart(e),type:"button",class:"btn-buy border-0 bg-transparent m-2 m-md-3 p-0 position-absolute end-0 bottom-0"},oe,8,ee)]),v(u,{to:`/products/${e.id}`,class:"card-body px-0 text-decoration-none link-darkBrown"},{default:P(()=>[t("h3",re,p(e.title),1),t("div",ie,[t("del",{class:d(["me-2 text-muted",{"d-none":!e.isCheaper}])},"NT$ "+p(r.numberComma(e.originalPrice)),3),t("span",{class:d(["me-1",{"text-danger":e.isCheaper,"fw-bold":e.isCheaper}])},"NT$ "+p(r.numberComma(e.price)),3),t("span",null," / "+p(e.num)+p(e.unit),1),t("span",{class:d(["badge rounded-pill ms-auto border d-none d-md-block",{"text-yellow":e.averageRate,"border-yellow":e.averageRate,"bg-lightYellow":e.averageRate,"bg-whiteGray":!e.averageRate,"text-gray":!e.averageRate,"border-gray":!e.averageRate}])},[c(p(e.averageRate)+" ",1),ae],2)]),t("div",le,[t("span",{class:d(["badge rounded-pill ms-auto border d-md-none",{"text-yellow":e.averageRate,"border-yellow":e.averageRate,"bg-lightYellow":e.averageRate,"bg-whiteGray":!e.averageRate,"text-gray":!e.averageRate,"border-gray":!e.averageRate}])},[c(p(e.averageRate)+" ",1),ne],2)])]),_:2},1032,["to"])])]))),128))])):!s.filterProducts.length&&s.search&&!s.isLoading?(l(),a("div",ce,ue)):h("",!0),v(M,{ref:"pagination","price-or-rate":s.priceOrRate,"filter-products":s.filterProducts,class:"mb-5"},null,8,["price-or-rate","filter-products"])])])}const Me=Z(ot,[["render",he]]);export{Me as default};
