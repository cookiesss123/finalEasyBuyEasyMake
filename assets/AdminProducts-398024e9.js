import{m as k}from"./modalMixin-c1848f69.js";import{v as u,b as y,a as V}from"./runtime-dom.esm-bundler-bb3e8e23.js";import{_ as f,o as n,U as c,V as t,Z as h,$ as r,a1 as _,a2 as b,a0 as a,Y as P,W as x,r as M,a4 as C}from"./_plugin-vue_export-helper-cbb9d8af.js";import"./modal-838a1639.js";import"./_commonjsHelpers-042e6b4d.js";import"./base-component-5a126788.js";const{VITE_PATH:m}={VITE_PATH:"http://localhost:3000",BASE_URL:"/finalEasyMakeEasyBuy/",MODE:"production",DEV:!1,PROD:!0},E={data(){return{tempProduct:{relevantRecipes:[],imgsUrl:[]},status:"edit",recipes:[]}},mixins:[k],props:["id","openModal","getProducts"],methods:{updateProduct(){this.status==="edit"?this.$http.put(`${m}/products/${this.tempProduct.id}`,this.tempProduct).then(o=>{console.log(o.data),this.getProducts(),this.hide()}).catch(o=>{console.log(o)}):this.status==="new"&&this.$http.post(`${m}/products`,this.tempProduct).then(o=>{console.log(o.data),this.getProducts(),this.hide()}).catch(o=>{console.log(o)})},getRecipes(){this.$http.get(`${m}/recipes`).then(o=>{console.log(o.data),this.recipes=o.data}).catch(o=>{console.log(o)})}},mounted(){this.getRecipes()},watch:{id(){this.id!=="new"&&this.id!==""?this.$http.get(`${m}/products/${this.id}`).then(o=>{this.tempProduct=o.data,this.tempProduct.imgsUrl||(this.tempProduct.imgsUrl=[]),console.log(this.tempProduct),this.show(),this.status="edit",this.openModal("")}).catch(o=>{console.log(o)}):this.id==="new"&&(this.tempProduct={relevantRecipes:[],isCheaper:!1,imgsUrl:[]},this.show(),this.status="new",this.openModal(""))}}},T={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},D={class:"modal-dialog modal-xl"},I={class:"modal-content"},R={class:"modal-header bg-dark"},A={class:"modal-title text-white",id:"exampleModalLabel"},S={key:0},B={key:1},H=t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),L={class:"modal-body"},$={class:"row"},N={class:"col-4"},O=t("label",{for:"mainPic",class:"form-label"},"主圖網址",-1),z=["src"],F=t("hr",null,null,-1),W=t("label",{for:"subPic",class:"form-label"},"副圖網址",-1),Y=["onUpdate:modelValue"],Z=["src"],j={class:"d-flex"},q=["onClick"],G={key:0,class:"d-flex mt-4"},J={class:"col-8"},K={class:"row gy-3"},Q={class:"col-2"},X=t("label",{for:"serialNumber",class:"form-label"},"編號（id）",-1),tt={class:"col-3"},et=t("label",{for:"category",class:"form-label"},"產品分類",-1),ot=t("option",{value:"單一產品"},"單一產品",-1),st=t("option",{value:"組合包"},"組合包",-1),lt=[ot,st],it={class:"col-7"},dt=t("label",{for:"title",class:"form-label"},"產品名稱",-1),nt={class:"col-3"},ct=t("label",{for:"content",class:"form-label"},"數量",-1),rt={class:"col-3"},at=t("label",{for:"content",class:"form-label"},"單位",-1),ut={class:"col-3"},pt=t("label",{for:"price",class:"form-label"},"喊得很高的原價",-1),mt={class:"col-3"},ht=t("label",{for:"price",class:"form-label"},"真實價格",-1),_t={class:"col-12"},bt={class:"form-check"},Pt=t("label",{class:"form-check-label",for:"isCheaper"}," 是否打折 ",-1),ft={class:"col-12"},gt=t("label",{for:"description",class:"form-label"},"產品描述",-1),vt={class:"col-12"},yt=t("label",{for:"price",class:"form-label"},"關聯食譜",-1),xt=["value"],Mt={class:"modal-footer"},Ut=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1),kt={key:0},wt={key:1};function Vt(o,s,g,v,e,d){return n(),c("div",T,[t("div",D,[t("div",I,[t("div",R,[t("h5",A,[e.status==="edit"?(n(),c("span",S,"編輯產品內容")):e.status==="new"?(n(),c("span",B,"新增產品內容")):h("",!0)]),H]),t("div",L,[t("div",$,[t("div",N,[O,r(t("input",{type:"text",id:"mainPic",class:"form-control mb-3","onUpdate:modelValue":s[0]||(s[0]=l=>e.tempProduct.imgUrl=l)},null,512),[[u,e.tempProduct.imgUrl]]),t("img",{src:e.tempProduct.imgUrl,alt:"",width:"300"},null,8,z),F,(n(!0),c(_,null,b(e.tempProduct.imgsUrl,(l,p)=>(n(),c("div",{key:l+3453},[W,r(t("input",{type:"text",id:"subPic",class:"form-control mb-3","onUpdate:modelValue":i=>e.tempProduct.imgsUrl[p]=i},null,8,Y),[[u,e.tempProduct.imgsUrl[p]]]),t("img",{src:e.tempProduct.imgsUrl[p],alt:"",width:"300"},null,8,Z),t("div",j,[t("button",{type:"button",class:"ms-auto btn btn-danger",onClick:()=>e.tempProduct.imgsUrl.splice(p,1)},"刪除圖片",8,q)])]))),128)),e.tempProduct.imgsUrl[e.tempProduct.imgsUrl.length-1]!==""?(n(),c("div",G,[t("button",{type:"button",class:"ms-auto btn btn-primary",onClick:s[1]||(s[1]=()=>e.tempProduct.imgsUrl.push(""))},"新增圖片")])):h("",!0)]),t("div",J,[t("div",K,[t("div",Q,[X,r(t("input",{type:"text",id:"serialNumber",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=l=>e.tempProduct.id=l),disabled:""},null,512),[[u,e.tempProduct.id]])]),t("div",tt,[et,r(t("select",{name:"",class:"form-select",id:"category","onUpdate:modelValue":s[3]||(s[3]=l=>e.tempProduct.category=l)},lt,512),[[y,e.tempProduct.category]])]),t("div",it,[dt,r(t("input",{type:"text",id:"title",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=l=>e.tempProduct.title=l)},null,512),[[u,e.tempProduct.title]])]),t("div",nt,[ct,r(t("input",{type:"text",id:"content",class:"form-control","onUpdate:modelValue":s[5]||(s[5]=l=>e.tempProduct.num=l)},null,512),[[u,e.tempProduct.num,void 0,{number:!0}]])]),t("div",rt,[at,r(t("input",{type:"text",id:"content",class:"form-control","onUpdate:modelValue":s[6]||(s[6]=l=>e.tempProduct.unit=l)},null,512),[[u,e.tempProduct.unit]])]),t("div",ut,[pt,r(t("input",{type:"text",id:"price",class:"form-control","onUpdate:modelValue":s[7]||(s[7]=l=>e.tempProduct.originalPrice=l)},null,512),[[u,e.tempProduct.originalPrice,void 0,{number:!0}]])]),t("div",mt,[ht,r(t("input",{type:"text",id:"price",class:"form-control","onUpdate:modelValue":s[8]||(s[8]=l=>e.tempProduct.price=l)},null,512),[[u,e.tempProduct.price,void 0,{number:!0}]])]),t("div",_t,[t("div",bt,[r(t("input",{class:"form-check-input",type:"checkbox",value:"","v-true":1,"v-false":0,id:"isCheaper","onUpdate:modelValue":s[9]||(s[9]=l=>e.tempProduct.isCheaper=l)},null,512),[[V,e.tempProduct.isCheaper]]),Pt])]),t("div",ft,[gt,r(t("textarea",{name:"",id:"description",cols:"30",rows:"10",class:"form-control","onUpdate:modelValue":s[10]||(s[10]=l=>e.tempProduct.description=l)},null,512),[[u,e.tempProduct.description]])]),t("div",vt,[yt,r(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":s[11]||(s[11]=l=>e.tempProduct.relevantRecipes=l),multiple:""},[(n(!0),c(_,null,b(e.recipes,l=>(n(),c("option",{key:l+4534534,value:l.title},a(l.title),9,xt))),128))],512),[[y,e.tempProduct.relevantRecipes]]),P(" "+a(e.tempProduct.relevantRecipes),1)])])])])]),t("div",Mt,[Ut,t("button",{type:"button",class:"btn btn-primary",onClick:s[12]||(s[12]=(...l)=>d.updateProduct&&d.updateProduct(...l))},[e.status==="edit"?(n(),c("span",kt,"確認編輯")):e.status==="new"?(n(),c("span",wt,"確認新增")):h("",!0)])])])])],512)}const Ct=f(E,[["render",Vt]]),{VITE_PATH:U}={VITE_PATH:"http://localhost:3000",BASE_URL:"/finalEasyMakeEasyBuy/",MODE:"production",DEV:!1,PROD:!0},Et={data(){return{tempProduct:{}}},mixins:[k],props:["id","openDeleteModal","getProducts"],methods:{deleteProdcut(){this.$http.delete(`${U}/products/${this.tempProduct.id}`).then(o=>{console.log(o.data),this.getProducts(),this.hide()}).catch(o=>{console.log(o)})}},watch:{id(){this.id&&(console.log(this.id,"改變了"),this.$http.get(`${U}/products/${this.id}`).then(o=>{this.tempProduct=o.data,console.log(this.tempProduct),this.show(),this.openDeleteModal("")}).catch(o=>{console.log(o)}))}}},Tt={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Dt={class:"modal-dialog"},It={class:"modal-content"},Rt=t("div",{class:"modal-header bg-dark"},[t("h5",{class:"modal-title text-white",id:"exampleModalLabel"}," 刪除產品 "),t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),At={class:"modal-body"},St={class:"text-danger fw-bold"},Bt={class:"modal-footer"},Ht=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1);function Lt(o,s,g,v,e,d){return n(),c("div",Tt,[t("div",Dt,[t("div",It,[Rt,t("div",At,[t("p",null,[P("確定要刪除產品 "),t("span",St," 【"+a(e.tempProduct.title)+"】 ",1),P(" 嗎? ")])]),t("div",Bt,[Ht,t("button",{type:"button",class:"btn btn-danger",onClick:s[0]||(s[0]=(...l)=>d.deleteProdcut&&d.deleteProdcut(...l))}," 確認刪除 ")])])])],512)}const $t=f(Et,[["render",Lt]]),{VITE_PATH:Nt}={VITE_PATH:"http://localhost:3000",BASE_URL:"/finalEasyMakeEasyBuy/",MODE:"production",DEV:!1,PROD:!0},Ot={components:{ProductModal:Ct,DeleteProductModal:$t},data(){return{products:[],productId:"",productDeleteId:"",selectCategory:"全部",tempSearchTitle:""}},computed:{search(){return this.products.filter(o=>o.title.match(this.tempSearchTitle))}},methods:{getProducts(){this.$http.get(`${Nt}/products`).then(o=>{console.log(o.data),this.products=o.data}).catch(o=>{console.log(o)})},openModal(o){this.productId=o},openDeleteModal(o){this.productDeleteId=o}},mounted(){this.getProducts()}},zt={class:"container"},Ft={class:"d-flex my-4"},Wt={class:"row mb-4"},Yt={class:"col-3"},Zt=t("label",{for:"searchProductTitle"},"搜尋產品名稱",-1),jt={class:"table text-center",style:{"vertical-align":"middle"}},qt=t("thead",null,[t("tr",null,[t("th",null,"產品編號"),t("th",null,"分類"),t("th",null,"產品名稱"),t("th",null,"相關食譜"),t("th",null,"內容物"),t("th",null,"原價"),t("th",null,"價格"),t("th",null,"是否打折"),t("th",null,"編輯")])],-1),Gt={style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","max-width":"400px"}},Jt={class:"text-success"},Kt={class:"btn-group"},Qt=["onClick"],Xt=["onClick"];function te(o,s,g,v,e,d){const l=M("ProductModal"),p=M("DeleteProductModal");return n(),c("div",zt,[t("div",Ft,[t("button",{type:"button",class:"ms-auto btn btn-primary",onClick:s[0]||(s[0]=i=>d.openModal("new"))},"建立新產品")]),t("div",Wt,[t("div",Yt,[Zt,r(t("input",{type:"text",id:"searchProductTitle",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=i=>e.tempSearchTitle=i)},null,512),[[u,e.tempSearchTitle]])])]),t("table",jt,[qt,t("tbody",null,[(n(!0),c(_,null,b(d.search,i=>(n(),c("tr",{key:i.id},[t("td",null,a(i.id),1),t("td",null,a(i.category),1),t("td",null,a(i.title),1),t("td",Gt,a(i.relevantRecipes.toString()),1),t("td",null,a(i.num)+" "+a(i.unit),1),t("td",null,a(i.originalPrice),1),t("td",Jt,a(i.price),1),t("td",{class:C({"text-success":i.isCheaper,"fw-bold":i.isCheaper})},a(`${i.isCheaper?"是":"否"}`),3),t("td",null,[t("div",Kt,[t("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:w=>d.openModal(i.id)},"編輯",8,Qt),t("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:w=>d.openDeleteModal(i.id)},"刪除",8,Xt)])])]))),128))])]),x(l,{ref:"productModal",id:e.productId,"open-modal":d.openModal,"get-products":d.getProducts},null,8,["id","open-modal","get-products"]),x(p,{ref:"deleteProductModal",id:e.productDeleteId,"get-products":d.getProducts,"open-delete-modal":d.openDeleteModal},null,8,["id","get-products","open-delete-modal"])])}const ne=f(Ot,[["render",te]]);export{ne as default};
