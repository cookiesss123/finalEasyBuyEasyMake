import{R as M}from"./vue-router-46224dd8.js";import{m as N,a as V}from"./index-bc28e9c9.js";import{c as O}from"./carts-6a8f7fc5.js";import{n as E}from"./numberCommaMixin-e0aac39c.js";import{P as D}from"./PaginationComponent-187a1eb1.js";import{C as R}from"./collapse-6026b968.js";import{r as m,b as v,o as q,d as f,s as I,c as T,a as j}from"./db-143b9a4b.js";import{L as H}from"./index-fde5e204.js";import{w as _,v as U,d as F,m as k}from"./runtime-dom.esm-bundler-e140de91.js";import{_ as G}from"./loadingLogo-ea15f612.js";import{_ as A,a as z}from"./fruit3-355a36ca.js";import{_ as K,a as W}from"./discount3-e2e49eb3.js";import{_ as X}from"./image5-4fc2427e.js";import{_ as Y}from"./image4-1806383b.js";import{_ as J}from"./icon-cart-796adfb7.js";import{_ as Q}from"./undraw_Page_not_found_re_e9o6-993b7155.js";import{_ as Z,a7 as a,F as w,a9 as x,a8 as e,af as c,ab as u,aa as d,ad as h,ac as b,N as C,ae as L,r as P,o as l}from"./_plugin-vue_export-helper-d28549df.js";import"./_commonjsHelpers-042e6b4d.js";import"./base-component-5a126788.js";const $="/finalEasyBuyEasyMake/assets/food1-d3cd1b3d.png",ee="/finalEasyBuyEasyMake/assets/food3-12ca3601.png",te="/finalEasyBuyEasyMake/assets/strawberry1-dc036a97.png",se="/finalEasyBuyEasyMake/assets/strawberry3-301f90ac.png";const oe={components:{RouterLink:M,PaginationComponent:D,Loading:H},data(){return{priceOrRateCollapse:{},highOrLowCollapse:{},user:{},uid:"",products:[],priceOrRate:"價格",highOrLow:"不拘",productSearchName:"",filterProducts:[],bookMarks:[],pageStatus:"全部",selectPage:"全部",search:!1,isLoading:!1,fullPage:!0}},mixins:[E],methods:{...N(O,["addCart","toastMessage"]),getProducts(){const i=m(f,"products/");v(i,o=>{this.products=o.val(),this.products=Object.entries(this.products).map(p=>(p[1].id=p[0],p[1]));const y=m(f,"productRates/");v(y,p=>{let t=p.val();t=Object.values(t).map((n,r)=>(n.id=Object.keys(t)[r],n)),this.products.forEach((n,r)=>{t.forEach(g=>{n.id===g.productId&&!this.products[r].scores?(this.products[r].scores=g.score,this.products[r].ratePeople=1,this.products[r].averageRate=Number((this.products[r].scores/this.products[r].ratePeople).toFixed(1))):n.id===g.productId&&this.products[r].scores&&(this.products[r].scores+=g.score,this.products[r].ratePeople+=1,this.products[r].averageRate=Number((this.products[r].scores/this.products[r].ratePeople).toFixed(1)))})}),this.products.forEach((n,r)=>{n.averageRate||(this.products[r].scores=0,this.products[r].ratePeople=0,this.products[r].averageRate=0)}),this.filterProducts=this.products,this.isLoading=!1,!this.$route.query.pageStatus&&this.$route.fullPath==="/products"?this.$refs.pagination.renderPage(1,this.filterProducts):this.$route.query.pageStatus&&this.searchProducts()})})},searchProducts(){this.pageStatus==="全部"?this.filterProducts=this.products:this.pageStatus==="食材組合包"?this.filterProducts=this.products.filter(i=>i.category==="組合包"):this.pageStatus==="熱銷單品"?this.filterProducts=this.products.filter(i=>i.category==="單一產品"):this.pageStatus==="特價商品"&&(this.filterProducts=this.products.filter(i=>i.isCheaper===!0)),this.priceOrRate==="價格"&&this.highOrLow!=="不拘"?this.highOrLow==="低到高"?this.filterProducts=this.filterProducts.sort((i,o)=>i.price-o.price):this.highOrLow==="高到低"&&(this.filterProducts=this.filterProducts.sort((i,o)=>o.price-i.price)):this.priceOrRate==="評價"&&this.highOrLow!=="不拘"&&(this.highOrLow==="低到高"?this.filterProducts=this.filterProducts.sort((i,o)=>i.averageRate!==o.averageRate?i.averageRate-o.averageRate:i.scores-o.scores):this.highOrLow==="高到低"&&(this.filterProducts=this.filterProducts.sort((i,o)=>i.averageRate!==o.averageRate?o.averageRate-i.averageRate:o.scores-i.scores))),this.filterProducts=this.filterProducts.filter(i=>i.title.match(this.productSearchName)),this.search=!0,this.$refs.pagination.renderPage(1,this.filterProducts)},getBookmarks(){q(j,i=>{if(i){this.uid=i.uid;const o=m(f,"users/"+i.uid);v(o,y=>{this.user=y.val();const p=m(f,`productBookmarks/${this.uid}`);v(p,t=>{this.bookMarks=t.val(),this.bookMarks&&(this.bookMarks=Object.keys(this.bookMarks))})})}else this.uid=null,this.user={}})},addBookmark(i){if(!this.uid){this.toastMessage("登入才可使用收藏功能","error");return}const o=m(f,`productBookmarks/${this.uid}/${i.id}`);I(o,i),this.toastMessage("收藏成功")},deleteBookmark(i){T(m(f,`productBookmarks/${this.uid}/${i}`)),this.toastMessage("刪除收藏")}},mounted(){this.isLoading=!0,this.priceOrRateCollapse=new R(this.$refs.priceOrRateCollapse,{toggle:!1,parent:"#myGroup"}),this.highOrLowCollapse=new R(this.$refs.highOrLowCollapse,{toggle:!1,parent:"#myGroup"}),(this.$route.query.pageStatus||this.$route.query.searchName||this.$route.query.valueHighOrLow||this.$route.query.valuePriceOrRate)&&(this.pageStatus=this.$route.query.pageStatus,this.priceOrRate=this.$route.query.valuePriceOrRate,this.highOrLow=this.$route.query.valueHighOrLow,this.productSearchName=this.$route.query.searchName),this.getProducts(),this.getBookmarks()},watch:{selectPage(){this.pageStatus=this.selectPage,this.productSearchName="",this.pageStatus==="全部"?this.filterProducts=this.products:this.pageStatus==="食材組合包"?this.filterProducts=this.products.filter(i=>i.category==="組合包"):this.pageStatus==="熱銷單品"?this.filterProducts=this.products.filter(i=>i.category==="單一產品"):this.pageStatus==="特價商品"&&(this.filterProducts=this.products.filter(i=>i.isCheaper===!0)),this.$refs.pagination.renderPage(1,this.filterProducts)},priceOrRate(){this.priceOrRateCollapse.hide()},highOrLow(){this.highOrLowCollapse.hide()},filterProducts(){this.priceOrRateCollapse.hide(),this.highOrLowCollapse.hide()}},computed:{...V(O,["loadingItem"])}},ie={class:"",style:{"overflow-x":"hidden"}},re=e("div",{class:"d-flex flex-column align-items-center py-10"},[e("img",{src:G,class:"loadingLogo mb-3",style:{width:"150px"},alt:""}),e("h1",{class:"text-center fw-bold text-blue"},[e("span",{class:"me-1 animate-text"},"L"),e("span",{class:"mx-1 animate-text"},"o"),e("span",{class:"mx-1 animate-text"},"a"),e("span",{class:"mx-1 animate-text"},"d"),e("span",{class:"mx-1 animate-text"},"i"),e("span",{class:"mx-1 animate-text"},"n"),e("span",{class:"mx-1 animate-text"},"g"),e("span",{class:"mx-2 animate-text"},"."),e("span",{class:"me-2 animate-text"},"."),e("span",{class:"animate-text"},".")])],-1),ae=e("section",{class:"bannerBg",style:{"background-image":"url('https://images.unsplash.com/photo-1678465952860-422bf820209b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80')"}},[e("div",{class:"mask"},[e("div",{class:"text",style:{background:"linear-gradient(to bottom, white 50% , #4572c2 50%)","-webkit-background-clip":"text"}}," 材料種類 ")])],-1),le={class:"container mt-4"},ne={class:"position-relative categorySelector row row-cols-4 gy-2 list-unstyled border-bottom"},ce={key:0,class:"productImg1",src:A,alt:""},de={key:1,src:z,alt:""},ue=e("span",{class:"titleSize"},[d("所有"),e("br",{class:"d-lg-none"}),d("材料")],-1),he={key:0,class:"productImg2",src:$,alt:""},pe={key:1,src:ee,alt:""},ge=e("span",{class:"titleSize text-center"},[d("食材"),e("br",{class:"d-lg-none"}),d("組合包")],-1),me={key:0,class:"productImg3",src:te,alt:""},fe={key:1,src:se,alt:""},be=e("span",{class:"titleSize"},[d("熱銷"),e("br",{class:"d-lg-none"}),d("單品")],-1),_e={key:0,class:"productImg4",src:K,alt:""},ke={key:1,src:W,alt:""},ye=e("span",{class:"titleSize"},[d("特價"),e("br",{class:"d-lg-none"}),d("商品")],-1),ve={class:"d-none d-lg-block container selectProduct pt-4"},we={class:"input-group"},xe=e("i",{class:"bi bi-caret-down-fill"},null,-1),Pe={class:"ms-2 fw-bold"},Se=e("i",{class:"bi bi-caret-down-fill"},null,-1),Oe={class:"ms-2 fw-bold"},Re=e("span",{class:"material-icons-outlined text-blue"},"search",-1),Ce=[Re],Le={class:"row g-0",id:"myGroup"},Be={class:"col-2"},Me={ref:"priceOrRateCollapse",class:"collapse"},Ne={class:"card card-body border-0",style:{border:"0px !important"}},Ve={class:"btn-group-vertical",role:"group","aria-label":"Vertical radio toggle button group"},Ee=e("label",{class:"btn btn-outline-blue",for:"selectprice"},"價格",-1),De=e("label",{class:"btn btn-outline-blue",for:"selectRate"},"評價",-1),qe={class:"col-2"},Ie={ref:"highOrLowCollapse",class:"collapse"},Te={class:"card card-body border-0",style:{border:"0px !important"}},je={class:"btn-group-vertical",role:"group","aria-label":"Vertical radio toggle button group"},He=e("label",{class:"btn btn-outline-blue",for:"noDifference"},"不拘",-1),Ue=e("label",{class:"btn btn-outline-blue",for:"highToLow"},"高到低",-1),Fe=e("label",{class:"btn btn-outline-blue",for:"lowToHigh"},"低到高",-1),Ge={class:"container mt-4"},Ae={key:0,class:"row row-cols-lg-4 row-cols-2 gy-4"},ze={class:"card position-relative bg-transparent",style:{border:"1px solid transparent","border-radius":"0"}},Ke={class:"cardImg"},We=["src"],Xe={class:"card-text mb-0"},Ye=e("p",{class:"detail d-none d-lg-block position-absolute fw-bold",style:{top:"35%",left:"50%",transform:"translateX(-50%)","letter-spacing":"5px"}},"查看商品資訊",-1),Je=["onClick"],Qe=e("img",{src:X},null,-1),Ze=[Qe],$e={key:0,style:{"pointer-events":"none"},class:"d-flex flex-column align-items-center text-white p-2 bg-blue position-absolute top-0 start-0"},et=["onClick"],tt=e("img",{src:Y},null,-1),st=[tt],ot=["disabled","onClick"],it=e("img",{src:J,alt:"",class:"rounded-circle shadow-sm"},null,-1),rt=[it],at={class:"fw-bold cardTextTitle"},lt={class:""},nt={class:"mt-1 d-block d-lg-inline-block"},ct={class:"mb-0 ms-auto starRates"},dt={class:"me-1"},ut=e("i",{class:"bi bi-star-fill"},null,-1),ht={key:1,class:"py-10"},pt=e("img",{src:Q,class:"mb-3",alt:"",style:{height:"250px",display:"block",margin:"auto"}},null,-1),gt=e("h2",{class:"text-center"},"查無商品，請您重新查詢",-1),mt=[pt,gt];function ft(i,o,y,p,t,n){const r=P("loading"),g=P("RouterLink"),B=P("PaginationComponent");return l(),a("div",ie,[w(r,{active:t.isLoading,"onUpdate:active":o[0]||(o[0]=s=>t.isLoading=s),"can-cancel":!1,"is-full-page":t.fullPage,"lock-scroll":!0},{default:x(()=>[re]),_:1},8,["active","is-full-page"]),ae,e("section",le,[e("ul",ne,[e("li",{class:c(["col d-flex align-items-center justify-content-center",{liDisabled:t.pageStatus==="全部"}])},[e("a",{href:"#",onClick:o[1]||(o[1]=_(()=>t.selectPage="全部",["prevent"])),class:c(["text-decoration-none d-flex flex-column align-items-center link-secondary",{"fw-bold":t.pageStatus==="全部","link-blue":t.pageStatus==="全部"}])},[t.pageStatus!=="全部"?(l(),a("img",ce)):t.pageStatus==="全部"?(l(),a("img",de)):u("",!0),ue],2)],2),e("li",{class:c(["col d-flex align-items-center justify-content-center",{liDisabled:t.pageStatus==="食材組合包"}])},[e("a",{href:"#",onClick:o[2]||(o[2]=_(()=>t.selectPage="食材組合包",["prevent"])),class:c(["text-decoration-none d-flex flex-column align-items-center link-secondary",{"fw-bold":t.pageStatus==="食材組合包","link-blue":t.pageStatus==="食材組合包"}])},[t.pageStatus!=="食材組合包"?(l(),a("img",he)):t.pageStatus==="食材組合包"?(l(),a("img",pe)):u("",!0),ge],2)],2),e("li",{class:c(["col d-flex align-items-center justify-content-center",{liDisabled:t.pageStatus==="熱銷單品"}])},[e("a",{href:"#",onClick:o[3]||(o[3]=_(()=>t.selectPage="熱銷單品",["prevent"])),class:c(["text-decoration-none d-flex flex-column align-items-center link-secondary",{"fw-bold":t.pageStatus==="熱銷單品","link-blue":t.pageStatus==="熱銷單品"}])},[t.pageStatus!=="熱銷單品"?(l(),a("img",me)):t.pageStatus==="熱銷單品"?(l(),a("img",fe)):u("",!0),be],2)],2),e("li",{class:c(["col d-flex align-items-center justify-content-center",{liDisabled:t.pageStatus==="特價商品"}])},[e("a",{href:"#",onClick:o[4]||(o[4]=_(()=>t.selectPage="特價商品",["prevent"])),class:c(["text-decoration-none d-flex flex-column align-items-center link-secondary",{"fw-bold":t.pageStatus==="特價商品","link-blue":t.pageStatus==="特價商品"}])},[t.pageStatus!=="特價商品"?(l(),a("img",_e)):t.pageStatus==="特價商品"?(l(),a("img",ke)):u("",!0),ye],2)],2),e("li",{class:c(["redLine bg-blue position-absolute",{activeAllIngredient:t.pageStatus==="全部",activePackage:t.pageStatus==="食材組合包",activeHot:t.pageStatus==="熱銷單品",activeSale:t.pageStatus==="特價商品"}]),style:{height:"2px",bottom:"0px",left:"5.5%"}},null,2)])]),e("div",ve,[e("div",we,[e("a",{class:"btn btn-outline-blue px-5",onClick:o[5]||(o[5]=()=>this.priceOrRateCollapse.toggle())},[d("篩選對象 "),xe,e("span",Pe,h(t.priceOrRate),1)]),e("button",{class:"btn btn-outline-blue px-5",type:"button",onClick:o[6]||(o[6]=()=>this.highOrLowCollapse.toggle())},[d("篩選值 "),Se,e("span",Oe,h(t.highOrLow),1)]),b(e("input",{type:"search",class:"form-control border-blue border-end-0",placeholder:"請輸入食材名稱","aria-label":"Example text with two button addons","onUpdate:modelValue":o[7]||(o[7]=s=>t.productSearchName=s),onKeyup:o[8]||(o[8]=F((...s)=>n.searchProducts&&n.searchProducts(...s),["enter"]))},null,544),[[U,t.productSearchName]]),e("button",{type:"submit",class:"btn border border-blue border-start-0 bg-transparent d-flex",onClick:o[9]||(o[9]=_((...s)=>n.searchProducts&&n.searchProducts(...s),["prevent"]))},Ce)]),e("div",Le,[e("div",Be,[e("div",Me,[e("div",Ne,[e("div",Ve,[b(e("input",{type:"radio",class:"btn-check",value:"價格",name:"priceOrRate",id:"selectprice",autocomplete:"off","onUpdate:modelValue":o[10]||(o[10]=s=>t.priceOrRate=s)},null,512),[[k,t.priceOrRate]]),Ee,b(e("input",{type:"radio",class:"btn-check",value:"評價",name:"priceOrRate",id:"selectRate",autocomplete:"off","onUpdate:modelValue":o[11]||(o[11]=s=>t.priceOrRate=s)},null,512),[[k,t.priceOrRate]]),De])])],512)]),e("div",qe,[e("div",Ie,[e("div",Te,[e("div",je,[b(e("input",{type:"radio",class:"btn-check",value:"不拘",name:"highOrLow",id:"noDifference",autocomplete:"off",checked:"","onUpdate:modelValue":o[12]||(o[12]=s=>t.highOrLow=s)},null,512),[[k,t.highOrLow]]),He,b(e("input",{type:"radio",class:"btn-check",value:"高到低",name:"highOrLow",id:"highToLow",autocomplete:"off","onUpdate:modelValue":o[13]||(o[13]=s=>t.highOrLow=s)},null,512),[[k,t.highOrLow]]),Ue,b(e("input",{type:"radio",class:"btn-check",value:"低到高",name:"highOrLow",id:"lowToHigh",autocomplete:"off","onUpdate:modelValue":o[14]||(o[14]=s=>t.highOrLow=s)},null,512),[[k,t.highOrLow]]),Fe])])],512)])])]),e("div",Ge,[t.filterProducts.length&&!t.isLoading?(l(),a("div",Ae,[(l(!0),a(C,null,L(this.$refs.pagination.pageProducts,s=>(l(),a("div",{class:"col text-decoration-none",key:s.id},[e("div",ze,[e("div",Ke,[w(g,{to:`/products/${s.id}`,class:"enlargeImg border-0"},{default:x(()=>[e("img",{src:s.imgUrl,class:"card-img",height:"220",style:{"object-fit":"cover","max-width":"100%","max-height":"100%","border-radius":"0"},alt:""},null,8,We)]),_:2},1032,["to"])]),e("h5",Xe,[Ye,e("button",{type:"button",class:"position-absolute bookmarkBtn border-0 bg-transparent end-0 top-0 m-lg-3 m-2",onClick:()=>n.addBookmark(s)},Ze,8,Je),s.isCheaper?(l(),a("span",$e,h((100-((s.originalPrice-s.price)/s.originalPrice*100).toFixed(0))%10===0?(100-((s.originalPrice-s.price)/s.originalPrice*100).toFixed(0)).toString().charAt(0):100-((s.originalPrice-s.price)/s.originalPrice*100).toFixed(0))+" 折 ",1)):u("",!0),(l(!0),a(C,null,L(t.bookMarks,S=>(l(),a("div",{key:S},[S===s.id?(l(),a("button",{key:0,type:"button",class:"position-absolute deleteBookmarkBtn border-0 bg-transparent end-0 top-0 m-lg-3 m-2",onClick:()=>n.deleteBookmark(s.id)},st,8,et)):u("",!0)]))),128)),e("button",{disabled:i.loadingItem==="loading",onClick:()=>i.addCart(s),type:"button",class:"buyBtn border-0 bg-transparent me-lg-2 me-1 position-absolute end-0"},rt,8,ot)]),w(g,{to:`/products/${s.id}`,class:"card-footer bg-transparent border-0 text-decoration-none link-darkBrown pt-lg-3"},{default:x(()=>[e("h5",at,h(s.title),1),e("div",{class:c(["d-flex align-items-lg-center cardTextPrice",{"align-items-end":s.isCheaper,"align-items-center":!s.isCheaper}])},[e("div",lt,[s.originalPrice?(l(),a("del",{key:0,class:c(["me-2 text-muted mt-1",{"d-none":!s.isCheaper}])},"NT$ "+h(i.numberComma(s.originalPrice)),3)):u("",!0),e("span",nt,[s.price?(l(),a("span",{key:0,class:c({"text-danger":s.isCheaper,"fw-bold":s.isCheaper})}," NT$ "+h(i.numberComma(s.price)),3)):u("",!0),d(" / "+h(s.num)+h(s.unit),1)])]),e("h5",ct,[e("div",{class:c(["badge border rounded-pill bg-white",{"text-yellow":s.averageRate,"border-yellow":s.averageRate,"text-lightBrownGray":!s.averageRate,"border-lightBrownGray":!s.averageRate}])},[e("span",dt,h(s.averageRate),1),ut],2)])],2)]),_:2},1032,["to"])])]))),128))])):!t.filterProducts.length&&t.search&&!t.isLoading?(l(),a("div",ht,mt)):u("",!0)]),w(B,{ref:"pagination","price-or-rate":t.priceOrRate,"filter-products":t.filterProducts,class:"mb-5"},null,8,["price-or-rate","filter-products"])])}const qt=Z(oe,[["render",ft]]);export{qt as default};
