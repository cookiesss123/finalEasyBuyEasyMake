import{S as C,a as I,N as B,P as M}from"./pagination.min-4c192961.js";import{k as R,l as N,n as E}from"./runtime-dom.esm-bundler-eb0e3820.js";import{m as P}from"./axios-b39dce87.js";import{c as j}from"./carts-e98b6691.js";import{b6 as $,av as k,aj as l,l as r,m as e,t as y,b1 as b,aJ as n,k as _,F as m,at as p,s as d,a3 as A,b3 as w,j as f}from"./_plugin-vue_export-helper-68081c38.js";import"./vue-router-99ebe252.js";import"./_commonjsHelpers-042e6b4d.js";const{VITE_PATH:a}={VITE_PATH:"https://vue-final-dbjson-889xxtffg-cookiesss123.vercel.app",BASE_URL:"/finalEasyMakeEasyBuy/",MODE:"production",DEV:!1,PROD:!0},S={components:{Swiper:C,SwiperSlide:I},data(){return{recipe:{},nickName:"",modules:[B,M],navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",bulletClass:"my-bullet-class",bulletActiveClass:"my-bullet-active-class"},mainImg:"",userId:"",token:"",bookMark:[],recipeThumbs:[],myThumb:[],recipeComments:[],recipeMessage:"",qty:1,groupProduct:{}}},methods:{...P(j,["addCart"]),getRecipe(){const{id:c}=this.$route.params;this.$http.get(`${a}/recipes/${c}`).then(t=>{console.log(t.data),this.recipe=t.data,this.mainImg=this.recipe.image,this.groupProduct=this.recipe.relativeProducts.filter(i=>i.category==="組合包"),this.groupProduct=this.groupProduct[0],console.log(this.groupProduct,"組合產品")}).catch(t=>{console.log(t)})},getRecipes(){this.$http.get(`${a}/recipes`).then(c=>{console.log(c.data),this.recipes=c.data,this.recipes.forEach(t=>{this.product.relevantRecipes.forEach(i=>{t.title===i&&this.relevantRecipesInfo.push(t)}),console.log("相關食譜詳細資訊",this.relevantRecipesInfo)})}).catch(c=>{console.log(c)})},getBookmark(){const{id:c}=this.$route.params,t=`${a}/600/users/${this.userId}/recipeBookmarks?recipeId=${c}&_expand=recipe`;this.$http.get(t,{headers:{authorization:`Bearer ${this.token}`}}).then(i=>{console.log(i.data),this.bookMark=i.data}).catch(i=>{console.log(i)})},addBookmark(c){const t={userId:this.userId,recipeId:c};this.$http.post(`${a}/600/users/${this.userId}/recipeBookmarks?_expand=recipe`,t,{headers:{authorization:`Bearer ${this.token}`}}).then(i=>{console.log(i.data),this.getBookmark(),console.log("收藏成功!")}).catch(i=>{console.log(i)})},deleteBookmark(){let c="";this.bookMark.forEach(t=>{c=t.id}),this.$http.delete(`${a}/600/recipeBookmarks/${Number(c)}`,{headers:{authorization:`Bearer ${this.token}`}}).then(t=>{console.log(t.data),this.getBookmark(),console.log("刪除收藏")}).catch(t=>{console.log(t)})},getAllRecipeThumbs(){const{id:c}=this.$route.params,t=`${a}/recipe/${c}/recipeThumbs?_expand=recipe`;this.$http.get(t).then(i=>{console.log(i.data),this.recipeThumbs=i.data,this.recipeThumbs.length||console.log("沒人按讚")}).catch(i=>{console.log(i)})},getMyThumb(){const{id:c}=this.$route.params,t=`${a}/600/users/${this.userId}/recipeThumbs?recipeId=${c}&_expand=recipe`;this.$http.get(t,{headers:{authorization:`Bearer ${this.token}`}}).then(i=>{console.log("我有按讚嗎?",i.data),this.myThumb=i.data}).catch(i=>{console.log(i)})},addRecipeThumb(){const{id:c}=this.$route.params,t={recipeId:c,thumb:!0},i=`${a}/600/users/${this.userId}/recipeThumbs`;this.$http.post(i,t,{headers:{authorization:`Bearer ${this.token}`}}).then(u=>{console.log(u.data),console.log("按讚成功"),this.getAllRecipeThumbs(),this.getMyThumb()}).catch(u=>{console.log(u)})},deleteRecipeThumb(){this.getMyThumb();let c="";this.myThumb.forEach(i=>{c=i.id});const t=`${a}/600/recipeThumbs/${c}`;this.$http.delete(t,{headers:{authorization:`Bearer ${this.token}`}}).then(i=>{console.log(i.data),console.log("取消按讚"),this.getAllRecipeThumbs(),this.getMyThumb()}).catch(i=>{console.log(i)})},getComments(){const{id:c}=this.$route.params,t=`${a}/recipe/${c}/recipeComments?_expand=user`;this.$http.get(t).then(i=>{console.log(i.data),this.recipeComments=i.data,this.recipeComments.length||console.log("沒人評論")}).catch(i=>{console.log(i)})},addComments(){if(!this.recipeMessage){console.log("您還未寫下任何內容喔!");return}const{id:c}=this.$route.params,t={recipeId:c,message:this.recipeMessage,createAt:new Date().getTime()},i=`${a}/600/users/${this.userId}/recipeComments?_expand=user`;this.$http.post(i,t,{headers:{authorization:`Bearer ${this.token}`}}).then(u=>{console.log("新增留言成功",u.data),this.getComments(),this.recipeMessage=""}).catch(u=>{console.log(u)})}},mounted(){this.getRecipe(),this.nickName=localStorage.getItem("nickName"),this.token=document.cookie.replace(/(?:(?:^|.*;\s*)myToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),console.log(this.nickName),this.userId=localStorage.getItem("userId"),this.userId=Number(this.userId),this.getBookmark(),this.getAllRecipeThumbs(),this.getMyThumb(),this.getComments()}},V={class:"py-100-sm-40"},z={class:"container"},D={"aria-label":"breadcrumb"},q={class:"breadcrumb"},U={class:"breadcrumb-item fs-5"},L={class:"breadcrumb-item active fs-5 d-none d-lg-block","aria-current":"page"},F={class:"container d-flex justify-content-center mt-5"},H={class:"col-10"},O={class:"row"},Y={class:"col-6"},J={class:"row g-3"},G={class:"col-12 d-flex"},K=["src"],Q={class:"col-12"},W=["src"],X=["src"],Z={class:"col-6"},ee={class:"row d-flex align-items-center"},te={class:"col-2"},se={class:"badge rounded-pill bg-brown"},oe={class:"col-10 d-flex text-brown"},ie={class:"h3"},ce={class:"ms-auto"},le=e("i",{class:"bi bi-heart"},null,-1),ne=[le],re=e("i",{class:"bi bi-heart-fill"},null,-1),ae=[re],he={key:2,class:"mb-0 ms-3"},de=e("i",{class:"bi bi-hand-thumbs-up"},null,-1),ue=[de],me=e("i",{class:"bi bi-hand-thumbs-up-fill"},null,-1),pe=[me],be=e("h5",{class:"text-lightBrown"},"甜點介紹：",-1),_e={class:"mb-5"},ge={class:"bg-lightYellow my-5"},ke={class:"container py-5"},ye={class:"row g-5"},fe={class:"col-6"},ve=e("h3",{class:"mb-3 fw-bold"},[e("span",{class:"material-icons"},"egg"),d(" 準備材料")],-1),we={class:"me-3"},xe={class:"row mb-6"},Te=e("h3",{class:"mb-3 fw-bold"},[e("span",{class:"material-icons-outlined"},"soup_kitchen"),d(" 製作步驟")],-1),Ce={key:0},Ie=e("h3",{class:"mt-6 mb-3 fw-bold"},[e("i",{class:"bi bi-youtube"}),d(" 教學影片")],-1),Be=["src"],Me={class:"col-6"},Re=e("h3",{class:"mb-4 fw-bold"},[e("i",{class:"bi bi-bag-check-fill"}),d(" 相關產品")],-1),Ne={class:"row"},Ee={class:"col-12"},Pe=["src"],je={class:"fw-bold mt-2"},$e={class:"row align-items-center"},Ae={class:"col-5 h5 mb-0"},Se={class:"text-secondary me-3"},Ve={class:"text-danger"},ze={class:"col-7 d-flex align-items-center"},De=["value"],qe={class:"row mt-4"},Ue=["src"],Le={class:"fw-bold mt-2 text-center"},Fe={class:"container py-5"},He=e("h3",null,[e("i",{class:"bi bi-stars"}),d(" 顧客評價"),e("span",{class:"ms-4",style:{"font-size":"16px"}},"您的支持就是我們進步的動力~")],-1),Oe={class:"my-5"},Ye={class:"mb-3 fw-bold d-flex align-items-center"},Je=e("i",{class:"bi bi-person-circle fs-1 me-3"},null,-1),Ge={action:""},Ke={class:"d-flex"},Qe={class:"row gy-5"},We={class:"mb-0 fw-bold d-flex align-items-center"},Xe=e("i",{class:"bi bi-person-circle fs-1 me-3"},null,-1),Ze={class:"mb-0"};function et(c,t,i,u,o,h){const g=k("RouterLink"),v=k("swiper-slide"),x=k("swiper");return l(),r("div",V,[e("div",z,[e("nav",D,[e("ol",q,[e("li",U,[y(g,{to:"/recipes",class:"link-orange d-none d-lg-block"},{default:b(()=>[d("甜點食譜")]),_:1})]),e("li",L,n(o.recipe.title),1)])])]),e("section",F,[e("div",H,[e("div",O,[e("div",Y,[e("div",J,[e("div",G,[e("img",{src:o.mainImg,width:"400",height:"300",style:{"object-fit":"cover"},class:"mx-auto",alt:""},null,8,K)]),e("div",Q,[y(x,{"slides-per-view":3,"space-between":10,modules:o.modules,navigation:"",pagination:{clickable:!0}},{default:b(()=>[y(v,{style:{cursor:"pointer"},onClick:t[0]||(t[0]=()=>o.mainImg=o.recipe.image)},{default:b(()=>[e("img",{src:o.recipe.image,alt:"",style:{"object-fit":"cover"}},null,8,W)]),_:1}),(l(!0),r(m,null,p(o.recipe.imgsUrl,s=>(l(),f(v,{key:s+45345,style:{cursor:"pointer"},onClick:()=>o.mainImg=s},{default:b(()=>[e("img",{src:s,alt:"",style:{"object-fit":"cover"}},null,8,X)]),_:2},1032,["onClick"]))),128))]),_:1},8,["modules"])])])]),e("div",Z,[e("div",ee,[e("h5",te,[e("span",se,n(o.recipe.category),1)]),e("div",oe,[e("h1",ie,n(o.recipe.title),1),e("div",ce,[o.bookMark.length===0?(l(),r("button",{key:0,type:"button",class:"border-0 bg-transparent text-brown fs-4",onClick:t[1]||(t[1]=()=>h.addBookmark(o.recipe.id))},ne)):o.bookMark.length!==0?(l(),r("button",{key:1,type:"button",class:"border-0 bg-transparent fs-4",onClick:t[2]||(t[2]=(...s)=>h.deleteBookmark&&h.deleteBookmark(...s)),style:{color:"#fa6e42"}},ae)):_("",!0),o.recipeThumbs?(l(),r("span",he,n(o.recipeThumbs.length),1)):_("",!0),o.myThumb.length?o.myThumb.length?(l(),r("button",{key:4,type:"button",class:"border-0 bg-transparent text-brown fs-4",onClick:t[4]||(t[4]=(...s)=>h.deleteRecipeThumb&&h.deleteRecipeThumb(...s))},pe)):_("",!0):(l(),r("button",{key:3,type:"button",class:"border-0 bg-transparent text-brown fs-4",onClick:t[3]||(t[3]=(...s)=>h.addRecipeThumb&&h.addRecipeThumb(...s))},ue))])])]),e("h5",null,"食譜作者："+n(o.recipe.author),1),e("h5",null,"份量："+n(o.recipe.content),1),be,e("p",_e,n(o.recipe.description),1)])])])]),e("section",ge,[e("div",ke,[e("div",ye,[e("div",fe,[ve,e("h5",we,"成本：NT$ "+n(o.recipe.total),1),e("div",xe,[(l(!0),r(m,null,p(o.recipe.ingredients,(s,T)=>(l(),r("div",{class:"col-12",key:s+367657},n(T+1)+". "+n(s.name)+" "+n(s.num)+" "+n(s.unit),1))),128))]),Te,o.recipe.instructions?(l(),r("div",Ce,[(l(!0),r(m,null,p(o.recipe.instructions.split("/"),s=>(l(),r("p",{class:"me-3",key:s+346346},n(s),1))),128))])):_("",!0),Ie,e("iframe",{width:"560",height:"315",src:o.recipe.video,title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:""},null,8,Be)]),e("div",Me,[Re,e("div",Ne,[e("div",Ee,[(l(!0),r(m,null,p(o.recipe.relativeProducts,s=>(l(),r("div",{key:s.id+456496},[s.category==="組合包"?(l(),f(g,{key:0,to:`/products/${s.id}`,class:"link-brown"},{default:b(()=>[e("img",{src:s.imgUrl,alt:"",width:"300",height:"150",style:{"object-fit":"cover"}},null,8,Pe),e("p",je,n(s.title),1)]),_:2},1032,["to"])):_("",!0)]))),128))])]),e("div",$e,[e("p",Ae,[e("del",Se,"NT$ "+n(o.recipe.total),1),e("span",Ve,"NT$ "+n(o.recipe.price),1),d(" / 組 ")]),e("div",ze,[e("button",{class:A(["btn btn-sm btn-brown rounded-circle",{disabled:o.qty===1}]),style:{width:"30px",height:"30px"},type:"button",id:"button-addon2",onClick:t[5]||(t[5]=()=>o.qty-=1)},"-",2),w(e("select",{name:"",id:"",class:"form-select border-0 text-center","onUpdate:modelValue":t[6]||(t[6]=s=>o.qty=s),style:{width:"70px"}},[(l(),r(m,null,p(30,s=>e("option",{value:s,key:s+4596945},n(s),9,De)),64))],512),[[R,o.qty]]),e("button",{class:"btn btn-sm btn-brown rounded-circle",style:{width:"30px",height:"30px"},type:"button",id:"button-addon2",onClick:t[7]||(t[7]=()=>o.qty+=1)},"+"),e("button",{class:"ms-4 btn btn-brown",type:"button",id:"button-addon2",onClick:t[8]||(t[8]=()=>c.addCart(o.groupProduct,o.qty))},"一鍵買齊")])]),e("div",qe,[(l(!0),r(m,null,p(o.recipe.relativeProducts,s=>(l(),r("div",{class:"col-4",key:s.id+456496},[s.category==="單一產品"?(l(),f(g,{key:0,to:`/products/${s.id}`,class:"link-brown"},{default:b(()=>[e("img",{src:s.imgUrl,alt:"",width:"200",height:"150",style:{"object-fit":"cover"}},null,8,Ue),e("p",Le,n(s.title),1)]),_:2},1032,["to"])):_("",!0)]))),128))])])])])]),e("section",Fe,[He,e("div",Oe,[e("h5",Ye,[Je,d(" "+n(o.nickName),1)]),e("form",Ge,[w(e("textarea",{class:"form-control",name:"",id:"",cols:"30",rows:"10","onUpdate:modelValue":t[9]||(t[9]=s=>o.recipeMessage=s)},null,512),[[N,o.recipeMessage]]),e("div",Ke,[e("button",{type:"submit",class:"ms-auto btn btn-brown mt-3",onClick:t[10]||(t[10]=E((...s)=>h.addComments&&h.addComments(...s),["prevent"]))},"送出")])]),e("div",Qe,[(l(!0),r(m,null,p(o.recipeComments,s=>(l(),r("div",{class:"col-12 border-bottom",key:s.id+3657},[e("h5",We,[Xe,d(" "+n(s.user.nickName),1)]),e("p",Ze,n(`${new Date(s.createAt).toLocaleDateString()}`),1),e("p",null,n(s.message),1)]))),128))])])])])}const rt=$(S,[["render",et]]);export{rt as default};
