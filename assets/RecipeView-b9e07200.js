import{l as S}from"./loadingStore-73c40ae8.js";import{S as j,a as A,N as R,P as V}from"./pagination.min-d05afe88.js";import{k as L,l as U,n as D}from"./runtime-dom.esm-bundler-eb0e3820.js";import{f as C,m as q}from"./index-9f8e1fb0.js";import{o as E,r as a,d as m,b as w,s as v,e as F,p as z,c as G,a as J}from"./carts-18eb5781.js";import{m as P}from"./bookmark-53538cba.js";import{n as O}from"./numberCommaMixin-e0aac39c.js";import{b6 as Y,av as N,aj as i,l as c,m as e,t as y,b1 as d,aJ as l,k as u,a3 as p,F as _,at as f,s as n,b3 as B,j as x}from"./_plugin-vue_export-helper-68081c38.js";const H={components:{Swiper:j,SwiperSlide:A},mixins:[O],data(){return{recipeId:"",recipe:{},modules:[R,V],navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",bulletClass:"my-bullet-class",bulletActiveClass:"my-bullet-active-class"},mainImg:"",allThumbNum:0,myThumb:{},recipeComments:[],recipeMessage:"",qty:1,groupProduct:{}}},methods:{...C(G,["addCart","toastMessage","goToTop"]),...C(P,["addBookmark","deleteBookmark","getBookmark"]),...C(S,["startLoading"]),getMyThumb(){E(J,o=>{if(o){const{id:r}=this.$route.params,h=a(m,`recipePersonalThumbs/${o.uid}/${r}`);w(h,k=>{this.myThumb=k.val()})}else this.myThumb=null})},getAllThumbs(){const o=a(m,`recipeThumbs/${this.recipeId}`);w(o,r=>{this.allThumbNum=r.val(),this.allThumbNum?this.allThumbNum=this.allThumbNum.thumbs:this.allThumbNum=0})},getRecipe(){const o=a(m,`recipes/${this.recipeId}`);w(o,r=>{this.recipe=r.val(),this.recipe.id=this.recipeId,this.mainImg=this.recipe.image,this.groupProduct=this.recipe.relativeProducts.filter(h=>h.category==="組合包"),this.groupProduct=this.groupProduct[0]})},getAllComments(){const o=a(m,"recipeComments/");w(o,r=>{const h=r.val();this.recipeComments=Object.values(h).filter(k=>k.recipeId===this.recipeId)})},addThumb(){if(!this.uid){this.toastMessage("登入才可按讚","error");return}const o=a(m,`recipePersonalThumbs/${this.uid}/${this.recipe.id}`);v(o,this.recipe);const r=a(m,`recipeThumbs/${this.recipe.id}`);v(r,{thumbs:this.allThumbNum+1}),this.toastMessage("按讚成功")},deleteThumb(){F(a(m,`recipePersonalThumbs/${this.uid}/${this.recipe.id}`));const o=a(m,`recipeThumbs/${this.recipe.id}`);v(o,{thumbs:this.allThumbNum-1}),this.toastMessage("取消按讚")},addComments(){const o=a(m,"recipeComments"),r=z(o);v(r,{recipeId:this.recipe.id,createAt:new Date().getTime(),message:this.recipeMessage,username:this.user.nickName,userImg:this.user.headshotImg}),this.recipeMessage=""}},mounted(){this.startLoading();const{id:o}=this.$route.params;this.recipeId=o,this.goToTop(),this.getAllThumbs(),this.getMyThumb(),this.getRecipe(),this.getAllComments(),this.getBookmark("recipeBookmarks",o)},computed:{...q(P,["recipeBookmark","uid","user"])}},K={class:"no-scroll-x"},Q={class:"container py-md-96 py-60"},W={"aria-label":"breadcrumb"},X={class:"breadcrumb"},Z={class:"breadcrumb-item"},$={class:"breadcrumb-item active","aria-current":"page"},ee={class:"row row-cols-lg-2 row-cols-1 g-5"},se={class:"col"},te=["src","alt"],oe={class:"sub-picture-swiper position-relative"},re=["src"],ie=["src","alt","onClick"],le={class:"col d-flex flex-column"},ce={class:"d-flex align-items-center mb-3"},ne={class:"badge rounded-pill bg-primary fs-6 me-2"},ae={class:"mb-0 fs-lg-4 fs-5 fw-bold"},me={class:"d-flex align-items-center ms-auto"},de=e("i",{class:"bi bi-heart"},null,-1),ue=[de],pe=e("i",{class:"bi bi-heart-fill"},null,-1),he=[pe],be=e("i",{class:"bi bi-hand-thumbs-up"},null,-1),ge=e("i",{class:"bi bi-hand-thumbs-up-fill"},null,-1),_e={class:"table fs-md-5 mb-2"},fe=e("th",{class:"fw-normal text-muted",width:"150"},"食譜作者",-1),ye={class:"fw-normal"},ke=e("td",{class:"text-muted"},"份量",-1),we=e("td",{class:"text-muted"},"甜點介紹",-1),ve={class:"fs-6 lh-lg"},xe={class:"bg-light-purple-secondary"},Te={class:"container py-lg-96 py-5"},Ce={class:"row row-cols-lg-2 row-cols-1 g-80"},Ne={class:"col"},Ie=e("h3",{class:"d-flex align-items-center mb-4 fw-bold text-purple border-bottom pb-1 border-purple"},[e("span",{class:"material-icons me-2"}," auto_awesome "),n(" 準備材料 ")],-1),Pe={class:"table table- table-hover mb-60"},Be=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"名稱"),e("th",{scope:"col"},"單位")])],-1),Me={scope:"row"},Se=e("h3",{class:"d-flex align-items-center mb-4 fw-bold text-purple border-bottom pb-1 border-purple"},[e("span",{class:"material-icons me-2"}," auto_awesome "),n(" 相關產品 ")],-1),je={class:"d-flex mb-3"},Ae={class:"card bg-transparent w-50 mx-auto"},Re=["src","alt"],Ve=e("p",{class:"detail position-absolute top-50 start-50 translate-middle fw-bold letter-spacing-5 link-darkBrown fs-xl-5 text-center"},[n("查看"),e("br",{class:"d-xl-none d-lg-block"}),n("詳細食譜")],-1),Le={class:"fs-md-5 fs-6"},Ue={class:"d-flex justify-content-between align-items-end"},De={class:"mb-0 d-flex flex-column"},qe={class:"text-gray fs-6 me-3"},Ee={class:"fs-5 text-danger fw-bold"},Fe=e("span",{class:"text-darkBrown"}," / 組",-1),ze={class:"input-group w-50"},Ge=["value"],Je={class:"row mt-5 row-cols-lg-3 row-cols-2 g-3"},Oe={class:"card bg-transparent"},Ye=["src","alt"],He=e("p",{class:"detail position-absolute top-50 start-50 translate-middle fw-bold link-darkBrown letter-spacing-5 text-center"},[n("查看"),e("br"),n("商品資訊")],-1),Ke={class:"fs-6"},Qe={class:"col"},We=e("h3",{class:"d-flex align-items-center mb-4 fw-bold text-purple border-bottom pb-1 border-purple"},[e("span",{class:"material-icons me-2"}," auto_awesome "),n(" 製作步驟 ")],-1),Xe={key:0,class:"mb-60"},Ze=e("h3",{class:"d-flex align-items-center mb-4 fw-bold text-purple border-bottom pb-1 border-purple"},[e("span",{class:"material-icons me-2"}," auto_awesome "),n(" 教學影片 ")],-1),$e=["src"],es={class:"container py-lg-96 py-5"},ss={class:"d-flex align-items-center fw-bold text-purple border-bottom pb-1 border-purple mb-4"},ts=e("span",{class:"material-icons me-2"}," auto_awesome ",-1),os={key:0},rs={class:"mb-3 fw-bold d-flex align-items-center"},is=["src"],ls={key:1,class:"bi bi-person-circle me-3 fs-45"},cs={class:"d-flex"},ns={class:"row gy-5"},as=["src"],ms={key:1,class:"bi bi-person-circle me-3 fs-45 lh-1 mb-auto"},ds={class:"mb-0 fs-6"},us={class:"mb-2"};function ps(o,r,h,k,s,b){const g=N("RouterLink"),I=N("swiper-slide"),M=N("swiper");return i(),c("div",K,[e("section",Q,[e("nav",W,[e("ol",X,[e("li",Z,[y(g,{to:"/recipes",class:"link-primary"},{default:d(()=>[n("甜點食譜")]),_:1})]),e("li",$,l(s.recipe.title),1)])]),e("div",ee,[e("div",se,[e("img",{src:s.mainImg,style:{height:"300px"},class:"w-100 object-fit-cover mb-4",alt:s.recipe.title},null,8,te),e("div",oe,[y(M,{"slides-per-view":3,"space-between":15,modules:s.modules,navigation:"",style:{height:"160px"}},{default:d(()=>[y(I,null,{default:d(()=>[e("img",{src:s.recipe.image,alt:"食譜主圖片",class:p(["cursor-pointer object-fit-cover w-100",{border:s.mainImg===s.recipe.image,"border-3":s.mainImg===s.recipe.image,"border-primary":s.mainImg===s.recipe.image}]),style:{height:"100px"},onClick:r[0]||(r[0]=()=>s.mainImg=s.recipe.image)},null,10,re)]),_:1}),(i(!0),c(_,null,f(s.recipe.imgsUrl,(t,T)=>(i(),x(I,{key:t},{default:d(()=>[e("img",{src:t,alt:`食譜副圖片${T+1}`,class:p(["cursor-pointer object-fit-cover w-100",{border:s.mainImg===t,"border-3":s.mainImg===t,"border-primary":s.mainImg===t}]),style:{height:"100px"},onClick:()=>s.mainImg=t},null,10,ie)]),_:2},1024))),128))]),_:1},8,["modules"])])]),e("div",le,[e("div",ce,[e("span",ne,l(s.recipe.category),1),e("h2",ae,l(s.recipe.title),1),e("div",me,[o.recipeBookmark?o.recipeBookmark?(i(),c("button",{key:1,type:"button",class:"border-0 bg-transparent fs-4 text-tomato p-0 mt-1",onClick:r[2]||(r[2]=()=>o.deleteBookmark("recipeBookmarks",s.recipe.id))},he)):u("",!0):(i(),c("button",{key:0,type:"button",class:"border-0 bg-transparent text-tomato fs-4 p-0 mt-1",onClick:r[1]||(r[1]=()=>o.addBookmark("recipeBookmarks",s.recipe))},ue)),s.myThumb?s.myThumb?(i(),c("button",{key:3,type:"button",class:p(["badge border border-primary rounded-pill fs-6 ms-4 btn-like",{"text-primary":s.allThumbNum,"text-gray":!s.allThumbNum}]),onClick:r[4]||(r[4]=(...t)=>b.deleteThumb&&b.deleteThumb(...t))},[e("span",{class:p(["mb-0 me-1",{"text-primary":s.allThumbNum,"text-gray":!s.allThumbNum}])},l(s.allThumbNum),3),ge],2)):u("",!0):(i(),c("button",{key:2,type:"button",class:p(["badge border border-primary rounded-pill fs-6 ms-4 btn-like",{"text-primary":s.allThumbNum,"text-gray":!s.allThumbNum}]),onClick:r[3]||(r[3]=(...t)=>b.addThumb&&b.addThumb(...t))},[e("span",{class:p(["mb-0 me-1",{"text-primary":s.allThumbNum,"text-gray":!s.allThumbNum}])},l(s.allThumbNum),3),be],2))])]),e("table",_e,[e("thead",null,[e("tr",null,[fe,e("th",ye,l(s.recipe.author),1)])]),e("tbody",null,[e("tr",null,[ke,e("td",null,l(s.recipe.content),1)]),e("tr",null,[we,e("td",ve,l(s.recipe.description),1)])])])])])]),e("section",xe,[e("div",Te,[e("div",Ce,[e("div",Ne,[Ie,e("table",Pe,[Be,e("tbody",null,[(i(!0),c(_,null,f(s.recipe.ingredients,(t,T)=>(i(),c("tr",{key:t+367657},[e("th",Me,l(T+1),1),e("td",null,l(t.name),1),e("td",null,l(t.num)+" "+l(t.unit),1)]))),128))])]),Se,e("div",je,[e("div",Ae,[y(g,{to:`/products/${s.groupProduct.id}`,class:"card-img-hover position-relative mb-3"},{default:d(()=>[e("img",{src:s.groupProduct.imgUrl,class:"object-fit-cover card-img",alt:s.groupProduct.title},null,8,Re),Ve]),_:1},8,["to"]),y(g,{to:`/products/${s.groupProduct.id}`,class:"text-center"},{default:d(()=>[e("h5",Le,l(s.groupProduct.title),1)]),_:1},8,["to"])])]),e("div",Ue,[e("div",De,[e("del",qe,"NT$ "+l(o.numberComma(s.groupProduct.originalPrice)),1),e("span",Ee,[n("NT$ "+l(o.numberComma(s.groupProduct.price))+" ",1),Fe])]),e("div",ze,[B(e("select",{name:"",id:"",class:"form-select text-center","onUpdate:modelValue":r[5]||(r[5]=t=>s.qty=t),style:{width:"70px"}},[(i(),c(_,null,f(30,t=>e("option",{value:t,key:t+4596945},l(t),9,Ge)),64))],512),[[L,s.qty]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:r[6]||(r[6]=()=>o.addCart(s.groupProduct,s.qty))},"一鍵買齊")])]),e("div",Je,[(i(!0),c(_,null,f(s.recipe.relativeProducts,t=>(i(),c("div",{class:"col",key:t.id+456496},[e("div",Oe,[t.category==="單一產品"?(i(),x(g,{key:0,to:`/products/${t.id}`,class:"card-img-hover position-relative mb-2"},{default:d(()=>[e("img",{src:t.imgUrl,alt:t.title,class:"object-fit-cover card-img",style:{height:"150px !important"}},null,8,Ye),He]),_:2},1032,["to"])):u("",!0),t.category==="單一產品"?(i(),x(g,{key:1,to:`/products/${t.id}`,class:"text-center"},{default:d(()=>[e("h5",Ke,l(t.title),1)]),_:2},1032,["to"])):u("",!0)])]))),128))])]),e("div",Qe,[We,s.recipe.instructions?(i(),c("div",Xe,[(i(!0),c(_,null,f(s.recipe.instructions.split("/"),t=>(i(),c("p",{class:"me-3 mb-4",key:t+346346},l(t),1))),128))])):u("",!0),Ze,e("iframe",{src:s.recipe.video,class:"w-100",style:{height:"350px"},title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:""},null,8,$e)])])])]),e("section",es,[e("h3",ss,[ts,n(" 顧客評價 "),e("div",{class:p(["ms-3 badge border rounded-pill fs-6",{"text-primary":s.recipeComments.length,"text-gray":!s.recipeComments.length,"border-primary":s.recipeComments.length,"border-gray":!s.recipeComments.length,"bg-secondary":s.recipeComments.length,"bg-whiteGray":!s.recipeComments.length}])},l(s.recipeComments.length)+" 則 ",3),o.uid?u("",!0):(i(),x(g,{key:0,to:"/loginSignup",class:"ms-auto mb-1 btn btn-outline-gradient rounded-pill"},{default:d(()=>[n("我要登入寫評價")]),_:1}))]),o.uid?(i(),c("form",os,[e("h5",rs,[o.user.headshotImg?(i(),c("img",{key:0,src:o.user.headshotImg,alt:"大頭貼",width:"50",height:"50",class:"object-fit-cover rounded-circle me-3"},null,8,is)):o.user.headshotImg?u("",!0):(i(),c("i",ls)),n(" "+l(o.user.nickName),1)]),B(e("textarea",{class:"form-control",name:"",id:"",cols:"30",rows:"10","onUpdate:modelValue":r[7]||(r[7]=t=>s.recipeMessage=t)},null,512),[[U,s.recipeMessage]]),e("div",cs,[e("button",{type:"submit",class:"ms-auto btn btn-primary mt-3",onClick:r[8]||(r[8]=D((...t)=>b.addComments&&b.addComments(...t),["prevent"]))},"送出")])])):u("",!0),e("div",ns,[(i(!0),c(_,null,f(s.recipeComments,t=>(i(),c("div",{class:"col-12 border-bottom d-flex align-items-center mb-2",key:t+3657},[t.userImg?(i(),c("img",{key:0,src:t.userImg,alt:"大頭貼",width:"50",height:"50",class:"rounded-circle me-3 object-fit-cover mb-auto"},null,8,as)):t.userImg?u("",!0):(i(),c("i",ms)),e("div",null,[e("h5",ds,l(t.username),1),e("p",null,l(new Date(t.createAt).toLocaleString().split(":")[0])+":"+l(new Date(t.createAt).toLocaleString().split(":")[1]),1),e("p",us,l(t.message),1)])]))),128))])])])}const vs=Y(H,[["render",ps]]);export{vs as default};
