import{R as B}from"./vue-router-46224dd8.js";import{m as N,a as V}from"./index-6af516ba.js";import{c as O}from"./carts-32b42ff3.js";import{n as E}from"./numberCommaMixin-e0aac39c.js";import{P as q}from"./PaginationComponent-828e246b.js";import{C as S}from"./collapse-6026b968.js";import{r as m,b as v,o as D,d as f,s as T,c as U,a as F}from"./db-143b9a4b.js";import{L as G}from"./index-fde5e204.js";import{w as _,v as H,d as j,m as y}from"./runtime-dom.esm-bundler-e140de91.js";import{_ as A}from"./loadingLogo-ea15f612.js";import{_ as I,a as Y}from"./fruit3-355a36ca.js";import{_ as K,a as z}from"./discount3-e2e49eb3.js";import{_ as W}from"./image5-4fc2427e.js";import{_ as J}from"./image4-1806383b.js";import{_ as Q}from"./icon-cart-796adfb7.js";import{_ as X}from"./undraw_Page_not_found_re_e9o6-993b7155.js";import{_ as Z,a7 as a,F as w,a9 as P,a8 as t,af as d,ab as g,aa as c,ad as p,ac as b,N as C,ae as L,r as x,o as l}from"./_plugin-vue_export-helper-d28549df.js";import"./_commonjsHelpers-042e6b4d.js";import"./base-component-5a126788.js";const $="/finalEasyBuyEasyMake/assets/food1-d3cd1b3d.png",tt="/finalEasyBuyEasyMake/assets/food3-12ca3601.png",et="/finalEasyBuyEasyMake/assets/strawberry1-dc036a97.png",st="/finalEasyBuyEasyMake/assets/strawberry3-301f90ac.png",ot={components:{RouterLink:B,PaginationComponent:q,Loading:G},data(){return{priceOrRateCollapse:{},highOrLowCollapse:{},user:{},uid:"",products:[],priceOrRate:"價格",highOrLow:"不拘",productSearchName:"",filterProducts:[],bookMarks:[],pageStatus:"全部",selectPage:"全部",search:!1,isLoading:!1,fullPage:!0}},mixins:[E],methods:{...N(O,["addCart","toastMessage"]),getProducts(){const r=m(f,"products/");v(r,o=>{this.products=o.val(),this.products=Object.entries(this.products).map(h=>(h[1].id=h[0],h[1]));const k=m(f,"productRates/");v(k,h=>{let e=h.val();e=Object.values(e).map((n,i)=>(n.id=Object.keys(e)[i],n)),this.products.forEach((n,i)=>{e.forEach(u=>{n.id===u.productId&&!this.products[i].scores?(this.products[i].scores=u.score,this.products[i].ratePeople=1,this.products[i].averageRate=Number((this.products[i].scores/this.products[i].ratePeople).toFixed(1))):n.id===u.productId&&this.products[i].scores&&(this.products[i].scores+=u.score,this.products[i].ratePeople+=1,this.products[i].averageRate=Number((this.products[i].scores/this.products[i].ratePeople).toFixed(1)))})}),this.products.forEach((n,i)=>{n.averageRate||(this.products[i].scores=0,this.products[i].ratePeople=0,this.products[i].averageRate=0)}),this.filterProducts=this.products,this.isLoading=!1,!this.$route.query.pageStatus&&this.$route.fullPath==="/products"?this.$refs.pagination.renderPage(1,this.filterProducts):this.$route.query.pageStatus&&this.searchProducts()})})},searchProducts(){this.pageStatus==="全部"?this.filterProducts=this.products:this.pageStatus==="食材組合包"?this.filterProducts=this.products.filter(r=>r.category==="組合包"):this.pageStatus==="熱銷單品"?this.filterProducts=this.products.filter(r=>r.category==="單一產品"):this.pageStatus==="特價商品"&&(this.filterProducts=this.products.filter(r=>r.isCheaper===!0)),this.priceOrRate==="價格"&&this.highOrLow!=="不拘"?this.highOrLow==="低到高"?this.filterProducts=this.filterProducts.sort((r,o)=>r.price-o.price):this.highOrLow==="高到低"&&(this.filterProducts=this.filterProducts.sort((r,o)=>o.price-r.price)):this.priceOrRate==="評價"&&this.highOrLow!=="不拘"&&(this.highOrLow==="低到高"?this.filterProducts=this.filterProducts.sort((r,o)=>r.averageRate!==o.averageRate?r.averageRate-o.averageRate:r.scores-o.scores):this.highOrLow==="高到低"&&(this.filterProducts=this.filterProducts.sort((r,o)=>r.averageRate!==o.averageRate?o.averageRate-r.averageRate:o.scores-r.scores))),this.filterProducts=this.filterProducts.filter(r=>r.title.match(this.productSearchName)),this.search=!0,this.$refs.pagination.renderPage(1,this.filterProducts)},getBookmarks(){D(F,r=>{if(r){this.uid=r.uid;const o=m(f,"users/"+r.uid);v(o,k=>{this.user=k.val();const h=m(f,`productBookmarks/${this.uid}`);v(h,e=>{this.bookMarks=e.val(),this.bookMarks&&(this.bookMarks=Object.keys(this.bookMarks))})})}else this.uid=null,this.user={}})},addBookmark(r){if(!this.uid){this.toastMessage("登入才可使用收藏功能","error");return}const o=m(f,`productBookmarks/${this.uid}/${r.id}`);T(o,r),this.toastMessage("收藏成功")},deleteBookmark(r){U(m(f,`productBookmarks/${this.uid}/${r}`)),this.toastMessage("刪除收藏")}},mounted(){this.isLoading=!0,this.priceOrRateCollapse=new S(this.$refs.priceOrRateCollapse,{toggle:!1,parent:"#myGroup"}),this.highOrLowCollapse=new S(this.$refs.highOrLowCollapse,{toggle:!1,parent:"#myGroup"}),(this.$route.query.pageStatus||this.$route.query.searchName||this.$route.query.valueHighOrLow||this.$route.query.valuePriceOrRate)&&(this.pageStatus=this.$route.query.pageStatus,this.priceOrRate=this.$route.query.valuePriceOrRate,this.highOrLow=this.$route.query.valueHighOrLow,this.productSearchName=this.$route.query.searchName),this.getProducts(),this.getBookmarks()},watch:{selectPage(){this.pageStatus=this.selectPage,this.productSearchName="",this.pageStatus==="全部"?this.filterProducts=this.products:this.pageStatus==="食材組合包"?this.filterProducts=this.products.filter(r=>r.category==="組合包"):this.pageStatus==="熱銷單品"?this.filterProducts=this.products.filter(r=>r.category==="單一產品"):this.pageStatus==="特價商品"&&(this.filterProducts=this.products.filter(r=>r.isCheaper===!0)),this.$refs.pagination.renderPage(1,this.filterProducts)},priceOrRate(){this.priceOrRateCollapse.hide()},highOrLow(){this.highOrLowCollapse.hide()},filterProducts(){this.priceOrRateCollapse.hide(),this.highOrLowCollapse.hide()}},computed:{...V(O,["loadingItem"])}},rt={"data-aos":"fade-up"},it=t("div",{class:"d-flex flex-column align-items-center py-96"},[t("img",{src:A,class:"loadingLogo mb-3",style:{width:"150px"},alt:""}),t("p",{class:"text-center fw-bold text-primary h2"},[t("span",{class:"me-1 animate-text"},"L"),t("span",{class:"mx-1 animate-text"},"o"),t("span",{class:"mx-1 animate-text"},"a"),t("span",{class:"mx-1 animate-text"},"d"),t("span",{class:"mx-1 animate-text"},"i"),t("span",{class:"mx-1 animate-text"},"n"),t("span",{class:"mx-1 animate-text"},"g"),t("span",{class:"mx-2 animate-text"},"."),t("span",{class:"me-2 animate-text"},"."),t("span",{class:"animate-text"},".")])],-1),at=t("section",{class:"text-center"},[t("div",{class:"py-lg-200 py-96 bg-img-fixed",style:{"background-image":"url('https://images.unsplash.com/photo-1678465952860-422bf820209b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80')"}}),t("h2",{class:"text-purple mb-0 fs-lg-1 fs-5 letter-spacing-20 fw-bold bg-secondary-lightPurple py-2"},"材料種類")],-1),lt={class:"container"},nt={class:"pt-lg-4 pt-3 position-relative"},ct={class:"category-selector row row-cols-4 list-unstyled border-bottom"},dt={key:0,class:"product-img1 d-block mx-auto",src:I,alt:"所有材料灰色圖示"},pt={key:1,class:"d-block mx-auto",src:Y,alt:"所有材料藍色圖示"},ht=t("span",{class:"fs-12 fs-md-5 d-block py-2"},[c("所有"),t("br",{class:"d-lg-none"}),c("材料")],-1),ut={key:0,class:"product-img2 d-block mx-auto",src:$,alt:""},gt={key:1,class:"d-block mx-auto",src:tt,alt:""},mt=t("span",{class:"fs-12 fs-md-5 d-block py-2"},[c("食材"),t("br",{class:"d-lg-none"}),c("組合包")],-1),ft={key:0,class:"product-img3 d-block mx-auto",src:et,alt:""},bt={key:1,class:"d-block mx-auto",src:st,alt:""},_t=t("span",{class:"fs-12 fs-md-5 d-block py-2"},[c("熱銷"),t("br",{class:"d-lg-none"}),c("單品")],-1),yt={key:0,class:"product-img4 d-block mx-auto",src:K,alt:""},kt={key:1,class:"d-block mx-auto",src:z,alt:""},vt=t("span",{class:"fs-12 fs-md-5 d-block py-2"},[c("特價"),t("br",{class:"d-lg-none"}),c("商品")],-1),wt={class:"d-none d-lg-block my-5"},Pt={class:"input-group"},xt=t("i",{class:"bi bi-caret-down-fill"},null,-1),Rt={class:"ms-2 fw-bold"},Ot=t("i",{class:"bi bi-caret-down-fill"},null,-1),St={class:"ms-2 fw-bold"},Ct=t("span",{class:"material-icons-outlined text-primary"},"search",-1),Lt=[Ct],Mt={class:"row g-0",id:"myGroup"},Bt={class:"col-2"},Nt={ref:"priceOrRateCollapse",class:"collapse"},Vt={class:"card card-body border-0",style:{border:"0px !important"}},Et={class:"btn-group-vertical",role:"group","aria-label":"Vertical radio toggle button group"},qt=t("label",{class:"btn btn-outline-primary",for:"selectprice"},"價格",-1),Dt=t("label",{class:"btn btn-outline-primary",for:"selectRate"},"評價",-1),Tt={class:"col-2"},Ut={ref:"highOrLowCollapse",class:"collapse"},Ft={class:"card card-body border-0",style:{border:"0px !important"}},Gt={class:"btn-group-vertical",role:"group","aria-label":"Vertical radio toggle button group"},Ht=t("label",{class:"btn btn-outline-primary",for:"noDifference"},"不拘",-1),jt=t("label",{class:"btn btn-outline-primary",for:"highToLow"},"高到低",-1),At=t("label",{class:"btn btn-outline-primary",for:"lowToHigh"},"低到高",-1),It={key:0,class:"row row-cols-xl-4 row-cols-lg-3 row-cols-2 gy-4"},Yt={class:"card position-relative"},Kt={class:"card-img-hover position-relative"},zt=["src","alt"],Wt=t("p",{class:"detail position-absolute top-50 start-50 translate-middle fw-bold letter-spacing-5 link-darkBrown fs-xl-5 text-center"},[c("查看"),t("br",{class:"d-xl-none d-lg-block"}),c("商品資訊")],-1),Jt={key:0,class:"fs-md-14 fs-12 text-white p-2 bg-primary position-absolute top-0 start-0"},Qt=["onClick"],Xt=t("img",{src:W,alt:"收藏按鈕-未收藏"},null,-1),Zt=[Xt],$t=["onClick"],te=t("img",{src:J,alt:"收藏按鈕-已收藏"},null,-1),ee=[te],se=["disabled","onClick"],oe=t("img",{src:Q,alt:"購物車按鈕",class:"shadow-sm"},null,-1),re=[oe],ie={class:"fs-md-5 fs-6 fw-bold"},ae={class:"d-flex align-items-lg-center fs-md-6 fs-12"},le=t("i",{class:"bi bi-star-fill"},null,-1),ne={class:"text-end mt-1 d-md-none fs-12"},ce=t("i",{class:"bi bi-star-fill"},null,-1),de={key:1,class:"py-lg-4 text-center"},pe=t("img",{src:X,class:"mb-lg-3 mb-2 img-md-200-sm-150",alt:"查無資訊"},null,-1),he=t("p",{class:"fs-lg-3 fs-6"},"查無商品，請您重新查詢",-1),ue=[pe,he];function ge(r,o,k,h,e,n){const i=x("loading"),u=x("RouterLink"),M=x("PaginationComponent");return l(),a("div",rt,[w(i,{active:e.isLoading,"onUpdate:active":o[0]||(o[0]=s=>e.isLoading=s),"can-cancel":!1,"is-full-page":e.fullPage,"lock-scroll":!0},{default:P(()=>[it]),_:1},8,["active","is-full-page"]),at,t("section",lt,[t("div",nt,[t("ul",ct,[t("li",{class:d(["col text-center",{"pointer-events-none":e.pageStatus==="全部"}])},[t("a",{href:"#",onClick:o[1]||(o[1]=_(()=>e.selectPage="全部",["prevent"])),class:d(["text-decoration-none d-inline-block",{"fw-bold":e.pageStatus==="全部","link-primary":e.pageStatus==="全部"}])},[e.pageStatus!=="全部"?(l(),a("img",dt)):e.pageStatus==="全部"?(l(),a("img",pt)):g("",!0),ht],2)],2),t("li",{class:d(["col text-center",{"pointer-events-none":e.pageStatus==="食材組合包"}])},[t("a",{href:"#",onClick:o[2]||(o[2]=_(()=>e.selectPage="食材組合包",["prevent"])),class:d(["text-decoration-none d-inline-block",{"fw-bold":e.pageStatus==="食材組合包","link-primary":e.pageStatus==="食材組合包"}])},[e.pageStatus!=="食材組合包"?(l(),a("img",ut)):e.pageStatus==="食材組合包"?(l(),a("img",gt)):g("",!0),mt],2)],2),t("li",{class:d(["col text-center",{"pointer-events-none":e.pageStatus==="熱銷單品"}])},[t("a",{href:"#",onClick:o[3]||(o[3]=_(()=>e.selectPage="熱銷單品",["prevent"])),class:d(["text-decoration-none d-inline-block",{"fw-bold":e.pageStatus==="熱銷單品","link-primary":e.pageStatus==="熱銷單品"}])},[e.pageStatus!=="熱銷單品"?(l(),a("img",ft)):e.pageStatus==="熱銷單品"?(l(),a("img",bt)):g("",!0),_t],2)],2),t("li",{class:d(["col text-center",{"pointer-events-none":e.pageStatus==="特價商品"}])},[t("a",{href:"#",onClick:o[4]||(o[4]=_(()=>e.selectPage="特價商品",["prevent"])),class:d(["text-decoration-none d-inline-block",{"fw-bold":e.pageStatus==="特價商品","link-primary":e.pageStatus==="特價商品"}])},[e.pageStatus!=="特價商品"?(l(),a("img",yt)):e.pageStatus==="特價商品"?(l(),a("img",kt)):g("",!0),vt],2)],2)]),t("div",{class:d(["blue-line bg-primary position-absolute",{"active-all-ingredient":e.pageStatus==="全部","active-package":e.pageStatus==="食材組合包","active-hot":e.pageStatus==="熱銷單品","active-sale":e.pageStatus==="特價商品"}])},null,2)]),t("div",wt,[t("div",Pt,[t("a",{class:"btn btn-outline-primary px-5",onClick:o[5]||(o[5]=()=>this.priceOrRateCollapse.toggle())},[c("篩選對象 "),xt,t("span",Rt,p(e.priceOrRate),1)]),t("button",{class:"btn btn-outline-primary px-5",type:"button",onClick:o[6]||(o[6]=()=>this.highOrLowCollapse.toggle())},[c("篩選值 "),Ot,t("span",St,p(e.highOrLow),1)]),b(t("input",{type:"search",class:"form-control border-primary border-end-0",placeholder:"請輸入食材名稱","aria-label":"Example text with two button addons","onUpdate:modelValue":o[7]||(o[7]=s=>e.productSearchName=s),onKeyup:o[8]||(o[8]=j((...s)=>n.searchProducts&&n.searchProducts(...s),["enter"]))},null,544),[[H,e.productSearchName]]),t("button",{type:"submit",class:"btn border border-primary border-start-0 bg-transparent d-flex",onClick:o[9]||(o[9]=_((...s)=>n.searchProducts&&n.searchProducts(...s),["prevent"]))},Lt)]),t("div",Mt,[t("div",Bt,[t("div",Nt,[t("div",Vt,[t("div",Et,[b(t("input",{type:"radio",class:"btn-check",value:"價格",name:"priceOrRate",id:"selectprice",autocomplete:"off","onUpdate:modelValue":o[10]||(o[10]=s=>e.priceOrRate=s)},null,512),[[y,e.priceOrRate]]),qt,b(t("input",{type:"radio",class:"btn-check",value:"評價",name:"priceOrRate",id:"selectRate",autocomplete:"off","onUpdate:modelValue":o[11]||(o[11]=s=>e.priceOrRate=s)},null,512),[[y,e.priceOrRate]]),Dt])])],512)]),t("div",Tt,[t("div",Ut,[t("div",Ft,[t("div",Gt,[b(t("input",{type:"radio",class:"btn-check",value:"不拘",name:"highOrLow",id:"noDifference",autocomplete:"off",checked:"","onUpdate:modelValue":o[12]||(o[12]=s=>e.highOrLow=s)},null,512),[[y,e.highOrLow]]),Ht,b(t("input",{type:"radio",class:"btn-check",value:"高到低",name:"highOrLow",id:"highToLow",autocomplete:"off","onUpdate:modelValue":o[13]||(o[13]=s=>e.highOrLow=s)},null,512),[[y,e.highOrLow]]),jt,b(t("input",{type:"radio",class:"btn-check",value:"低到高",name:"highOrLow",id:"lowToHigh",autocomplete:"off","onUpdate:modelValue":o[14]||(o[14]=s=>e.highOrLow=s)},null,512),[[y,e.highOrLow]]),At])])],512)])])]),e.filterProducts.length&&!e.isLoading?(l(),a("div",It,[(l(!0),a(C,null,L(this.$refs.pagination.pageProducts,s=>(l(),a("div",{class:"col",key:s.id},[t("div",Yt,[t("div",Kt,[w(u,{to:`/products/${s.id}`},{default:P(()=>[t("img",{src:s.imgUrl,class:"object-fit-cover card-img",alt:s.title},null,8,zt),Wt,s.isCheaper?(l(),a("span",Jt,p((100-((s.originalPrice-s.price)/s.originalPrice*100).toFixed(0))%10===0?(100-((s.originalPrice-s.price)/s.originalPrice*100).toFixed(0)).toString().charAt(0):100-((s.originalPrice-s.price)/s.originalPrice*100).toFixed(0))+" 折 ",1)):g("",!0)]),_:2},1032,["to"]),t("button",{type:"button",class:"position-absolute btn-bookmark border-0 bg-transparent top-0 end-0 m-2 m-md-3",onClick:()=>n.addBookmark(s)},Zt,8,Qt),(l(!0),a(C,null,L(e.bookMarks,R=>(l(),a("div",{key:R},[R===s.id?(l(),a("button",{key:0,type:"button",class:"position-absolute btn-bookmark-delete border-0 bg-transparent top-0 end-0 m-2 m-md-3",onClick:()=>n.deleteBookmark(s.id)},ee,8,$t)):g("",!0)]))),128)),t("button",{disabled:r.loadingItem==="loading",onClick:()=>r.addCart(s),type:"button",class:"btn-buy border-0 bg-transparent m-2 m-md-3 p-0 position-absolute end-0 bottom-0"},re,8,se)]),w(u,{to:`/products/${s.id}`,class:"card-body px-0 text-decoration-none link-darkBrown"},{default:P(()=>[t("h3",ie,p(s.title),1),t("div",ae,[t("del",{class:d(["me-2 text-muted",{"d-none":!s.isCheaper}])},"NT$ "+p(r.numberComma(s.originalPrice)),3),t("span",{class:d(["me-1",{"text-danger":s.isCheaper,"fw-bold":s.isCheaper}])},"NT$ "+p(r.numberComma(s.price)),3),t("span",null," / "+p(s.num)+p(s.unit),1),t("span",{class:d(["badge rounded-pill ms-auto border d-none d-md-block",{"text-yellow":s.averageRate,"border-yellow":s.averageRate,"bg-lightYellow":s.averageRate,"bg-whiteGray":!s.averageRate,"text-gray":!s.averageRate,"border-gray":!s.averageRate}])},[c(p(s.averageRate)+" ",1),le],2)]),t("div",ne,[t("span",{class:d(["badge rounded-pill ms-auto border d-md-none",{"text-yellow":s.averageRate,"border-yellow":s.averageRate,"bg-lightYellow":s.averageRate,"bg-whiteGray":!s.averageRate,"text-gray":!s.averageRate,"border-gray":!s.averageRate}])},[c(p(s.averageRate)+" ",1),ce],2)])]),_:2},1032,["to"])])]))),128))])):!e.filterProducts.length&&e.search&&!e.isLoading?(l(),a("div",de,ue)):g("",!0),w(M,{ref:"pagination","price-or-rate":e.priceOrRate,"filter-products":e.filterProducts,class:"mb-5"},null,8,["price-or-rate","filter-products"])])])}const Ee=Z(ot,[["render",ge]]);export{Ee as default};
