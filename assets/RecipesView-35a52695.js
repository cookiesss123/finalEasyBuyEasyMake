import{R as T}from"./vue-router-2c21c692.js";import{m as N}from"./index-966010aa.js";import{c as S}from"./carts-f2393f2b.js";import{n as U}from"./numberCommaMixin-e0aac39c.js";import{P as q}from"./PaginationComponent-c75be064.js";import{C as w,_ as G}from"./icon-searchMobile-657ef2e6.js";import{r as m,b as y,o as Y,d as p,s as D,c as H,a as A}from"./db-143b9a4b.js";import{L as K}from"./LoadingComponent-8a5de011.js";import{v as z,d as F,w as W,e as u}from"./runtime-dom.esm-bundler-54ced388.js";import{_ as X}from"./image5-4fc2427e.js";import{_ as Z}from"./image4-1806383b.js";import{_ as J}from"./undraw_Page_not_found_re_e9o6-de2ef5f7.js";import{_ as Q,U as c,V as e,a4 as r,Z as n,Y as _,a0 as h,$ as g,a1 as R,a2 as x,c as $,W as k,r as C,o as l,X as I}from"./_plugin-vue_export-helper-03b40388.js";import"./_commonjsHelpers-042e6b4d.js";import"./base-component-5a126788.js";import"./loadingLogo-3bb466c0.js";const O="/finalEasyBuyEasyMake/assets/gettyimages-1268940871-a28aa7f6.jpg",L="/finalEasyBuyEasyMake/assets/IMGP0051-8dc73349.jpg",B="/finalEasyBuyEasyMake/assets/popularimage4-5263c958.png",j="/finalEasyBuyEasyMake/assets/photo-1533910534207-90f31029a78e-65885375.jpg",M="/finalEasyBuyEasyMake/assets/421Cv1xH8BYP44T9V8aY241R2UYjhTsiYa7giw6d-bba1ddf7.jpeg",E="/finalEasyBuyEasyMake/assets/pastiera2-415825e7.jpg";const ee={components:{RouterLink:T,PaginationComponent:q,LoadingComponent:K},mixins:[U],data(){return{loading:!0,costOrRateCollapse:{},highOrLowCollapse:{},recipes:[],selectCategory:"全部",selectItem:"全部",priceOrRate:"成本",highOrLow:"不拘",recipeSearchName:"",filterRecipes:[],bookMarks:[],thumbs:{},uid:"",search:!1}},methods:{...N(S,["toastMessage"]),getRecipes(){const i=m(p,"recipes/");y(i,s=>{this.recipes=s.val(),this.recipes=Object.entries(this.recipes).map(d=>(d[1].id=d[0],d[1])),console.log(this.recipes,"食譜資料");const b=m(p,"recipeThumbs/");y(b,d=>{this.thumbs=d.val(),console.log(this.thumbs,"所有讚"),this.recipes.forEach((t,a)=>{Object.keys(this.thumbs).forEach(f=>{t.id===f&&(this.recipes[a].thumbs=this.thumbs[t.id].thumbs)})}),this.recipes.forEach((t,a)=>{t.thumbs||(this.recipes[a].thumbs=0)}),console.log(this.recipes,"食譜"),this.filterRecipes=this.recipes,this.loading=!1,!this.$route.query.category&&this.$route.fullPath==="/recipes"?this.$refs.pagination.renderPage(1,this.filterRecipes):this.$route.query.category&&this.searchRecipes()})})},searchRecipes(){this.selectItem==="全部"?this.filterRecipes=this.recipes:this.selectItem!=="全部"&&(this.filterRecipes=this.recipes.filter(i=>i.category===this.selectItem)),this.priceOrRate==="成本"&&this.highOrLow!=="不拘"?this.highOrLow==="低到高"?this.filterRecipes=this.filterRecipes.sort((i,s)=>i.price-s.price):this.highOrLow==="高到低"&&(this.filterRecipes=this.filterRecipes.sort((i,s)=>s.price-i.price)):this.priceOrRate==="評價"&&this.highOrLow!=="不拘"&&(this.highOrLow==="低到高"?this.filterRecipes=this.filterRecipes.sort((i,s)=>i.thumbs-s.thumbs):this.highOrLow==="高到低"&&(this.filterRecipes=this.filterRecipes.sort((i,s)=>s.thumbs-i.thumbs))),this.filterRecipes=this.filterRecipes.filter(i=>i.title.match(this.recipeSearchName)),this.search=!0,this.$refs.pagination.renderPage(1,this.filterRecipes)},getBookmarks(){Y(A,i=>{if(i){this.uid=i.uid,console.log(this.uid,"使用者已登入取得 uid");const s=m(p,"users/"+i.uid);y(s,b=>{this.user=b.val(),console.log(this.user,"讀取的資料");const d=m(p,`recipeBookmarks/${this.uid}`);y(d,t=>{this.bookMarks=t.val(),this.bookMarks&&(this.bookMarks=Object.keys(this.bookMarks)),console.log(this.bookMarks,"書籤")})})}else console.log("並未登入"),this.uid=null,this.user={}})},addBookmark(i){if(!this.uid){this.toastMessage("登入才可使用收藏功能","error");return}const s=m(p,`recipeBookmarks/${this.uid}/${i.id}`);D(s,i),this.toastMessage("收藏成功")},deleteBookmark(i){H(m(p,`recipeBookmarks/${this.uid}/${i}`)),this.toastMessage("刪除收藏")}},mounted(){this.loading=!0,this.costOrRateCollapse=new w(this.$refs.costOrRateCollapse,{toggle:!1,parent:"#myGroup"}),this.highOrLowCollapse=new w(this.$refs.highOrLowCollapse,{toggle:!1,parent:"#myGroup"}),this.$route.query.category&&(this.selectItem=this.$route.query.category,this.highOrLow=this.$route.query.valueHighOrLow,this.priceOrRate=this.$route.query.valuePriceOrRate,this.recipeSearchName=this.$route.query.searchName),this.getBookmarks(),this.getRecipes()},watch:{selectCategory(){this.recipeSearchName="",this.selectCategory==="全部"?(this.selectItem="全部",this.filterRecipes=this.recipes,this.$refs.pagination.renderPage(1,this.filterRecipes)):this.selectCategory!=="全部"&&(this.selectItem=this.selectCategory,this.filterRecipes=this.recipes.filter(i=>i.category===this.selectItem),console.log(this.filterRecipes,"篩選結果")),this.$refs.pagination.renderPage(1,this.filterRecipes)},priceOrRate(){this.costOrRateCollapse.hide()},highOrLow(){this.highOrLowCollapse.hide()},filterRecipes(){this.costOrRateCollapse.hide(),this.highOrLowCollapse.hide()}}},te={class:"my-7"},se={class:"bg-lightYellow mb-4 py-4 px-lg-5",style:{"overflow-x":"hidden"}},oe={class:"container"},ie={class:"selectProductCategory row row-cols-lg-6 row-cols-3"},re={key:0,src:O,alt:"",class:"rounded-circle",style:{"object-fit":"cover"}},le={key:1,src:O,alt:"",class:"rounded-circle",style:{"object-fit":"cover",transform:"scale(1.2,1.2)"}},ce={key:0,src:L,alt:"",class:"rounded-circle",style:{"object-fit":"cover"}},ne={key:1,src:L,alt:"",class:"rounded-circle",style:{"object-fit":"cover",transform:"scale(1.2,1.2)"}},ae={key:0,src:B,alt:"",class:"rounded-circle",style:{"object-fit":"cover"}},de={key:1,src:B,alt:"",class:"rounded-circle",style:{"object-fit":"cover",transform:"scale(1.2,1.2)"}},he={key:0,src:j,alt:"",class:"rounded-circle",style:{"object-fit":"cover"}},me={key:1,src:j,alt:"",class:"rounded-circle",style:{"object-fit":"cover",transform:"scale(1.2,1.2)"}},pe={key:0,src:M,alt:"",class:"rounded-circle",style:{"object-fit":"cover"}},ge={key:1,src:M,alt:"",class:"rounded-circle",style:{"object-fit":"cover",transform:"scale(1.2,1.2)"}},ue={key:0,src:E,alt:"",class:"rounded-circle",style:{"object-fit":"cover"}},be={key:1,src:E,alt:"",class:"rounded-circle",style:{"object-fit":"cover",transform:"scale(1.2,1.2)"}},fe={class:"d-none d-lg-block container selectProduct my-5"},ye={class:"input-group"},_e=e("i",{class:"bi bi-caret-down-fill"},null,-1),ke={class:"ms-2 fw-bold"},Ce=e("i",{class:"bi bi-caret-down-fill"},null,-1),ve={class:"ms-2 fw-bold"},we=e("img",{src:G,style:{height:"25px"},alt:""},null,-1),Re=[we],xe={class:"row g-0",id:"myGroup"},Ie={class:"col-2"},Oe={ref:"costOrRateCollapse",class:"collapse"},Le={class:"card card-body border-0"},Be={class:"btn-group-vertical",role:"group","aria-label":"Vertical radio toggle button group"},je=e("label",{class:"btn btn-outline-red",for:"selectprice"},"成本",-1),Me=e("label",{class:"btn btn-outline-red",for:"selectRate"},"評價",-1),Ee={class:"col-2"},Ve={ref:"highOrLowCollapse",class:"collapse"},Pe={class:"card card-body border-0"},Te={class:"btn-group-vertical",role:"group","aria-label":"Vertical radio toggle button group"},Ne=e("label",{class:"btn btn-outline-red",for:"noDifference"},"不拘",-1),Se=e("label",{class:"btn btn-outline-red",for:"highToLow"},"高到低",-1),Ue=e("label",{class:"btn btn-outline-red",for:"lowToHigh"},"低到高",-1),qe={class:"container"},Ge={key:0,class:"row row-cols-lg-4 row-cols-2 gy-4"},Ye={class:"card position-relative border-0 bg-transparent",style:{"border-radius":"20px"}},De={class:"cardImg",style:{"border-radius":"20px"}},He=["src"],Ae={class:"card-text"},Ke=["onClick"],ze=e("img",{src:X},null,-1),Fe=[ze],We=["onClick"],Xe=e("img",{src:Z},null,-1),Ze=[Xe],Je={style:{"pointer-events":"none"},class:"cardTextCategory badge rounded-pill bg-red mt-4 border-0 m-3 position-absolute start-0"},Qe={class:"d-flex justify-content-between align-items-center fw-bold"},$e={class:"cardTextTitle"},et={class:"cardTextPrice d-flex align-items-lg-center align-items-end"},tt={class:""},st={class:"starRates mb-0 ms-auto"},ot={class:"me-1"},it=e("i",{class:"bi bi-hand-thumbs-up-fill"},null,-1),rt={key:2,class:"py-10"},lt=e("img",{src:J,class:"mb-3",alt:"",style:{height:"250px",display:"block",margin:"auto"}},null,-1),ct=e("h2",{class:"text-center"},"查無食譜，請您重新查詢",-1),nt=[lt,ct];function at(i,s,b,d,t,a){const f=C("RouterLink"),V=C("LoadingComponent"),P=C("PaginationComponent");return l(),c("div",te,[e("section",se,[e("div",oe,[e("div",ie,[e("button",{type:"button",class:r(["col d-flex flex-column align-items-center btn border-0",{selectedImg:t.selectCategory==="全部"}]),onClick:s[0]||(s[0]=()=>t.selectCategory="全部")},[e("div",{class:r(["cardImg mb-2",{"opacity-100":t.selectItem==="全部"}])},[e("div",{class:r(["enlargeImg rounded-circle",{selectImgBorder:t.selectItem==="全部"}])},[t.selectCategory!=="全部"?(l(),c("img",re)):t.selectCategory==="全部"?(l(),c("img",le)):n("",!0)],2)],2),e("span",{class:r(["text-secondary",{"text-red":t.selectItem==="全部","fw-bold":t.selectItem==="全部"}])},"全部",2)],2),e("button",{type:"button",class:r(["col d-flex flex-column align-items-center btn border-0",{selectedImg:t.selectCategory==="台式甜點"}]),onClick:s[1]||(s[1]=()=>t.selectCategory="台式甜點")},[e("div",{class:r(["cardImg mb-2",{"opacity-100":t.selectItem==="台式甜點"}])},[e("div",{class:r(["enlargeImg rounded-circle",{selectImgBorder:t.selectItem==="台式甜點"}])},[t.selectCategory!=="台式甜點"?(l(),c("img",ce)):t.selectCategory==="台式甜點"?(l(),c("img",ne)):n("",!0)],2)],2),e("span",{class:r(["text-secondary",{"text-red":t.selectItem==="台式甜點","fw-bold":t.selectItem==="台式甜點"}])},"台式甜點",2)],2),e("button",{type:"button",class:r(["col d-flex flex-column align-items-center btn border-0",{selectedImg:t.selectCategory==="法式甜點"}]),onClick:s[2]||(s[2]=()=>t.selectCategory="法式甜點")},[e("div",{class:r(["cardImg mb-2",{"opacity-100":t.selectItem==="法式甜點"}])},[e("div",{class:r(["enlargeImg rounded-circle",{selectImgBorder:t.selectItem==="法式甜點"}])},[t.selectCategory!=="法式甜點"?(l(),c("img",ae)):t.selectCategory==="法式甜點"?(l(),c("img",de)):n("",!0)],2)],2),e("span",{class:r(["text-secondary",{"text-red":t.selectItem==="法式甜點","fw-bold":t.selectItem==="法式甜點"}])},"法式甜點",2)],2),e("button",{type:"button",class:r(["col d-flex flex-column align-items-center btn border-0",{selectedImg:t.selectCategory==="美式甜點"}]),onClick:s[3]||(s[3]=()=>t.selectCategory="美式甜點")},[e("div",{class:r(["cardImg mb-2",{"opacity-100":t.selectItem==="美式甜點"}])},[e("div",{class:r(["enlargeImg rounded-circle",{selectImgBorder:t.selectItem==="美式甜點"}])},[t.selectCategory!=="美式甜點"?(l(),c("img",he)):t.selectCategory==="美式甜點"?(l(),c("img",me)):n("",!0)],2)],2),e("span",{class:r(["text-secondary",{"text-red":t.selectItem==="美式甜點","fw-bold":t.selectItem==="美式甜點"}])},"美式甜點",2)],2),e("button",{type:"button",class:r(["col d-flex flex-column align-items-center btn border-0",{selectedImg:t.selectCategory==="日式甜點"}]),onClick:s[4]||(s[4]=()=>t.selectCategory="日式甜點")},[e("div",{class:r(["cardImg mb-2",{"opacity-100":t.selectItem==="日式甜點"}])},[e("div",{class:r(["enlargeImg rounded-circle",{selectImgBorder:t.selectItem==="日式甜點"}])},[t.selectCategory!=="日式甜點"?(l(),c("img",pe)):t.selectCategory==="日式甜點"?(l(),c("img",ge)):n("",!0)],2)],2),e("span",{class:r(["text-secondary",{"text-red":t.selectItem==="日式甜點","fw-bold":t.selectItem==="日式甜點"}])},"日式甜點",2)],2),e("button",{type:"button",class:r(["col d-flex flex-column align-items-center btn border-0",{selectedImg:t.selectCategory==="義式甜點"}]),onClick:s[5]||(s[5]=()=>t.selectCategory="義式甜點")},[e("div",{class:r(["cardImg mb-2",{"opacity-100":t.selectItem==="義式甜點"}])},[e("div",{class:r(["enlargeImg rounded-circle",{selectImgBorder:t.selectItem==="義式甜點"}])},[t.selectCategory!=="義式甜點"?(l(),c("img",ue)):t.selectCategory==="義式甜點"?(l(),c("img",be)):n("",!0)],2)],2),e("span",{class:r(["text-secondary",{"text-red":t.selectItem==="義式甜點","fw-bold":t.selectItem==="義式甜點"}])},"義式甜點",2)],2)])])]),e("section",fe,[e("div",ye,[e("a",{class:"btn btn-outline-red px-5",onClick:s[6]||(s[6]=()=>this.costOrRateCollapse.toggle())},[_("篩選對象 "),_e,e("span",ke,h(t.priceOrRate),1)]),e("button",{class:"btn btn-outline-red px-5",type:"button",onClick:s[7]||(s[7]=()=>this.highOrLowCollapse.toggle())},[_("篩選值 "),Ce,e("span",ve,h(t.highOrLow),1)]),g(e("input",{type:"search",class:"form-control border-red border-end-0",placeholder:"請輸入食譜名稱","aria-label":"Example text with two button addons","onUpdate:modelValue":s[8]||(s[8]=o=>t.recipeSearchName=o),onKeyup:s[9]||(s[9]=F((...o)=>a.searchRecipes&&a.searchRecipes(...o),["enter"]))},null,544),[[z,t.recipeSearchName]]),e("button",{type:"submit",class:"btn border border-red border-start-0 bg-transparent",onClick:s[10]||(s[10]=W((...o)=>a.searchRecipes&&a.searchRecipes(...o),["prevent"]))},Re)]),e("div",xe,[e("div",Ie,[e("div",Oe,[e("div",Le,[e("div",Be,[g(e("input",{type:"radio",class:"btn-check",value:"成本",name:"priceOrRate",id:"selectprice",autocomplete:"off","onUpdate:modelValue":s[11]||(s[11]=o=>t.priceOrRate=o)},null,512),[[u,t.priceOrRate]]),je,g(e("input",{type:"radio",class:"btn-check",value:"評價",name:"priceOrRate",id:"selectRate",autocomplete:"off","onUpdate:modelValue":s[12]||(s[12]=o=>t.priceOrRate=o)},null,512),[[u,t.priceOrRate]]),Me])])],512)]),e("div",Ee,[e("div",Ve,[e("div",Pe,[e("div",Te,[g(e("input",{type:"radio",class:"btn-check",value:"不拘",name:"highOrLow",id:"noDifference",autocomplete:"off",checked:"","onUpdate:modelValue":s[13]||(s[13]=o=>t.highOrLow=o)},null,512),[[u,t.highOrLow]]),Ne,g(e("input",{type:"radio",class:"btn-check",value:"高到低",name:"highOrLow",id:"highToLow",autocomplete:"off","onUpdate:modelValue":s[14]||(s[14]=o=>t.highOrLow=o)},null,512),[[u,t.highOrLow]]),Se,g(e("input",{type:"radio",class:"btn-check",value:"低到高",name:"highOrLow",id:"lowToHigh",autocomplete:"off","onUpdate:modelValue":s[15]||(s[15]=o=>t.highOrLow=o)},null,512),[[u,t.highOrLow]]),Ue])])],512)])])]),e("section",qe,[t.filterRecipes.length?(l(),c("div",Ge,[(l(!0),c(R,null,x(this.$refs.pagination.pageProducts,o=>(l(),c("div",{class:"col text-decoration-none",key:o.id},[e("div",Ye,[e("div",De,[k(f,{to:`/recipes/${o.id}`,class:"enlargeImg"},{default:I(()=>[e("img",{src:o.image,class:"card-img",style:{"border-radius":"20px","object-fit":"cover","max-width":"100%","max-height":"100%"},alt:""},null,8,He)]),_:2},1032,["to"])]),e("h5",Ae,[e("button",{type:"button",class:"position-absolute bookmarkBtn border-0 bg-transparent end-0 top-0 m-lg-3 m-2",onClick:()=>a.addBookmark(o)},Fe,8,Ke),(l(!0),c(R,null,x(t.bookMarks,v=>(l(),c("div",{key:v+4567},[v===o.id?(l(),c("button",{key:0,type:"button",class:"position-absolute deleteBookmarkBtn border-0 bg-transparent end-0 top-0 m-lg-3 m-2",onClick:()=>a.deleteBookmark(o.id)},Ze,8,We)):n("",!0)]))),128)),e("span",Je,h(o.category),1)]),k(f,{to:`/recipes/${o.id}`,class:"card-footer bg-transparent border-0 text-decoration-none link-darkBrown"},{default:I(()=>[e("h5",Qe,[e("span",$e,h(o.title),1)]),e("div",et,[e("div",tt,[o.total?(l(),c("del",{key:0,class:r(["me-2 text-muted d-block d-lg-inline-block",{"d-none":o.price===o.total}])},"NT$ "+h(i.numberComma(o.total)),3)):n("",!0),e("span",null,[o.price?(l(),c("span",{key:0,class:r({"text-danger":o.price!==o.total,"fw-bold":o.price!==o.total})},"NT$ "+h(i.numberComma(o.price)),3)):n("",!0),_(" / "+h(o.content),1)])]),e("h5",st,[e("p",{class:r(["mb-0 badge rounded-pill border d-flex align-items-center",{"border-red":o.thumbs!==0,"border-lightBrownGray":o.thumbs===0,"text-red":o.thumbs!==0,"text-lightBrownGray":o.thumbs===0}])},[e("span",ot,h(o.thumbs),1),it],2)])])]),_:2},1032,["to"])])]))),128))])):n("",!0),t.loading?(l(),$(V,{key:1})):!t.filterRecipes.length&&t.search?(l(),c("div",rt,nt)):n("",!0),k(P,{ref:"pagination","price-or-rate":t.priceOrRate,"filter-recipes":t.filterRecipes},null,8,["price-or-rate","filter-recipes"])])])}const It=Q(ee,[["render",at]]);export{It as default};
