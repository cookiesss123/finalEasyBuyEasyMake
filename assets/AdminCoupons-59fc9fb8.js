import{m as y}from"./modalMixin-c1848f69.js";import{v as u,a as x}from"./runtime-dom.esm-bundler-bb3e8e23.js";import{_ as m,o as c,U as p,V as t,Z as b,$ as d,Y as f,a0 as a,a1 as w,a2 as k,W as C,r as g}from"./_plugin-vue_export-helper-cbb9d8af.js";import"./modal-838a1639.js";import"./_commonjsHelpers-042e6b4d.js";import"./base-component-5a126788.js";const{VITE_PATH:r}={VITE_PATH:"https://vue-final-dbjson-1aoj4rvyf-cookiesss123.vercel.app",BASE_URL:"/finalEasyMakeEasyBuy/",MODE:"production",DEV:!1,PROD:!0},V={data(){return{tempCoupon:{},status:"edit",recipes:[],startDate:"",dueDate:""}},mixins:[y],props:["id","openModal","getCoupons"],methods:{updateCoupon(){this.tempCoupon.startDate=new Date(this.startDate).getTime(),this.tempCoupon.dueDate=new Date(this.dueDate).getTime(),this.status==="edit"?this.$http.put(`${r}/coupons/${this.tempCoupon.id}`,this.tempCoupon).then(o=>{console.log(o.data),this.getCoupons(),this.hide()}).catch(o=>{console.log(o)}):this.status==="new"&&this.$http.post(`${r}/coupons`,this.tempCoupon).then(o=>{console.log(o.data),this.getCoupons(),this.hide()}).catch(o=>{console.log(o)})}},mounted(){},watch:{id(){this.id!=="new"&&this.id!==""?this.$http.get(`${r}/coupons/${this.id}`).then(o=>{this.tempCoupon=o.data,this.dueDate=new Date(this.tempCoupon.dueDate).toISOString().split("T")[0],this.startDate=new Date(this.tempCoupon.startDate).toISOString().split("T")[0],console.log(this.tempCoupon),this.show(),this.status="edit",this.openModal("")}).catch(o=>{console.log(o)}):this.id==="new"&&(this.tempCoupon={},this.show(),this.status="new",this.openModal(""))}}},E={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},T={class:"modal-dialog modal-xl"},I={class:"modal-content"},$={class:"modal-header bg-dark"},P={class:"modal-title text-white",id:"exampleModalLabel"},U={key:0},A={key:1},L=t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),S={class:"modal-body"},B={class:"row"},H={class:"col-4"},O=t("label",{for:"mainPic",class:"form-label"},"主圖網址",-1),j=["src"],N={class:"col-8"},R={class:"row gy-3"},F={class:"col-2"},W=t("label",{for:"serialNumber",class:"form-label"},"編號（id）",-1),Y={class:"col-7"},Z=t("label",{for:"title",class:"form-label"},"優惠券名稱",-1),q={class:"col-3"},z=t("label",{for:"price",class:"form-label"},"折扣(%)",-1),G={class:"col-4"},J=t("label",{for:"date",class:"form-label"},"起始日",-1),K={class:"col-4"},Q=t("label",{for:"date",class:"form-label"},"到期日",-1),X={class:"col-4"},tt=t("label",{for:"price",class:"form-label"},"優惠碼",-1),ot={class:"col-12"},et={class:"form-check"},st=t("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),lt={class:"col-12"},nt=t("label",{for:"description",class:"form-label"},"優惠券描述",-1),it={class:"modal-footer"},dt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1),at={key:0},ct={key:1};function pt(o,s,h,_,e,n){return c(),p("div",E,[t("div",T,[t("div",I,[t("div",$,[t("h5",P,[e.status==="edit"?(c(),p("span",U,"編輯優惠券內容")):e.status==="new"?(c(),p("span",A,"新增優惠券內容")):b("",!0)]),L]),t("div",S,[t("div",B,[t("div",H,[O,d(t("input",{type:"text",id:"mainPic",class:"form-control mb-3","onUpdate:modelValue":s[0]||(s[0]=l=>e.tempCoupon.img=l)},null,512),[[u,e.tempCoupon.img]]),t("img",{src:e.tempCoupon.img,alt:"",width:"300"},null,8,j)]),t("div",N,[t("div",R,[t("div",F,[W,d(t("input",{type:"text",id:"serialNumber",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=l=>e.tempCoupon.id=l),disabled:""},null,512),[[u,e.tempCoupon.id]])]),t("div",Y,[Z,d(t("input",{type:"text",id:"title",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=l=>e.tempCoupon.title=l)},null,512),[[u,e.tempCoupon.title]])]),t("div",q,[z,d(t("input",{type:"text",id:"price",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=l=>e.tempCoupon.discount=l)},null,512),[[u,e.tempCoupon.discount,void 0,{number:!0}]])]),t("div",G,[J,d(t("input",{type:"date",id:"date",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=l=>e.startDate=l)},null,512),[[u,e.startDate]])]),t("div",K,[Q,d(t("input",{type:"date",id:"date",class:"form-control","onUpdate:modelValue":s[5]||(s[5]=l=>e.dueDate=l)},null,512),[[u,e.dueDate]])]),t("div",X,[tt,d(t("input",{type:"text",id:"price",class:"form-control","onUpdate:modelValue":s[6]||(s[6]=l=>e.tempCoupon.code=l)},null,512),[[u,e.tempCoupon.code]])]),t("div",ot,[t("div",et,[d(t("input",{class:"form-check-input",type:"checkbox",value:"","true-value":"1","false-value":"0",id:"is_enabled","onUpdate:modelValue":s[7]||(s[7]=l=>e.tempCoupon.is_enabled=l)},null,512),[[x,e.tempCoupon.is_enabled]]),st])]),t("div",lt,[nt,d(t("textarea",{name:"",id:"description",cols:"30",rows:"10",class:"form-control","onUpdate:modelValue":s[8]||(s[8]=l=>e.tempCoupon.description=l)},null,512),[[u,e.tempCoupon.description]])])])])])]),t("div",it,[dt,t("button",{type:"button",class:"btn btn-primary",onClick:s[9]||(s[9]=(...l)=>n.updateCoupon&&n.updateCoupon(...l))},[e.status==="edit"?(c(),p("span",at,"確認編輯")):e.status==="new"?(c(),p("span",ct,"確認新增")):b("",!0)])])])])],512)}const ut=m(V,[["render",pt]]),{VITE_PATH:v}={VITE_PATH:"https://vue-final-dbjson-1aoj4rvyf-cookiesss123.vercel.app",BASE_URL:"/finalEasyMakeEasyBuy/",MODE:"production",DEV:!1,PROD:!0},rt={data(){return{tempCoupon:{}}},mixins:[y],props:["id","openDeleteModal","getCoupons"],methods:{deleteCoupon(){this.$http.delete(`${v}/coupons/${this.tempCoupon.id}`).then(o=>{console.log(o.data),this.getCoupons(),this.hide()}).catch(o=>{console.log(o)})}},watch:{id(){this.id&&(console.log(this.id,"改變了"),this.$http.get(`${v}/coupons/${this.id}`).then(o=>{this.tempCoupon=o.data,console.log(this.tempCoupon),this.show(),this.openDeleteModal("")}).catch(o=>{console.log(o)}))}}},mt={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},ht={class:"modal-dialog"},_t={class:"modal-content"},bt=t("div",{class:"modal-header bg-dark"},[t("h5",{class:"modal-title text-white",id:"exampleModalLabel"}," 刪除優惠券 "),t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ft={class:"modal-body"},Ct={class:"text-danger fw-bold"},gt={class:"modal-footer"},vt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1);function yt(o,s,h,_,e,n){return c(),p("div",mt,[t("div",ht,[t("div",_t,[bt,t("div",ft,[t("p",null,[f("確定要刪除優惠券 "),t("span",Ct," 【"+a(e.tempCoupon.title)+"】 ",1),f(" 嗎? ")])]),t("div",gt,[vt,t("button",{type:"button",class:"btn btn-danger",onClick:s[0]||(s[0]=(...l)=>n.deleteCoupon&&n.deleteCoupon(...l))}," 確認刪除 ")])])])],512)}const Dt=m(rt,[["render",yt]]),{VITE_PATH:Mt}={VITE_PATH:"https://vue-final-dbjson-1aoj4rvyf-cookiesss123.vercel.app",BASE_URL:"/finalEasyMakeEasyBuy/",MODE:"production",DEV:!1,PROD:!0},xt={components:{CouponModal:ut,DeleteCouponModal:Dt},data(){return{coupons:[],couponId:"",couponDeleteId:""}},methods:{getCoupons(){this.$http.get(`${Mt}/coupons`).then(o=>{console.log(o.data),this.coupons=o.data}).catch(o=>{console.log(o)})},openModal(o){this.couponId=o},openDeleteModal(o){this.couponDeleteId=o}},mounted(){this.getCoupons()}},wt={class:"container"},kt={class:"d-flex my-4"},Vt={class:"table text-center",style:{"vertical-align":"middle"}},Et=t("thead",null,[t("tr",null,[t("th",null,"編號"),t("th",null,"名稱"),t("th",null,"優惠碼"),t("th",null,"折扣百分比"),t("th",null,"詳細內容"),t("th",null,"起始日"),t("th",null,"到期日"),t("th",null,"是否啟用"),t("th",null,"編輯")])],-1),Tt={class:"btn-group"},It=["onClick"],$t=["onClick"];function Pt(o,s,h,_,e,n){const l=g("CouponModal"),D=g("DeleteCouponModal");return c(),p("div",wt,[t("div",kt,[t("button",{type:"button",class:"ms-auto btn btn-primary",onClick:s[0]||(s[0]=i=>n.openModal("new"))},"建立新優惠券")]),t("table",Vt,[Et,t("tbody",null,[(c(!0),p(w,null,k(e.coupons,i=>(c(),p("tr",{key:i.id+4564},[t("td",null,a(i.id),1),t("td",null,a(i.title),1),t("td",null,a(i.code),1),t("td",null,a(i.discount)+" %",1),t("td",null,a(i.description),1),t("td",null,a(new Date(i.startDate).toLocaleString().split(" ")[0]),1),t("td",null,a(new Date(i.dueDate).toLocaleString().split(" ")[0]),1),t("td",null,a(i.is_enabled?"是":"否"),1),t("td",null,[t("div",Tt,[t("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:M=>n.openModal(i.id)},"編輯",8,It),t("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:M=>n.openDeleteModal(i.id)},"刪除",8,$t)])])]))),128))])]),C(l,{ref:"productModal",id:e.couponId,"open-modal":n.openModal,"get-coupons":n.getCoupons},null,8,["id","open-modal","get-coupons"]),C(D,{ref:"deleteProductModal",id:e.couponDeleteId,"get-coupons":n.getCoupons,"open-delete-modal":n.openDeleteModal},null,8,["id","get-coupons","open-delete-modal"])])}const Ot=m(xt,[["render",Pt]]);export{Ot as default};
