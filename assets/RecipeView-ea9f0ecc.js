import{S as j,a as S,N as A,P as V}from"./pagination.min-ace2548d.js";import{b as U,v as D,w as q}from"./runtime-dom.esm-bundler-e140de91.js";import{m as E}from"./index-a9d6be75.js";import{o as M,r as a,b as f,d as m,s as v,e as P,p as F,c as O,a as I}from"./carts-810a7b65.js";import{n as z}from"./numberCommaMixin-e0aac39c.js";import{L as G}from"./index-2b32f149.js";import{_ as Y}from"./loadingLogo-ea15f612.js";import{_ as H,a7 as n,F as y,a9 as h,a8 as e,ad as l,ab as b,af as g,N as x,ae as k,aa as u,ac as B,c as w,r as T,o as r}from"./_plugin-vue_export-helper-d28549df.js";const J={components:{Swiper:j,SwiperSlide:S,Loading:G},mixins:[z],data(){return{recipe:{},modules:[A,V],navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",bulletClass:"my-bullet-class",bulletActiveClass:"my-bullet-active-class"},mainImg:"",bookMark:{},allThumbNum:0,myThumb:{},recipeComments:[],recipeMessage:"",qty:1,groupProduct:{},user:{},uid:"",isLoading:!1,fullPage:!0}},methods:{...E(O,["addCart","toastMessage","goToTop"]),getMyThumb(){M(I,i=>{if(i){this.uid=i.uid;const{id:o}=this.$route.params,d=a(m,`recipePersonalThumbs/${this.uid}/${o}`);f(d,p=>{this.myThumb=p.val()})}else this.uid=null,this.user={},this.myThumb=null})},getAllThumbs(){const{id:i}=this.$route.params,o=a(m,`recipeThumbs/${i}`);f(o,d=>{this.allThumbNum=d.val(),this.allThumbNum?this.allThumbNum=this.allThumbNum.thumbs:this.allThumbNum=0})},addThumb(){if(!this.uid){this.toastMessage("登入才可按讚","error");return}const i=a(m,`recipePersonalThumbs/${this.uid}/${this.recipe.id}`);v(i,this.recipe);const o=a(m,`recipeThumbs/${this.recipe.id}`);v(o,{thumbs:this.allThumbNum+1}),this.toastMessage("按讚成功")},deleteThumb(){P(a(m,`recipePersonalThumbs/${this.uid}/${this.recipe.id}`));const i=a(m,`recipeThumbs/${this.recipe.id}`);v(i,{thumbs:this.allThumbNum-1}),this.toastMessage("取消按讚")},getRecipe(){const{id:i}=this.$route.params,o=a(m,`recipes/${i}`);f(o,d=>{this.recipe=d.val(),this.recipe.id=i,this.mainImg=this.recipe.image,this.groupProduct=this.recipe.relativeProducts.filter(p=>p.category==="組合包"),this.groupProduct=this.groupProduct[0],this.isLoading=!1})},getAllComments(){const{id:i}=this.$route.params,o=a(m,"recipeComments/");f(o,d=>{let p=d.val();p=Object.values(p).map((s,c)=>(s.id=Object.keys(s)[c],s)),this.recipeComments=p.filter(s=>s.recipeId===i)})},addComments(){const i=a(m,"recipeComments"),o=F(i);v(o,{recipeId:this.recipe.id,createAt:new Date().getTime(),message:this.recipeMessage,username:this.user.nickName,userImg:this.user.headshotImg}),this.recipeMessage=""},getBookmark(){M(I,i=>{if(i){this.uid=i.uid;const o=a(m,"users/"+i.uid);f(o,d=>{this.user=d.val();const{id:p}=this.$route.params,s=a(m,`recipeBookmarks/${this.uid}/${p}`);f(s,c=>{this.bookMark=c.val()})})}else this.uid=null,this.user={},this.bookMark=null})},addBookmark(){if(!this.uid){this.toastMessage("登入才可使用收藏功能","error");return}const i=a(m,`recipeBookmarks/${this.uid}/${this.recipe.id}`);v(i,this.recipe),this.toastMessage("收藏成功")},deleteBookmark(){P(a(m,`recipeBookmarks/${this.uid}/${this.recipe.id}`)),this.toastMessage("已刪除收藏")}},mounted(){this.goToTop(),this.isLoading=!0,this.getAllThumbs(),this.getMyThumb(),this.getBookmark(),this.getRecipe(),this.getAllComments()}},K={class:"no-scroll-x"},Q=e("div",{class:"d-flex flex-column align-items-center py-96"},[e("img",{src:Y,class:"loading-logo mb-3",alt:"logo"}),e("p",{class:"text-center fw-bold text-purple fs-md-2 fs-5"},[e("span",{class:"me-1 animate-text"},"L"),e("span",{class:"mx-1 animate-text"},"o"),e("span",{class:"mx-1 animate-text"},"a"),e("span",{class:"mx-1 animate-text"},"d"),e("span",{class:"mx-1 animate-text"},"i"),e("span",{class:"mx-1 animate-text"},"n"),e("span",{class:"mx-1 animate-text"},"g"),e("span",{class:"mx-2 animate-text"},"."),e("span",{class:"me-2 animate-text"},"."),e("span",{class:"animate-text"},".")])],-1),W={class:"container py-md-96 py-60"},X={"aria-label":"breadcrumb"},Z={class:"breadcrumb"},$={class:"breadcrumb-item"},ee={class:"breadcrumb-item active","aria-current":"page"},se={class:"row row-cols-lg-2 row-cols-1 g-5"},te={class:"col"},oe=["src","alt"],ie={class:"sub-picture-swiper position-relative"},re=["src"],le=["src","alt","onClick"],ne={class:"col d-flex flex-column"},ce={class:"d-flex align-items-center mb-3"},ae={class:"badge rounded-pill bg-primary fs-6 me-2"},me={class:"mb-0 fs-lg-4 fs-5 fw-bold"},ue={class:"d-flex align-items-center ms-auto"},de=e("i",{class:"bi bi-heart"},null,-1),pe=[de],he=e("i",{class:"bi bi-heart-fill"},null,-1),be=[he],ge=e("i",{class:"bi bi-hand-thumbs-up"},null,-1),_e=e("i",{class:"bi bi-hand-thumbs-up-fill"},null,-1),fe={class:"table fs-md-5 mb-2"},ye=e("th",{class:"fw-normal text-muted",width:"150"},"食譜作者",-1),xe={class:"fw-normal"},ke=e("td",{class:"text-muted"},"份量",-1),ve=e("td",{class:"text-muted"},"甜點介紹",-1),we={class:"fs-6 lh-lg"},Te={class:"bg-light-purple-secondary"},Ce={class:"container py-lg-96 py-5"},Ne={class:"row row-cols-lg-2 row-cols-1 g-80"},Me={class:"col"},Pe=e("h3",{class:"d-flex align-items-center mb-4 fw-bold text-purple border-bottom pb-1 border-purple"},[e("span",{class:"material-icons me-2"}," auto_awesome "),u(" 準備材料 ")],-1),Ie={class:"table table- table-hover mb-60"},Be=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"名稱"),e("th",{scope:"col"},"單位")])],-1),Le={scope:"row"},Re=e("h3",{class:"d-flex align-items-center mb-4 fw-bold text-purple border-bottom pb-1 border-purple"},[e("span",{class:"material-icons me-2"}," auto_awesome "),u(" 相關產品 ")],-1),je={class:"d-flex mb-3"},Se={class:"card bg-transparent w-50 mx-auto"},Ae=["src","alt"],Ve=e("p",{class:"detail position-absolute top-50 start-50 translate-middle fw-bold letter-spacing-5 link-darkBrown fs-xl-5 text-center"},[u("查看"),e("br",{class:"d-xl-none d-lg-block"}),u("詳細食譜")],-1),Ue={class:"fs-md-5 fs-6"},De={class:"d-flex justify-content-between align-items-end"},qe={class:"mb-0 d-flex flex-column"},Ee={class:"text-gray fs-6 me-3"},Fe={class:"fs-5 text-danger fw-bold"},Oe=e("span",{class:"text-darkBrown"}," / 組",-1),ze={class:"input-group w-50"},Ge=["value"],Ye={class:"row mt-5 row-cols-lg-3 row-cols-2 g-3"},He={class:"card bg-transparent"},Je=["src","alt"],Ke=e("p",{class:"detail position-absolute top-50 start-50 translate-middle fw-bold link-darkBrown letter-spacing-5 text-center"},[u("查看"),e("br"),u("商品資訊")],-1),Qe={class:"fs-6"},We={class:"col"},Xe=e("h3",{class:"d-flex align-items-center mb-4 fw-bold text-purple border-bottom pb-1 border-purple"},[e("span",{class:"material-icons me-2"}," auto_awesome "),u(" 製作步驟 ")],-1),Ze={key:0,class:"mb-60"},$e=e("h3",{class:"d-flex align-items-center mb-4 fw-bold text-purple border-bottom pb-1 border-purple"},[e("span",{class:"material-icons me-2"}," auto_awesome "),u(" 教學影片 ")],-1),es=["src"],ss={class:"container py-lg-96 py-5"},ts={class:"d-flex align-items-center fw-bold text-purple border-bottom pb-1 border-purple mb-4"},os=e("span",{class:"material-icons me-2"}," auto_awesome ",-1),is={key:0},rs={class:"mb-3 fw-bold d-flex align-items-center"},ls=["src"],ns={key:1,class:"bi bi-person-circle me-3 fs-45"},cs={class:"d-flex"},as={class:"row gy-5 mt-3"},ms=["src"],us={key:1,class:"bi bi-person-circle me-3 fs-45 lh-1 mb-auto"},ds={class:"mb-0 fs-6"},ps={class:"mb-2"};function hs(i,o,d,p,s,c){const L=T("loading"),_=T("RouterLink"),N=T("swiper-slide"),R=T("swiper");return r(),n("div",K,[y(L,{active:s.isLoading,"onUpdate:active":o[0]||(o[0]=t=>s.isLoading=t),"can-cancel":!1,"is-full-page":s.fullPage,"lock-scroll":!0},{default:h(()=>[Q]),_:1},8,["active","is-full-page"]),e("section",W,[e("nav",X,[e("ol",Z,[e("li",$,[y(_,{to:"/recipes",class:"link-primary"},{default:h(()=>[u("甜點食譜")]),_:1})]),e("li",ee,l(s.recipe.title),1)])]),e("div",se,[e("div",te,[e("img",{src:s.mainImg,style:{height:"300px"},class:"w-100 object-fit-cover mb-4",alt:s.recipe.title},null,8,oe),e("div",ie,[y(R,{"slides-per-view":3,"space-between":15,modules:s.modules,navigation:"",style:{height:"160px"}},{default:h(()=>[y(N,null,{default:h(()=>[e("img",{src:s.recipe.image,alt:"食譜主圖片",class:g(["cursor-pointer object-fit-cover w-100",{border:s.mainImg===s.recipe.image,"border-3":s.mainImg===s.recipe.image,"border-primary":s.mainImg===s.recipe.image}]),style:{height:"100px"},onClick:o[1]||(o[1]=()=>s.mainImg=s.recipe.image)},null,10,re)]),_:1}),(r(!0),n(x,null,k(s.recipe.imgsUrl,(t,C)=>(r(),w(N,{key:t},{default:h(()=>[e("img",{src:t,alt:`食譜副圖片${C+1}`,class:g(["cursor-pointer object-fit-cover w-100",{border:s.mainImg===t,"border-3":s.mainImg===t,"border-primary":s.mainImg===t}]),style:{height:"100px"},onClick:()=>s.mainImg=t},null,10,le)]),_:2},1024))),128))]),_:1},8,["modules"])])]),e("div",ne,[e("div",ce,[e("span",ae,l(s.recipe.category),1),e("h2",me,l(s.recipe.title),1),e("div",ue,[s.bookMark?s.bookMark?(r(),n("button",{key:1,type:"button",class:"border-0 bg-transparent fs-4 text-tomato p-0 mt-1",onClick:o[3]||(o[3]=(...t)=>c.deleteBookmark&&c.deleteBookmark(...t))},be)):b("",!0):(r(),n("button",{key:0,type:"button",class:"border-0 bg-transparent text-tomato fs-4 p-0 mt-1",onClick:o[2]||(o[2]=()=>c.addBookmark(s.recipe.id))},pe)),s.myThumb?s.myThumb?(r(),n("button",{key:3,type:"button",class:g(["badge border border-primary rounded-pill fs-6 ms-4 btn-like",{"text-primary":s.allThumbNum,"text-gray":!s.allThumbNum}]),onClick:o[5]||(o[5]=(...t)=>c.deleteThumb&&c.deleteThumb(...t))},[e("span",{class:g(["mb-0 me-1",{"text-primary":s.allThumbNum,"text-gray":!s.allThumbNum}])},l(s.allThumbNum),3),_e],2)):b("",!0):(r(),n("button",{key:2,type:"button",class:g(["badge border border-primary rounded-pill fs-6 ms-4 btn-like",{"text-primary":s.allThumbNum,"text-gray":!s.allThumbNum}]),onClick:o[4]||(o[4]=(...t)=>c.addThumb&&c.addThumb(...t))},[e("span",{class:g(["mb-0 me-1",{"text-primary":s.allThumbNum,"text-gray":!s.allThumbNum}])},l(s.allThumbNum),3),ge],2))])]),e("table",fe,[e("thead",null,[e("tr",null,[ye,e("th",xe,l(s.recipe.author),1)])]),e("tbody",null,[e("tr",null,[ke,e("td",null,l(s.recipe.content),1)]),e("tr",null,[ve,e("td",we,l(s.recipe.description),1)])])])])])]),e("section",Te,[e("div",Ce,[e("div",Ne,[e("div",Me,[Pe,e("table",Ie,[Be,e("tbody",null,[(r(!0),n(x,null,k(s.recipe.ingredients,(t,C)=>(r(),n("tr",{key:t+367657},[e("th",Le,l(C+1),1),e("td",null,l(t.name),1),e("td",null,l(t.num)+" "+l(t.unit),1)]))),128))])]),Re,e("div",je,[e("div",Se,[y(_,{to:`/products/${s.groupProduct.id}`,class:"card-img-hover position-relative mb-3"},{default:h(()=>[e("img",{src:s.groupProduct.imgUrl,class:"object-fit-cover card-img",alt:s.groupProduct.title},null,8,Ae),Ve]),_:1},8,["to"]),y(_,{to:`/products/${s.groupProduct.id}`,class:"text-center"},{default:h(()=>[e("h5",Ue,l(s.groupProduct.title),1)]),_:1},8,["to"])])]),e("div",De,[e("div",qe,[e("del",Ee,"NT$ "+l(i.numberComma(s.groupProduct.originalPrice)),1),e("span",Fe,[u("NT$ "+l(i.numberComma(s.groupProduct.price))+" ",1),Oe])]),e("div",ze,[B(e("select",{name:"",id:"",class:"form-select text-center","onUpdate:modelValue":o[6]||(o[6]=t=>s.qty=t),style:{width:"70px"}},[(r(),n(x,null,k(30,t=>e("option",{value:t,key:t+4596945},l(t),9,Ge)),64))],512),[[U,s.qty]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:o[7]||(o[7]=()=>i.addCart(s.groupProduct,s.qty))},"一鍵買齊")])]),e("div",Ye,[(r(!0),n(x,null,k(s.recipe.relativeProducts,t=>(r(),n("div",{class:"col",key:t.id+456496},[e("div",He,[t.category==="單一產品"?(r(),w(_,{key:0,to:`/products/${t.id}`,class:"card-img-hover position-relative mb-2"},{default:h(()=>[e("img",{src:t.imgUrl,alt:t.title,class:"object-fit-cover card-img",style:{height:"150px !important"}},null,8,Je),Ke]),_:2},1032,["to"])):b("",!0),t.category==="單一產品"?(r(),w(_,{key:1,to:`/products/${t.id}`,class:"text-center"},{default:h(()=>[e("h5",Qe,l(t.title),1)]),_:2},1032,["to"])):b("",!0)])]))),128))])]),e("div",We,[Xe,s.recipe.instructions?(r(),n("div",Ze,[(r(!0),n(x,null,k(s.recipe.instructions.split("/"),t=>(r(),n("p",{class:"me-3 mb-4",key:t+346346},l(t),1))),128))])):b("",!0),$e,e("iframe",{src:s.recipe.video,class:"w-100",style:{height:"350px"},title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:""},null,8,es)])])])]),e("section",ss,[e("h3",ts,[os,u(" 顧客評價 "),e("div",{class:g(["ms-3 badge border rounded-pill fs-6",{"text-primary":s.recipeComments.length,"text-gray":!s.recipeComments.length,"border-primary":s.recipeComments.length,"border-gray":!s.recipeComments.length,"bg-secondary":s.recipeComments.length,"bg-whiteGray":!s.recipeComments.length}])},l(s.recipeComments.length)+" 則 ",3),s.uid?b("",!0):(r(),w(_,{key:0,to:"/loginSignup",class:"ms-auto mb-1 btn btn-outline-gradient rounded-pill"},{default:h(()=>[u("我要登入寫評價")]),_:1}))]),s.uid?(r(),n("form",is,[e("h5",rs,[s.user.headshotImg?(r(),n("img",{key:0,src:s.user.headshotImg,alt:"大頭貼",width:"50",height:"50",class:"object-fit-cover rounded-circle me-3"},null,8,ls)):s.user.headshotImg?b("",!0):(r(),n("i",ns)),u(" "+l(s.user.nickName),1)]),B(e("textarea",{class:"form-control",name:"",id:"",cols:"30",rows:"10","onUpdate:modelValue":o[8]||(o[8]=t=>s.recipeMessage=t)},null,512),[[D,s.recipeMessage]]),e("div",cs,[e("button",{type:"submit",class:"ms-auto btn btn-primary mt-3",onClick:o[9]||(o[9]=q((...t)=>c.addComments&&c.addComments(...t),["prevent"]))},"送出")])])):b("",!0),e("div",as,[(r(!0),n(x,null,k(s.recipeComments,t=>(r(),n("div",{class:"col-12 border-bottom d-flex align-items-center mb-2",key:t+3657},[t.userImg?(r(),n("img",{key:0,src:t.userImg,alt:"大頭貼",width:"50",height:"50",class:"rounded-circle me-3 object-fit-cover mb-auto"},null,8,ms)):t.userImg?b("",!0):(r(),n("i",us)),e("div",null,[e("h5",ds,l(t.username),1),e("p",null,l(`${new Date(t.createAt).toLocaleDateString()}`),1),e("p",ps,l(t.message),1)])]))),128))])])])}const ws=H(J,[["render",hs]]);export{ws as default};
