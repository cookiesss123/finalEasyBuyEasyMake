import{m as k,b as y}from"./axios-174aada3.js";import{c as m}from"./carts-f5125435.js";import{l as p}from"./runtime-dom.esm-bundler-226b1721.js";import{b6 as v,l as r,m as t,aJ as l,s as u,a3 as i,b3 as g,F as f,at as _,av as N,aj as a,t as I,b1 as x}from"./_plugin-vue_export-helper-31c7975b.js";import"./vue-router-495964e8.js";import"./_commonjsHelpers-042e6b4d.js";const{VITE_PATH:h}={VITE_PATH:"https://vue-final-dbjson-3nukrua10-cookiesss123.vercel.app",BASE_URL:"/finalEasyMakeEasyBuy/",MODE:"production",DEV:!1,PROD:!0},E={data(){return{user:{},orders:[],filterOrders:[],selectItem:"全部",orderArrived:[],nickNameEdit:!0,passwordEdit:!0,newNickName:"",newPassword:"",nickName:""}},methods:{...k(m,["checkLogin","toastMessage"]),getUserInfo(){this.$http.get(`${h}/600/users/${this.userId}`,{headers:{authorization:`Bearer ${this.token}`}}).then(o=>{console.log("使用者資料",o.data),this.user=o.data,localStorage.setItem("nickName",this.user.nickName),this.nickName=localStorage.getItem("nickName"),this.checkLogin(),this.newNickName=this.user.nickName}).catch(o=>{console.log(o)})},getOrders(){this.$http.get(`${h}/600/users/${this.userId}/orders`,{headers:{authorization:`Bearer ${this.token}`}}).then(o=>{console.log("訂單",o.data),this.orders=o.data,this.filterOrders=o.data,this.orderArrived=this.orders.filter(s=>s.deliveryStatus==="待取貨")}).catch(o=>{console.log(o)})},updateUserInfo(o){let s={nickName:this.newNickName};if(o==="nickNameEdit"){if(console.log(this.newNickName.length),this.newNickName.length>10){this.toastMessage("暱稱不得超過10個字元","error");return}else if(this.newNickName===""){this.$swal({icon:"error",title:"暱稱不得是空字串",showConfirmButton:!1,timer:1500});return}}else if(o==="passwordEdit"){if(this.newPassword.length<4||this.newPassword===""){this.toastMessage("新密碼不得少於4個字元","error");return}s={password:this.newPassword}}this.$http.patch(`${h}/600/users/${this.userId}`,s,{headers:{authorization:`Bearer ${this.token}`}}).then(c=>{console.log(c.data),o==="nickNameEdit"?(this.nickNameEdit=!0,this.toastMessage("暱稱修改成功")):o==="passwordEdit"&&(this.passwordEdit=!0,this.toastMessage("密碼修改成功")),this.getUserInfo()}).catch(c=>{console.log(c)})}},mounted(){this.checkLogin(),console.log(this.token,this.userId,this.nickName,"金鑰"),this.token||(this.$swal({icon:"error",title:"請先登入",showConfirmButton:!1,timer:1500}),this.$router.push("/loginSignup/login")),this.getUserInfo(),this.getOrders()},watch:{selectItem(){this.selectItem==="全部"?this.filterOrders=this.orders:this.selectItem!=="全部"&&(this.filterOrders=this.orders.filter(o=>o.deliveryStatus===this.selectItem))}},computed:{...y(m,["token","userId"])}},C={class:"mt-10 container"},S=t("ul",{class:"nav nav-tabs",id:"myTab",role:"tablist"},[t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link active",id:"home-tab","data-bs-toggle":"tab","data-bs-target":"#home",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"},"會員資料")]),t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link",id:"profile-tab","data-bs-toggle":"tab","data-bs-target":"#profile",type:"button",role:"tab","aria-controls":"profile","aria-selected":"false"},"訂單狀況")])],-1),O={class:"tab-content",id:"myTabContent"},B={class:"tab-pane fade show active text-brown",id:"home",role:"tabpanel","aria-labelledby":"home-tab"},T={class:"d-lg-flex align-items-center justify-content-center"},U=t("div",null,[t("i",{class:"bi bi-person-circle me-10",style:{"font-size":"90px"}}),t("br"),t("button",{type:"button",class:"btn btn-orange"},"重新上傳照片")],-1),M={class:"tabletable-borderless"},P={height:"50",class:"border-bottom"},A=t("th",{width:"100"},"暱稱",-1),L={width:"300"},V={width:"100"},D=t("i",{class:"bi bi-pencil"},null,-1),z={height:"50",class:"border-bottom"},j=t("td",null,"信箱",-1),R=t("td",null,null,-1),F={height:"50",class:"border-bottom"},H=t("td",null,"密碼",-1),q=t("td",null,"****************",-1),J=t("i",{class:"bi bi-pencil"},null,-1),G=t("tr",{height:"50",class:"border-bottom"},[t("td",null,"我的抽獎券"),t("td",null,"13 張"),t("td",null,[t("button",{type:"button",class:"btn btn-orange"},"立即抽獎")])],-1),K=t("tr",{height:"50"},[t("td",null,"我的折價券"),t("td",null,[t("ol",null,[t("li",null,"23423可折200元"),t("li",null,"23423可折200元")])]),t("td",null,[t("button",{type:"button",class:"btn btn-orange"},"立即選購")])],-1),Q={class:"tab-pane fade",id:"profile",role:"tabpanel","aria-labelledby":"profile-tab"},W={class:"selectOrderStatus py-2"},X={class:"position-absolute bg-danger border border-light text-white",style:{padding:"2px","border-radius":"25px",width:"25px",height:"25px","font-size":"12px",top:"-10px",left:"70px"}},Y={class:"row row-cols-1 text-brown py-3"},Z={class:"mb-3"},$={class:"ms-4"},tt={class:"row row-cols-lg-6 row-cols-2 align-items-center mt-2"},et=["src"],st={class:"mb-0"},ot={class:"mb-0"},nt=t("div",{class:"col-3 text-danger"},null,-1),lt={class:"d-flex"},it={class:"ms-auto d-flex align-items-center"},rt={class:"me-3 fw-bold"},at=t("hr",null,null,-1);function ct(o,s,c,dt,e,b){const w=N("RouterLink");return a(),r("div",C,[S,t("div",O,[t("div",B,[t("div",T,[U,t("table",M,[t("thead",P,[t("tr",null,[A,t("th",L,l(e.nickName),1),t("th",V,[t("button",{type:"button",class:"btn btn-sm btn-orange",onClick:s[0]||(s[0]=()=>e.nickNameEdit=!e.nickNameEdit)},[D,u(" 修改暱稱 ")])]),t("th",null,[t("div",{class:i(["input-group",{"d-none":e.nickNameEdit}])},[g(t("input",{type:"text",class:"form-control",placeholder:"請輸入新暱稱","onUpdate:modelValue":s[1]||(s[1]=n=>e.newNickName=n)},null,512),[[p,e.newNickName]]),t("button",{onClick:s[2]||(s[2]=()=>b.updateUserInfo("nickNameEdit")),class:"btn btn-outline-secondary",type:"button",id:"button-addon2"},"確定")],2)])])]),t("tbody",null,[t("tr",z,[j,t("td",null,l(e.user.email),1),R]),t("tr",F,[H,q,t("td",null,[t("button",{type:"button",class:"btn btn-sm btn-orange",onClick:s[3]||(s[3]=()=>e.passwordEdit=!e.passwordEdit)},[J,u(" 變更密碼 ")])]),t("td",null,[t("div",{class:i(["input-group",{"d-none":e.passwordEdit}])},[g(t("input",{type:"password",class:"form-control",placeholder:"請輸入新密碼","onUpdate:modelValue":s[4]||(s[4]=n=>e.newPassword=n)},null,512),[[p,e.newPassword]]),t("button",{onClick:s[5]||(s[5]=()=>b.updateUserInfo("passwordEdit")),class:"btn btn-outline-secondary",type:"button",id:"button-addon2"},"確定")],2)])]),G,K])])])]),t("div",Q,[t("div",W,[t("button",{type:"button",class:"btn border-0 me-lg-5",onClick:s[6]||(s[6]=()=>e.selectItem="全部")},[t("span",{class:i(["text-secondary",{"text-orange":e.selectItem==="全部","fw-bold":e.selectItem==="全部"}])}," 全部 ",2)]),t("button",{type:"button",class:"btn border-0 me-lg-5",onClick:s[7]||(s[7]=()=>e.selectItem="待出貨")},[t("span",{class:i(["text-secondary",{"text-orange":e.selectItem==="待出貨","fw-bold":e.selectItem==="待出貨"}])},"待出貨",2)]),t("button",{type:"button",class:"btn border-0 me-lg-5",onClick:s[8]||(s[8]=()=>e.selectItem="運送中")},[t("span",{class:i(["text-secondary",{"text-orange":e.selectItem==="運送中","fw-bold":e.selectItem==="運送中"}])},"運送中",2)]),t("button",{type:"button",class:"btn border-0 me-lg-5 position-relative",onClick:s[9]||(s[9]=()=>e.selectItem="待取貨")},[t("span",{class:i(["text-secondary",{"text-orange":e.selectItem==="待取貨","fw-bold":e.selectItem==="待取貨"}])},"待取貨",2),t("span",X,l(e.orderArrived.length),1)]),t("button",{type:"button",class:"btn border-0 me-lg-5",onClick:s[10]||(s[10]=()=>e.selectItem="訂單完成")},[t("span",{class:i(["text-secondary",{"text-orange":e.selectItem==="訂單完成","fw-bold":e.selectItem==="訂單完成"}])},"訂單完成",2)])]),t("div",Y,[t("h4",Z," 總共有 "+l(e.filterOrders.length)+" 筆 ",1),(a(!0),r(f,null,_(e.filterOrders,n=>(a(),r("div",{class:"col",key:n.id+54359},[t("span",null,"訂單建立時間："+l(new Date(n.creatAt).toLocaleDateString()),1),t("span",$,"訂單編號："+l(n.id),1),t("div",tt,[(a(!0),r(f,null,_(n.cart.items,d=>(a(),r("div",{class:"col",key:d+6603},[t("img",{src:d.product.imgUrl,alt:"",height:"100",width:"150",style:{"object-fit":"cover"}},null,8,et),t("p",st,l(d.product.title),1),t("p",ot,"x "+l(d.qty),1)]))),128)),nt]),t("div",lt,[t("div",it,[t("span",rt,"運送狀態："+l(n.deliveryStatus),1),t("span",null,"總付款金額：NT$ "+l(n.cart.finalTotal),1),I(w,{to:`/orders/${n.id}`,class:"btn btn-brown ms-3"},{default:x(()=>[u("查看詳細訂單狀況")]),_:2},1032,["to"])])]),at]))),128))])])])])}const ft=v(E,[["render",ct]]);export{ft as default};
