import{R as O}from"./vue-router-495964e8.js";import{m as R,b as B}from"./axios-0933a5f0.js";import{c as v}from"./carts-e3b12cd8.js";import{l as C,w as E,n as j,j as g}from"./runtime-dom.esm-bundler-226b1721.js";import{_ as L}from"./icon-search-d6364761.js";import{_ as T}from"./image5-4fc2427e.js";import{_ as I}from"./image4-1806383b.js";import{b6 as M,l as c,m as e,a3 as h,s as f,aJ as d,b3 as b,F as y,at as k,k as u,av as N,aj as n,t as w,b1 as x}from"./_plugin-vue_export-helper-31c7975b.js";import"./_commonjsHelpers-042e6b4d.js";const S="/finalEasyMakeEasyBuy/assets/dessert-main-image-molten-cake-0fbd4f2-f4502124.jpg",V="/finalEasyMakeEasyBuy/assets/13d687f987752ba797cc3684987316e6-f2b80201.jpg",D="/finalEasyMakeEasyBuy/assets/cookies-4053771_960_720222-a7810d77.jpg",P="/finalEasyMakeEasyBuy/assets/baked-mochi-donuts-DSC_3500-1x1-1200-ae576dd9.jpg",U="/finalEasyMakeEasyBuy/assets/IMG_P-0051-1000x600-2dd9dd1d.jpg",A="/finalEasyMakeEasyBuy/assets/瘋提拉米蘇-1-c740fada.jpg";const{VITE_PATH:a}={VITE_PATH:"https://vue-final-dbjson-3nukrua10-cookiesss123.vercel.app",BASE_URL:"/finalEasyMakeEasyBuy/",MODE:"production",DEV:!1,PROD:!0},z={components:{RouterLink:O},data(){return{recipes:[],selectCategory:"全部",selectItem:"全部",priceOrRate:"成本",highOrLow:"不拘",recipeSearchName:"",filterRecipes:[],bookMarks:[],recipeThumbs:[],thumbs:{},myThumbs:[],myThumbObj:{},sortThumbs:[]}},methods:{...R(v,["toastMessage"]),getRecipes(){this.$http.get(`${a}/recipes`).then(r=>{console.log("所有食譜",r.data),this.recipes=r.data,this.filterRecipes=r.data,this.searchRecipes()}).catch(r=>{console.log(r)})},searchRecipes(){let r=`${a}/recipes`;this.selectItem==="全部"?r=`${a}/recipes`:this.selectItem!=="全部"&&(r=`${a}/recipes?category=${this.selectItem}`),this.$http.get(r).then(o=>(this.filterRecipes=o.data,this.$http.get(`${a}/recipeThumbs?_expand=recipe`))).then(o=>{console.log("所有食譜讚",o.data),this.recipeThumbs=o.data,this.thumbs={},this.recipeThumbs.forEach(l=>{this.thumbs[l.recipe.id]===void 0?this.thumbs[l.recipe.id]={people:1,recipe:l.recipe}:this.thumbs[l.recipe.id].people+=1}),this.recipes.forEach(l=>{Object.keys(this.thumbs).forEach(t=>{this.thumbs[l.id]===void 0&&(this.thumbs[l.id]={people:0,recipe:l})})}),console.log("搜尋參數",this.selectItem,this.priceOrRate,this.highOrLow,this.recipeSearchName);let i=`${a}/recipes`;if(this.highOrLow==="不拘"&&this.selectItem==="全部"){this.sortThumbs=[],this.filterRecipes=this.recipes.filter(l=>l.title.match(this.recipeSearchName));return}else this.priceOrRate==="成本"?(this.sortThumbs=[],this.selectItem==="全部"?this.highOrLow==="低到高"?i=`${a}/recipes?_sort=total&_order=asc`:this.highOrLow==="高到低"&&(i=`${a}/recipes?_sort=total&_order=desc`):this.selectItem!=="全部"&&(this.highOrLow==="不拘"?i=`${a}/recipes?category=${this.selectItem}`:this.highOrLow==="低到高"?i=`${a}/recipes?category=${this.selectItem}&_sort=total&_order=asc`:this.highOrLow==="高到低"&&(i=`${a}/recipes?category=${this.selectItem}&_sort=total&_order=desc`))):this.priceOrRate==="評價"&&(this.sortThumbs=[],this.filterRecipes.forEach(l=>{Object.entries(this.thumbs).forEach(t=>{t[1].recipe.id===l.id&&this.sortThumbs.push(t)})}),console.log(this.filterRecipes,"this.filterRecipes 有東西嗎"),console.log(this.sortThumbs,"食譜排序???"),this.highOrLow==="低到高"?(this.sortThumbs=this.sortThumbs.sort((l,t)=>l[1].people-t[1].people),console.log(this.sortThumbs,"排序好的食譜評價 低到高")):this.highOrLow==="高到低"&&(this.sortThumbs=this.sortThumbs.sort((l,t)=>t[1].people-l[1].people),console.log(this.sortThumbs,this.filterRecipes,"排序好的食譜評價 高到低")),this.recipeSearchName!==""&&(this.sortThumbs=this.sortThumbs.filter(l=>l[1].recipe.title.match(this.recipeSearchName))));this.priceOrRate!=="評價"&&this.$http.get(`${i}`).then(l=>{this.filterRecipes=l.data,this.recipeSearchName!==""&&(this.filterRecipes=this.filterRecipes.filter(t=>t.title.match(this.recipeSearchName))),console.log(this.filterRecipes,"最終結果")}).catch(l=>{console.log(l)})})},getBookmarks(){if(!this.token)return;const r=`${a}/600/users/${this.userId}/recipeBookmarks?_expand=recipe`;this.$http.get(r,{headers:{authorization:`Bearer ${this.token}`}}).then(o=>{console.log("書籤",o.data),this.bookMarks=o.data}).catch(o=>{console.log(o)})},addBookmark(r){if(!this.token){this.toastMessage("登入才可使用收藏功能","error");return}const o={userId:this.userId,recipeId:r};this.$http.post(`${a}/600/users/${this.userId}/recipeBookmarks?_expand=recipe`,o,{headers:{authorization:`Bearer ${this.token}`}}).then(i=>{console.log("增加書籤",i.data),this.getBookmarks(),this.toastMessage("收藏成功")}).catch(i=>{console.log(i)})},deleteBookmark(r){let o="";this.bookMarks.forEach(i=>{i.recipeId.toString()===r.toString()&&(o=i.id)}),this.$http.delete(`${a}/600/recipeBookmarks/${Number(o)}`,{headers:{authorization:`Bearer ${this.token}`}}).then(i=>{console.log("刪除收藏",i.data),this.getBookmarks(),this.toastMessage("刪除收藏")}).catch(i=>{console.log(i)})},getAllRecipeThumbs(){const r=`${a}/recipeThumbs?_expand=recipe`;this.$http.get(r).then(o=>{console.log("所有食譜讚",o.data),this.recipeThumbs=o.data,this.thumbs={},this.recipeThumbs.forEach(i=>{this.thumbs[i.recipe.id]===void 0?this.thumbs[i.recipe.id]={people:1,recipe:i.recipe}:this.thumbs[i.recipe.id].people+=1}),this.recipes.forEach(i=>{Object.keys(this.thumbs).forEach(l=>{this.thumbs[i.id]===void 0&&(this.thumbs[i.id]={people:0,recipe:i})})}),console.log("分類好的讚",Object.entries(this.thumbs))}).catch(o=>{console.log(o)})},getMyThumb(){if(!this.token)return;const r=`${a}/600/users/${this.userId}/recipeThumbs`;this.$http.get(r,{headers:{authorization:`Bearer ${this.token}`}}).then(o=>{console.log("我按了哪些食譜讚?",o.data),this.myThumbs=o.data,this.myThumbs.forEach(i=>{this.myThumbObj[i.recipeId]===void 0&&(this.myThumbObj[i.recipeId]={thumb:!0})}),console.log("我讚過的食譜",this.myThumbObj)}).catch(o=>{console.log(o)})}},mounted(){this.recipeSearchName=this.$route.query.searchName,this.selectItem=this.$route.query.category,this.highOrLow=this.$route.query.valueHighOrLow,this.priceOrRate=this.$route.query.valuePriceOrRate,this.getRecipes(),this.getBookmarks(),this.getAllRecipeThumbs(),this.getMyThumb()},watch:{selectCategory(){this.sortThumbs=[];let r=`${a}/recipes`;this.selectCategory==="全部"?(this.selectItem="全部",r=`${a}/recipes`):this.selectCategory!=="全部"&&(this.selectItem=this.selectCategory,r=`${a}/recipes?category=${this.selectCategory}`),this.$http.get(`${r}`).then(o=>{console.log("監聽篩選值",o.data),this.filterRecipes=o.data}).catch(o=>{console.log(o)})}},computed:{...B(v,["token","userId"])}},H={class:"py-100-sm-40"},q={class:"bg-lightYellow py-4 px-lg-5",style:{"overflow-x":"hidden"}},G={class:"container"},F={class:"selectProductCategory row row-cols-lg-6 row-cols-3"},K=e("br",null,null,-1),$=e("br",null,null,-1),J=e("br",null,null,-1),Y=e("br",null,null,-1),Q=e("br",null,null,-1),W=e("br",null,null,-1),X={class:"d-none d-lg-block container selectProduct my-5"},Z={class:"input-group"},ee={class:"btn btn-outline-brown px-5","data-bs-toggle":"collapse",href:"#multiCollapseExample1",role:"button","aria-expanded":"false","aria-controls":"multiCollapseExample1"},te=e("i",{class:"bi bi-caret-down-fill"},null,-1),se={class:"ms-2 fw-bold"},oe={class:"btn btn-outline-brown px-5",type:"button","data-bs-toggle":"collapse","data-bs-target":"#multiCollapseExample2","aria-expanded":"false","aria-controls":"multiCollapseExample2"},ie=e("i",{class:"bi bi-caret-down-fill"},null,-1),re={class:"ms-2 fw-bold"},le=e("img",{src:L,style:{height:"25px"},alt:""},null,-1),ce=[le],ne={class:"row g-0",id:"myGroup"},ae={class:"col-2"},he={ref:"collapse1","data-bs-parent":"#myGroup",class:"collapse multi-collapse",id:"multiCollapseExample1"},de={class:"card card-body border-0"},pe={class:"btn-group-vertical",role:"group","aria-label":"Vertical radio toggle button group"},ue=e("label",{class:"btn btn-outline-brown",for:"selectprice"},"成本",-1),be=e("label",{class:"btn btn-outline-brown",for:"selectRate"},"評價",-1),me={class:"col-2"},ge={ref:"collapse2","data-bs-parent":"#myGroup",class:"collapse multi-collapse",id:"multiCollapseExample2"},_e={class:"card card-body border-0"},fe={class:"btn-group-vertical",role:"group","aria-label":"Vertical radio toggle button group"},ye=e("label",{class:"btn btn-outline-brown",for:"noDifference"},"不拘",-1),ke=e("label",{class:"btn btn-outline-brown",for:"highToLow"},"高到低",-1),we=e("label",{class:"btn btn-outline-brown",for:"lowToHigh"},"低到高",-1),xe={class:"container"},ve={key:0,class:"row row-cols-lg-4 row-cols-1 gy-4"},Te={class:"card position-relative border-0 bg-transparent",style:{"border-radius":"20px"}},Ie=["src"],Oe={class:"card-text"},Re=["onClick"],Be=e("img",{src:T},null,-1),Ce=[Be],Ee=["onClick"],je=e("img",{src:I},null,-1),Le=[je],Me={style:{"pointer-events":"none",top:"155px"},class:"badge rounded-pill bg-brown mt-4 border-0 me-3 position-absolute end-0"},Ne={class:"h5 d-flex justify-content-between fw-bold"},Se={class:"col-12 d-flex justify-content-end"},Ve={class:"mt-1"},De={class:"d-flex align-items-center justify-content-end"},Pe={key:0,class:"mb-0 ms-3"},Ue={key:1,type:"button",class:"border-0 bg-transparent text-brown fs-5"},Ae=e("i",{class:"bi bi-hand-thumbs-up-fill"},null,-1),ze=[Ae],He={key:2,type:"button",class:"border-0 bg-transparent text-brown fs-5"},qe=e("i",{class:"bi bi-hand-thumbs-up"},null,-1),Ge=[qe],Fe={key:1,class:"row row-cols-lg-4 row-cols-1 gy-4"},Ke={class:"card position-relative border-0 bg-transparent",style:{"border-radius":"20px"}},$e=["src"],Je={class:"card-text"},Ye=["onClick"],Qe=e("img",{src:T},null,-1),We=[Qe],Xe=["onClick"],Ze=e("img",{src:I},null,-1),et=[Ze],tt={style:{"pointer-events":"none",top:"155px"},class:"badge rounded-pill bg-brown mt-4 border-0 me-3 position-absolute end-0"},st={class:"h5 d-flex justify-content-between fw-bold"},ot={class:"col-12 d-flex justify-content-end"},it={class:"mt-1"},rt={class:"d-flex align-items-center justify-content-end"},lt={key:0,class:"mb-0 ms-3"},ct={key:1,type:"button",class:"border-0 bg-transparent text-brown fs-5"},nt=e("i",{class:"bi bi-hand-thumbs-up-fill"},null,-1),at=[nt],ht={key:2,type:"button",class:"border-0 bg-transparent text-brown fs-5"},dt=e("i",{class:"bi bi-hand-thumbs-up"},null,-1),pt=[dt];function ut(r,o,i,l,t,p){const _=N("RouterLink");return n(),c("div",H,[e("section",q,[e("div",G,[e("div",F,[e("button",{type:"button",class:"col btn border-0",onClick:o[0]||(o[0]=()=>t.selectCategory="全部")},[e("img",{src:S,alt:"",class:h(["rounded-circle mb-lg-3 mb-1",{selectImgBorder:t.selectItem==="全部"}]),style:{"object-fit":"cover"}},null,2),K,e("span",{class:h(["text-secondary",{"text-orange":t.selectItem==="全部","fw-bold":t.selectItem==="全部"}])},"全部",2)]),e("button",{type:"button",class:"col btn border-0",onClick:o[1]||(o[1]=()=>t.selectCategory="台式甜點")},[e("img",{src:V,alt:"",class:h(["rounded-circle mb-lg-3 mb-1",{selectImgBorder:t.selectItem==="台式甜點"}]),style:{"object-fit":"cover"}},null,2),$,e("span",{class:h(["text-secondary",{"text-orange":t.selectItem==="台式甜點","fw-bold":t.selectItem==="台式甜點"}])},"台式甜點",2)]),e("button",{type:"button",class:"col btn border-0",onClick:o[2]||(o[2]=()=>t.selectCategory="法式甜點")},[e("img",{src:D,alt:"",class:h(["rounded-circle mb-lg-3 mb-1",{selectImgBorder:t.selectItem==="法式甜點"}]),style:{"object-fit":"cover"}},null,2),J,e("span",{class:h(["text-secondary",{"text-orange":t.selectItem==="法式甜點","fw-bold":t.selectItem==="法式甜點"}])},"法式甜點",2)]),e("button",{type:"button",class:"col btn border-0",onClick:o[3]||(o[3]=()=>t.selectCategory="美式甜點")},[e("img",{src:P,alt:"",class:h(["rounded-circle mb-lg-3 mb-1",{selectImgBorder:t.selectItem==="美式甜點"}]),style:{"object-fit":"cover"}},null,2),Y,e("span",{class:h(["text-secondary",{"text-orange":t.selectItem==="美式甜點","fw-bold":t.selectItem==="美式甜點"}])},"美式甜點",2)]),e("button",{type:"button",class:"col btn border-0",onClick:o[4]||(o[4]=()=>t.selectCategory="日式甜點")},[e("img",{src:U,alt:"",class:h(["rounded-circle mb-lg-3 mb-1",{selectImgBorder:t.selectItem==="日式甜點"}]),style:{"object-fit":"cover"}},null,2),Q,e("span",{class:h(["text-secondary",{"text-orange":t.selectItem==="日式甜點","fw-bold":t.selectItem==="日式甜點"}])},"日式甜點",2)]),e("button",{type:"button",class:"col btn border-0",onClick:o[5]||(o[5]=()=>t.selectCategory="義式甜點")},[e("img",{src:A,alt:"",class:h(["rounded-circle mb-lg-3 mb-1",{selectImgBorder:t.selectItem==="義式甜點"}]),style:{"object-fit":"cover"}},null,2),W,e("span",{class:h(["text-secondary",{"text-orange":t.selectItem==="義式甜點","fw-bold":t.selectItem==="義式甜點"}])},"義式甜點",2)])])])]),e("section",X,[e("div",Z,[e("a",ee,[f("篩選對象 "),te,e("span",se,d(t.priceOrRate),1)]),e("button",oe,[f("篩選值 "),ie,e("span",re,d(t.highOrLow),1)]),b(e("input",{type:"search",class:"form-control border-brown border-end-0",placeholder:"請輸入食譜名稱","aria-label":"Example text with two button addons","onUpdate:modelValue":o[6]||(o[6]=s=>t.recipeSearchName=s),onKeyup:o[7]||(o[7]=E((...s)=>p.searchRecipes&&p.searchRecipes(...s),["enter"]))},null,544),[[C,t.recipeSearchName]]),e("button",{type:"submit",class:"btn border border-brown border-start-0 bg-transparent",onClick:o[8]||(o[8]=j((...s)=>p.searchRecipes&&p.searchRecipes(...s),["prevent"]))},ce)]),e("div",ne,[e("div",ae,[e("div",he,[e("div",de,[e("div",pe,[b(e("input",{type:"radio",class:"btn-check",value:"成本",name:"priceOrRate",id:"selectprice",autocomplete:"off","onUpdate:modelValue":o[9]||(o[9]=s=>t.priceOrRate=s)},null,512),[[g,t.priceOrRate]]),ue,b(e("input",{type:"radio",class:"btn-check",value:"評價",name:"priceOrRate",id:"selectRate",autocomplete:"off","onUpdate:modelValue":o[10]||(o[10]=s=>t.priceOrRate=s)},null,512),[[g,t.priceOrRate]]),be])])],512)]),e("div",me,[e("div",ge,[e("div",_e,[e("div",fe,[b(e("input",{type:"radio",class:"btn-check",value:"不拘",name:"highOrLow",id:"noDifference",autocomplete:"off",checked:"","onUpdate:modelValue":o[11]||(o[11]=s=>t.highOrLow=s)},null,512),[[g,t.highOrLow]]),ye,b(e("input",{type:"radio",class:"btn-check",value:"高到低",name:"highOrLow",id:"highToLow",autocomplete:"off","onUpdate:modelValue":o[12]||(o[12]=s=>t.highOrLow=s)},null,512),[[g,t.highOrLow]]),ke,b(e("input",{type:"radio",class:"btn-check",value:"低到高",name:"highOrLow",id:"lowToHigh",autocomplete:"off","onUpdate:modelValue":o[13]||(o[13]=s=>t.highOrLow=s)},null,512),[[g,t.highOrLow]]),we])])],512)])])]),e("section",xe,[t.sortThumbs.length?t.sortThumbs.length?(n(),c("div",Fe,[(n(!0),c(y,null,k(t.sortThumbs,s=>(n(),c("div",{class:"col text-decoration-none",key:s+346663},[e("div",Ke,[w(_,{to:`/recipes/${s[1].recipe.id}`},{default:x(()=>[e("img",{src:s[1].recipe.image,class:"card-img",height:"220",style:{"border-radius":"20px","object-fit":"cover","max-width":"100%","max-height":"100%"},alt:""},null,8,$e)]),_:2},1032,["to"]),e("h5",Je,[e("button",{type:"button",class:"position-absolute bookmarkBtn border-0 bg-transparent me-auto top-0 m-3",onClick:()=>p.addBookmark(s[1].recipe.id)},We,8,Ye),(n(!0),c(y,null,k(t.bookMarks,m=>(n(),c("div",{key:m.id+4567},[m.recipeId===s[1].recipe.id?(n(),c("button",{key:0,type:"button",class:"position-absolute deleteBookmarkBtn border-0 bg-transparent me-auto top-0 m-3",onClick:()=>p.deleteBookmark(s[1].recipe.id)},et,8,Xe)):u("",!0)]))),128)),e("span",tt,d(s[1].recipe.category),1)]),w(_,{to:`/recipes/${s[1].recipe.id}`,class:"card-footer bg-transparent border-0 text-decoration-none link-darkBrown"},{default:x(()=>[e("h5",st,d(s[1].recipe.title),1),e("div",ot,[e("del",{class:h(["me-2 text-muted mt-1",{"d-none":s[1].recipe.price===s[1].recipe.total}])},"NT$ "+d(s[1].recipe.total),3),e("span",it,[e("span",{class:h({"text-danger":s[1].recipe.price!==s[1].recipe.total,"fw-bold":s[1].recipe.price!==s[1].recipe.total})},"NT$ "+d(s[1].recipe.price),3),f(" / "+d(s[1].recipe.content),1)])]),e("div",rt,[t.thumbs[s[1].recipe.id]?(n(),c("span",lt,d(t.thumbs[s[1].recipe.id].people),1)):u("",!0),t.myThumbObj[s[1].recipe.id]?(n(),c("button",ct,at)):t.myThumbObj[s[1].recipe.id]?u("",!0):(n(),c("button",ht,pt))])]),_:2},1032,["to"])])]))),128))])):u("",!0):(n(),c("div",ve,[(n(!0),c(y,null,k(t.filterRecipes,s=>(n(),c("div",{class:"col text-decoration-none",key:s.id},[e("div",Te,[w(_,{to:`/recipes/${s.id}`},{default:x(()=>[e("img",{src:s.image,class:"card-img",height:"220",style:{"border-radius":"20px","object-fit":"cover","max-width":"100%","max-height":"100%"},alt:""},null,8,Ie)]),_:2},1032,["to"]),e("h5",Oe,[e("button",{type:"button",class:"position-absolute bookmarkBtn border-0 bg-transparent me-auto top-0 m-3",onClick:()=>p.addBookmark(s.id)},Ce,8,Re),(n(!0),c(y,null,k(t.bookMarks,m=>(n(),c("div",{key:m.id+4567},[m.recipeId===s.id?(n(),c("button",{key:0,type:"button",class:"position-absolute deleteBookmarkBtn border-0 bg-transparent me-auto top-0 m-3",onClick:()=>p.deleteBookmark(s.id)},Le,8,Ee)):u("",!0)]))),128)),e("span",Me,d(s.category),1)]),w(_,{to:`/recipes/${s.id}`,class:"card-footer bg-transparent border-0 text-decoration-none link-darkBrown"},{default:x(()=>[e("h5",Ne,d(s.title),1),e("div",Se,[e("del",{class:h(["me-2 text-muted mt-1",{"d-none":s.price===s.total}])},"NT$ "+d(s.total),3),e("span",Ve,[e("span",{class:h({"text-danger":s.price!==s.total,"fw-bold":s.price!==s.total})},"NT$ "+d(s.price),3),f(" / "+d(s.content),1)])]),e("div",De,[t.thumbs[s.id]?(n(),c("span",Pe,d(t.thumbs[s.id].people),1)):u("",!0),t.myThumbObj[s.id]?(n(),c("button",Ue,ze)):t.myThumbObj[s.id]?u("",!0):(n(),c("button",He,Ge))])]),_:2},1032,["to"])])]))),128))]))])])}const vt=M(z,[["render",ut]]);export{vt as default};
